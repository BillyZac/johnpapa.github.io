<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>JohnPapa.net</title>
    
    <meta name="author" content="John Papa">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

    <!-- Le styles -->
    <link href="/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="/assets/resources/syntax/syntax.css" rel="stylesheet">
    <link href="/assets/css/style.css" rel="stylesheet">

    <link rel="shortcut icon" type="image/x-icon" href="assets/ico/favicon.ico">

    <!-- Le fav and touch icons -->
    <!-- Update these with your own images
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

    <link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">

</head>

<body>
    <nav class="navbar navbar-default visible-xs" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            
            <a type="button" class="navbar-toggle nav-link" href="http://github.com/johnpapa">
                <i class="fa fa-github"></i>
            </a>
            
            
            <a type="button" class="navbar-toggle nav-link" href="http://twitter.com/john_papa">
                <i class="fa fa-twitter"></i>
            </a>
            
            
            <a class="navbar-brand" href="/">
                <img src="http://www.gravatar.com/avatar/0d3794fe37746ea54926ca6878712721?s=35" class="img-circle" />
                
            </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li class="active"><a href="/">Home</a></li>
                <li><a href="/categories.html">Categories</a></li>
                <li><a href="/tags.html">Tags</a></li>
            </ul>
        </div><!-- /.navbar-collapse -->
    </nav>

    <!-- nav-menu-dropdown -->
    <div class="btn-group hidden-xs" id="nav-menu">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            <i class="fa fa-bars"></i>
        </button>
        <ul class="dropdown-menu" role="menu">
            <li><a href="/"><i class="fa fa-home"></i>Home</a></li>
            <li><a href="/categories.html"><i class="fa fa-folder"></i>Categories</a></li>
            <li><a href="/tags.html"><i class="fa fa-tags"></i>Tags</a></li>
            <li class="divider"></li>
            <li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
        </ul>
    </div>

    <div class="col-sm-4 sidebar hidden-xs hidden-sm not-mobile">
        <!-- sidebar.html -->
<header class="sidebar-header" role="banner">
	<h1 class="text-center">John Papa</h1>
	<a href="/">
		<img src="http://www.gravatar.com/avatar/0d3794fe37746ea54926ca6878712721?s=150" class="img-circle" />
	</a>
	<h3 class="title">
		<a href="/"></a>
	</h3>
</header>


<div id="bio" class="text-center">
	Evangelist on the Loose
</div>


<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/johnpapa">
				<i class="fa fa-github-alt fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://twitter.com/john_papa">
				<i class="fa fa-twitter fa-lg"></i>
			</a>
		</li>
		
		<li>
			<a class="btn btn-default btn-sm" href="/feed.xml">
				<i class="fa fa-rss fa-lg"></i>
			</a>
		</li>
	</ul>

	<div class="sidebar-content">

		<nav id="page-nav">
			<ul class="main-navigation list-unstyled list-inline">
				<li><a href="/about/">About</a></li>
				<li><a href="/articles">Articles</a></li>
				<li><a href="/spa">SPA</a></li>
				<li><a href="/videos">Videos</a></li>
			</ul>
		</nav>

		<h5>Recent Posts</h5>
		<ul class="list-unstyled">
			
				<li>
					<span>16 Sep 2015</span> &raquo;
					<a href="/angular/angular2/community/event/javascript/uncategorized/2015/09/16/angular-2-hack-night-coming-to-orlando.html">
					Angular 2 Hack Night Coming to Orlando</a>
				</li>
			
				<li>
					<span>29 Aug 2015</span> &raquo;
					<a href="/angular/asp.net/github/gulp/html5/javascript/pluralsight/typescript/uncategorized/visual%20studio%20code/2015/08/29/learning-visual-studio-code.html">
					Learning Visual Studio Code</a>
				</li>
			
				<li>
					<span>23 May 2015</span> &raquo;
					<a href="/uncategorized/2015/05/23/visual-studio-code-webinar.html">
					Visual Studio Code Webinar</a>
				</li>
			
				<li>
					<span>23 May 2015</span> &raquo;
					<a href="/uncategorized/2015/05/23/automatically-restarting-asp-net-on-osx-with-dnxmon.html">
					Automatically Restarting ASP.NET on OSX with DNXMON</a>
				</li>
			
				<li>
					<span>23 May 2015</span> &raquo;
					<a href="/uncategorized/2015/05/23/getting-started-with-asp-net-5-on-osx.html">
					Getting Started with ASP.NET 5 on OSX</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/refactoring-with-visual-studio-code.html">
					Refactoring with Visual Studio Code</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/intellisense-witha-visual-studio-code.html">
					Intellisense with Visual Studio Code</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/git-and-preferences-in-visual-studio-code.html">
					Git and Preferences in Visual Studio Code</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/debugging-with-visual-studio-code.html">
					Debugging with Visual Studio Code</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/visual-studio-code.html">
					Introducing Visual Studio Code</a>
				</li>
			
		</ul>
	</div>

</div>
<!-- sidebar.html end -->
        <div class="not-mobile row sidebar-extras">
            <table class="col-centered">
                <tbody>
                    <tr>
                        <td>
                            <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="160x600"></div>
                        </td>
                        <td>
                            <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="160x600"></div>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="300x250"></div>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="300x250"></div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="col-sm-8">
        <div class="page-header">
  <h1>JohnPapa.net </h1>
</div>



<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/the-yanks-sox-rivalry-resumes-tonight-the-unit-vs-boomer.html">The Yanks/Sox Rivalry Resumes Tonight&#58; The Unit vs Boomer!</a>
  </h2>

  <div>
    
    
    <p>Being a die hard <a href="http://www.yankees.com">Yankee </a>fan and a baseball fan in general, I cannot wait to see the <a href="http://sports.espn.go.com/mlb/news/story?page=redsoxyankees">Yanks take the Red Sox on tonight </a>in the Bronx. I just hope it does not get rained out. Its just a lot of fun to watch the story unfold. And did I mention that my 6 year old knows the entire starting lineup and starting pitching of the Yankees (and has for 3 years) ? ;-) Ah, today's schools.</p>
<p>Assuming Schilling, Boomer and the Unit stay healthy all year long (all being 38 and older), it shouild be an excellent dog fight. </p>
<p>Let the countdown to opening night begin!</p>
<p>&nbsp;</p>
<p>&nbsp;</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/impersonatation.html">Impersonatation</a>
  </h2>

  <div>
    
    
    <p>Quick blog for now … I set up a new ASP.NET project, turn on NT auth, turn off anonymous access, write some ADO.NET code to connect to SQL Server via integrated security and viola! I get this lovely error: &lt;P&gt;&lt;/P&gt;<br /><br /> &lt;FIELDSET&gt;&lt;LEGEND&gt;Arg!&lt;/LEGEND&gt; &lt;H2&gt;<i>Login failed for user ‘LANCELOT\ASPNET’.</i> &lt;/H2&gt;<font face="Arial, Helvetica, Geneva, SunSans-Regular, sans-serif"><b>Description: </b>An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. <br /><br /><b>Exception Details: </b>System.Data.SqlClient.SqlException: Login failed for user 'LANCELOT\ASPNET'.<br /></font>&lt;/FIELDSET&gt; &lt;P&gt; <br /><br />Easy fix of course. Just need to add this line of code to my web.config file. One would think that after doing this repeatedly that Pavlov would learn. <br />&lt;/P&gt; &lt;FIELDSET&gt;&lt;LEGEND&gt;Impersonate me&lt;/LEGEND&gt;<br /><br />&lt;identity impersonate=”true/&gt; &lt;/FIELDSET&gt; <br /></p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/garbage-collection-quiz.html">Garbage Collection Quiz</a>
  </h2>

  <div>
    
    
    <p>Here’s a quick quiz about GC: <br />Q) At what point is x eligible to be cleaned up by the GC? <br /><br />  &lt;FIELDSET&gt;&lt;LEGEND&gt;Garbage Collection&lt;/LEGEND&gt;<br /><font color="#000000" size="2"><font color="#0000ff" size="2">public</font> void foo() <br />{ <br />&nbsp;&nbsp;&nbsp;&nbsp;Class1 x = <font color="#0000ff" size="2">new</font> Class1(); <br />&nbsp;&nbsp;&nbsp;&nbsp;Class2 y = <font color="#0000ff" size="2">new</font> Class2(); <br /><br />&nbsp;&nbsp;&nbsp;&nbsp;y.Width = x.GetWidth(); <br />&nbsp;&nbsp;&nbsp;&nbsp;y.Height = y.Width; <br />&nbsp;&nbsp;&nbsp;&nbsp;y.Color = "Red"; <br />} <br /></font>&lt;/FIELDSET&gt; <br /><br /><b>ANSWER:</b> (highlight the black area to see answer) <br />&lt;FONT style=”BACKGROUND-COLOR: #000000” color=#000000&gt;After x.GetWidth() is executed&lt;/FONT&gt; <br /><br />See <a href="/blogs/john.papa/archive/2005/04/02/61096.aspx">this post’s comments</a> for explanation/discussion… <br /></p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/garbage-collection-examples.html">Garbage Collection Examples</a>
  </h2>

  <div>
    
    
    <p>In a <a href="/blogs/john.papa/archive/2005/04/02/61096.aspx">previous post</a> I posed a question regarding how garbage collection operates on unused objects. Basically, once there are no more references to an object (let's say "x"), .NET sees that x is no longer used and marks it as available to be freed by the GC. An object's lifetime is based on its usage, not on the scope of the object. If it is not used, it is fair game for the GC to come and grab it. One clarification <a href="http://blogs.msdn.com/toub/">Stephen Toub</a> and <a href="http://davidkean.net/">David Kean</a> commented on is that this only applies if a debugger is attached while it is running. Also, <a href="http://dotnetjunkies.com/weblog/johnwood/">John Wood</a> had some good ideas for a demonstration that I borrowed and built on. Thanks guys! </p>
<p><br /><i>The JIT changes some optimizations to aid in debugging, and this particular optimization is only applied for release builds (or more specifically when an optimized compilation is used; you would see the same behavior if you selected the default Debug configuration but then changed Optimize Code to true in the project’s properties, or used /o+) and only when the debugger is not attached at startup. Try running in release build from the IDE using F5 and then ctrl-F5 (start, and start without debugging) to see. … <b>Stephen Toub</b></i> <br /><br />I decided to put some Console app examples together to demonstrate how this works and to try out a few variations. The results were interesting as I found out I was incorrect in my statement where I said that setting x = null at the end of the method would prevent x’s object from being collected by the GC. It didn’t happen in my tests. In the tests I ran, setting x = null did not prevent the GC from collecting it earlier on. <br /><br />I modified the following code sample from my previous post to add in the details and some messages to help demonstrate the behavior. To test this code, I compiled a release build and executed it form the command window so I could watch it unfold via Console.Writeline messages. The idea behind these examples is that the destructors will write messages when their respective objects are collected. To make sure the Garbage Collector runs right away I issue the GC.Collect method immediately following the x.GetWidth method’s execution. If you want to try this out, grab this code and throw it in a class in a C# Console App. Then make a release build and run it. (You’ll have to rebuild for each test, of course) <br /><br />Test #0 … when you run the code sample below the destructor for Class2 executes since it is no longer used. Then, once methods have run their course, Class3’s destructor executes. <br /><br />Test #1 … I uncommented comment #1 (x = null;) to see if the GC would NOT collect Class2. I expected it to keep it around however the GC proved me wrong and still cleaned up Class2 earlier (the same behavior as the Test #0). <br /><br />Test #2 … I commented comment #1 and uncommented comment #2 (string s = x.ToString();). The GC did not clean up Class2 until after the foo method. <br /><br />Test #3 … I commented comment #2 and uncommented comment #3 (GC.KeepAlive(x);). The GC did not clean up Class2 until after the foo method. <br /><br /> &lt;P&gt;&lt;/P&gt; &lt;FIELDSET&gt;&lt;LEGEND&gt;GC Test in a Console App&lt;/LEGEND&gt;<span class="myCode"><span class="myKeyword">using</span> System; <br /><span class="myKeyword">namespace</span> GarbageCollectionTest <br />{ <br /><span class="myKeyword">class</span> Class1 <br />{ <br />     [STAThread] <br />     <span class="myKeyword">static void</span> Main(<span class="myKeyword">string</span>[] args) <br />     { <br />         foo(); <br />         Console.ReadLine(); <br />     } <br /><br />     <span class="myKeyword">public static void</span> foo() <br />     { <br />         Class2 x = <span class="myKeyword">new</span> Class2(); <br />         Class3 y = <span class="myKeyword">new</span> Class3(); <br /><br />         y.Width = x.GetWidth(); <br />         Console.WriteLine(“Collecting Garbage”); <br />         GC.Collect(); <br />         y.Height = y.Width; <br />         y.Color = “Red”; <br />         &lt;SPAN class=myComment&gt;//x = null;// #1</span> <br />         &lt;SPAN class=myComment&gt;//string s = x.ToString(); // #2&lt;/SPAN&gt; <br />         &lt;SPAN class=myComment&gt;//GC.KeepAlive(x); // #3&lt;/SPAN&gt; <br />     } <br /><br />     ~Class1( ) <br />     { <br />         Console.WriteLine( “Destructor for “ + <span class="myKeyword">this</span>.GetType().Name) ; <br />     } <br />} <br /><br /><span class="myKeyword">class</span> Class2 <br />{ <br />     <span class="myKeyword">public int</span> GetWidth() <br />     { <br />         <span class="myKeyword">return</span> 7; <br />     } <br /><br />     ~Class2() <br />     { <br />         Console.WriteLine(“Destructor for “ + <span class="myKeyword">this</span>.GetType().Name) ; <br />     } <br />} <br /><br /><span class="myKeyword">class</span> Class3 <br />{ <br />     <span class="myKeyword">public int</span> Width; <br />     <span class="myKeyword">public int</span> Height; <br />     <span class="myKeyword">public string</span> Color; <br /><br />     ~Class3() <br />     { <br />         Console.WriteLine(“Destructor for “ + <span class="myKeyword">this</span>.GetType().Name) ; <br />     } <br />} <br /><br />} <br />&lt;/SPAN&gt;&lt;/FIELDSET&gt;</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/close-and-dispose-the-using-statement.html">Close and Dispose ... The using Statement</a>
  </h2>

  <div>
    
    
    <p>The <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/csspec/html/vclrfcsharpspec_8_13.asp"><i>using</i> statement</a> is another awesome tool that helps reduce coding effort and possible issues. An attentive reader added a good comment to <a href="/blogs/john.papa/archive/2005/03/31/60948.aspx">my last post</a> on using CommandBehavior.CloseConnection to close your Connection object automatically when your DataReader closes. (Thanks for the lead in <a href="/blogs/john.papa/archive/2005/03/31/60948.aspx#60961">Wolfgang</a>!) The using statement will close all of your objects and dispose of them for you. This is one of my personal favorites as it can make development a lot easier. (Any code that helps you clean up after yourself gets my vote.) <br /> <br /> Here is a code block without using the <i>using</i> statement that explicitly disposes of its ADO.NET objects. &lt;fieldset&gt;&lt;legend&gt;Sans using&lt;/legend&gt; <font color="000000" size="2"> <br /> <font color="0000ff" size="2">private void</font> Button2_Click(<font color="0000ff" size="2">object</font> sender, System.EventArgs e) <br /> { <br /> &nbsp;&nbsp;&nbsp;&nbsp;TextBox1.Text = ""; <br /> &nbsp;&nbsp;&nbsp;&nbsp;Label1.Text = ""; <br /> &nbsp;&nbsp;&nbsp;&nbsp;<font color="0000ff" size="2">string</font> sConnString = "Server=localhost\\sql;Database=Northwind;Integrated Security=True"; <br /> &nbsp;&nbsp;&nbsp;&nbsp;<font color="0000ff" size="2">string</font> sSql = "SELECT CategoryID, CategoryName FROM Categories ORDER BY CategoryName"; <br /> &nbsp;&nbsp;&nbsp;&nbsp;SqlConnection cn = <font color="0000ff" size="2">null</font>; <br /> &nbsp;&nbsp;&nbsp;&nbsp;SqlCommand cmd = <font color="0000ff" size="2">null</font>; <br /> &nbsp;&nbsp;&nbsp;&nbsp;SqlDataReader rdr = <font color="0000ff" size="2">null</font>; <br /> &nbsp;&nbsp;&nbsp;&nbsp;<font color="0000ff" size="2">try</font> <br /> &nbsp;&nbsp;&nbsp;&nbsp;{ <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cn = <font color="0000ff" size="2">new</font> SqlConnection(sConnString); <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd = <font color="0000ff" size="2">new</font> SqlCommand(sSql, cn); <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cn.Open(); <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rdr = cmd.ExecuteReader(); <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="0000ff" size="2">while</font> (rdr.Read()) <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TextBox1.Text += rdr["CategoryName"].ToString() + Environment.NewLine; <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br /> &nbsp;&nbsp;&nbsp;&nbsp;} <br /> &nbsp;&nbsp;&nbsp;&nbsp;<font color="0000ff" size="2">catch</font>(Exception ex) <br /> &nbsp;&nbsp;&nbsp;&nbsp;{ <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Label1.Text = ex.Message; <br /> &nbsp;&nbsp;&nbsp;&nbsp;} <br /> &nbsp;&nbsp;&nbsp;&nbsp;<font color="0000ff" size="2">finally</font> <br /> &nbsp;&nbsp;&nbsp;&nbsp;{ <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="0000ff" size="2">if</font> ((rdr != <font color="0000ff" size="2">null</font>) &amp;&amp; (!rdr.IsClosed)) <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rdr.Close(); <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="0000ff" size="2">if</font> (cmd != <font color="0000ff" size="2">null</font>) <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd.Dispose(); <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="0000ff" size="2">if</font> (cn != <font color="0000ff" size="2">null</font>) <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cn.Dispose(); <br /> &nbsp;&nbsp;&nbsp;&nbsp;} <br /> } <br /> </font> &lt;/fieldset&gt; <br /> <br /> Notice that this preceding code uses the <i>finally</i> block to clean up after itself. This code can easily be forgotten, mistyped, or in my case badly cut and pasted when you are in a hurry. There is nothing wrong with using the <i>finally</i> block for cleaning up, that is one of its intentions. But there is another way to tackle this clean up effort using the <i>using</i> statement. <br /> <br /> The following code sample also cleans up after itself, but it does so using the <i>using</i> statement instead of an explicit call to the close and dispose methods. Again, this is one of my favorite tools in .NET. The <i>using</i> statement handles the disposal and subsequent closing of my objects for me. Even if an exception is thrown, as soon as execution leaves the <i>using</i> block the DIspose method of the object is invoked under the covers. For objects like the SqlConnection, this also closes the connection too. Quite a nice feature! <br /> <br /> &lt;fieldset&gt;&lt;legend&gt;Using using&lt;/legend&gt; <font color="000000" size="2"> <br /> <font color="0000ff" size="2">private void</font> Button3_Click(<font color="0000ff" size="2">object</font> sender, System.EventArgs e) <br /> { <br /> &nbsp;&nbsp;&nbsp;&nbsp;TextBox1.Text = ""; <br /> &nbsp;&nbsp;&nbsp;&nbsp;Label1.Text = ""; <br /> &nbsp;&nbsp;&nbsp;&nbsp;<font color="0000ff" size="2">string</font> sConnString = "Server=localhost\\sql;Database=Northwind;Integrated Security=True"; <br /> &nbsp;&nbsp;&nbsp;&nbsp;<font color="0000ff" size="2">string</font> sSql = "SELECT CategoryID, CategoryName FROM Categories ORDER BY CategoryName"; <br /> &nbsp;&nbsp;&nbsp;&nbsp;<font color="0000ff" size="2">try</font> <br /> &nbsp;&nbsp;&nbsp;&nbsp;{ <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="0000ff" size="2">using</font> (SqlConnection cn = <font color="0000ff" size="2">new</font> SqlConnection(sConnString)) <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="0000ff" size="2">using</font> (SqlCommand cmd = <font color="0000ff" size="2">new</font> SqlCommand(sSql, cn)) <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cn.Open(); <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="0000ff" size="2">using</font> (SqlDataReader rdr = cmd.ExecuteReader()) <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="0000ff" size="2">while</font> (rdr.Read()) <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TextBox1.Text += rdr["CategoryName"].ToString() + Environment.NewLine; <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br /> &nbsp;&nbsp;&nbsp;&nbsp;} <br /> &nbsp;&nbsp;&nbsp;&nbsp;<font color="0000ff" size="2">catch</font>(Exception ex) <br /> &nbsp;&nbsp;&nbsp;&nbsp;{ <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Label1.Text = ex.Message; <br /> &nbsp;&nbsp;&nbsp;&nbsp;} <br /> } <br /> </font> &lt;/fieldset&gt; <br /> <br /> While either of these 2 code examples will work and clean up after themselves, I prefer to code with the <i>using</i> statement. To me, it is easier to read and it saves me from having to write the cleanup code. <br /> <br /> One last note with the <i>using</i> statement that you may run into: Just like a <i>try</i> block, anything declared within the <i>using</i> statement can only be accessed within its block. If you want to refer to it outside of the <i>using</i> statement (or <i>try</i> block), then declare it prior to and outside of them.&lt;/li&gt; <br /> <br /> For you VB.NET’ers o
ut there, the <i>using</i> statement will be available in VB.NET in the reelase of Visual Studio .NET 2005. The syntax looks to be as follows: <br /> <br /> &lt;fieldset&gt;&lt;legend&gt;Using in VB.NET&lt;/legend&gt; <font color="000000" size="2"> <br /> <font color="0000ff" size="2">Using</font> cn <font color="0000ff" size="2">As</font> SqlConnection = <font color="0000ff" size="2">New</font> SqlConnection(sConnString) <br /> &nbsp;&nbsp;&nbsp;&nbsp;'--- Do something <br /> <font color="0000ff" size="2">End Using</font> <br /> </font> &lt;/fieldset&gt; <br /> <br /></p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/sharing-mistakes.html">Sharing Mistakes</a>
  </h2>

  <div>
    
    
    <p>With VB 6 and ADO 2.x I can't tell you how many times I wrote the following type of code and only realized what I had done <b>after</b> I had pressed F5:<br />
<br />
&nbsp;</p>
<fieldset><legend>The Infamous Infinite Loop Blunder</legend><font face="Courier New" size="2"><br />
'--- Using VB 6 and ADO 2.x <br />
oRs.Open <br />
Do While Not oRs.EOF <br />
&nbsp;&nbsp;&nbsp;&nbsp;Debug.Print oRs(0) <br />
Loop <br />
</font></fieldset>
<p><br />
<br />
Usually the moment after I ran this code I would realize that I was in an infinite loop. Then I would quickly put in the oRs.MoveNext just before the end of the loop and all would be well. Fortunately, in ADO.NET I no longer have this problem thanks to the DataReader and how it reads a record and moves the cursor to the next position all in one fell swoop. So .NET saved me from one of my most infamous blunders. <br />
<br />
&nbsp;</p>
<fieldset><legend>Using C# and ADO.NET</legend><font face="Courier New" size="2"><br />
SqlDataReader oDr = oCmd.ExecuteReader(); <br />
<font color="#0000ff">while</font>(oDr.Read()) <br />
{ <br />
&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine(oDr[0]); <br />
} <br />
</font></fieldset>
<p><br />
<br />
But of course I didn't get off that easy. I now have all new mistakes to make with .NET. My most common mistake these days occurs when I declare a variable inside of a &quot;try&quot; block and then use it outside of the &quot;try&quot; block. For example, I'll do something along the lines of the foo method below: <br />
<br />
&nbsp;</p>
<fieldset><legend>Oops!</legend><font face="Courier New" size="2"><font color="#0000ff">public int</font> foo(<font color="#0000ff">int</font> y, <font color="#0000ff">int</font> z) <br />
{ <br />
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">try</font> <br />
&nbsp;&nbsp;&nbsp;&nbsp;{ <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">int</font> x = y * z; <br />
&nbsp;&nbsp;&nbsp;&nbsp;} <br />
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">catch</font> <br />
&nbsp;&nbsp;&nbsp;&nbsp;{ <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// catch it here</font> <br />
&nbsp;&nbsp;&nbsp;&nbsp;} <br />
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000">// this will not compile!</font> <br />
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">return </font>x; <br />
} <br />
</font></fieldset>
<p><br />
But at least with this mistake I catch it when I build my C# project. Then I move the declaration of the variable x outside of the try block and all is well. <br />
<br />
OK, so now that I have opened up and shared some of my embarassing blunders, it's time for you to share some of your common blunders. Don't be shy!<br />
&nbsp;</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/there-s-only-one-first-time.html">There's Only One First Time</a>
  </h2>

  <div>
    
    
    <p>Well, I finally did it. Today I joined the ranks of bloggers everywhere. I am grateful that the crew at codebetter.com was gracious enough to accept me into their community. Thanks guys!</p>
<p>I'll be posting code samples, random thoughts, links, research and some personal musings in my blog ... that is, once I decide on the color schema and theme for it ;-). Well, I've got to get back to coloring Easter Eggs with my kids now. It's amazing how difficult it is to get that food coloring off of your clothes, skin and ... uh oh ... the dog!</p>
<p> </p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/reflector-is-cool.html">Reflector is Cool!</a>
  </h2>

  <div>
    
    
    <p>I ran into a situation today where I wanted to know why ADO.NET’s DataSet.Merge method worked the way it did. Then it occurred to me that I could use reflection to find out. Using the <a href="http://www.aisto.com/roeder/dotnet/">Reflector</a> software found on <a href="http://www.aisto.com/roeder/dotnet/">Lutz Roeder’s site</a> I examined the DataSet.Merge method and got my answers. I know this software has been out there a while, but I do not often find a reason to use it. But when I do have a need (such as today), it is a very nice tool to have. Saved me a bunch of time and effort. <br /><br />&lt;IMG style=”WIDTH: 440px; HEIGHT: 218px” height=229 alt=”Reflector UI” src=”/photos/jpapa/images/60799/500x229.aspx” width=455 border=0&gt;<br />You can jump into nested methods by clicking the links in the right hand pane. <br />It is a pretty basic but very cool tool. Follows the KISS methodology (Keep It Simple, Stupid!), too. <br /><br />Special kudos to my friend/colleague Lloyd who reminded me of this tool just the other day.</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/heading-to-boston.html">Heading to Boston</a>
  </h2>

  <div>
    
    
    <p>Just confirmed that I’ll be at <a href="http://www.ftponline.com/conferences/vslive/2005/bo/">VSLive in Boston </a>this June. If you plan on attending VSLive, drop by. I’ll be presenting 2 topics: <br /><br /><b>Get Ready for ADO.NET 2 (5:45 pm to 6:45 pm, Wednesday, June 29, 2005)</b> <br />Data access using ADO.NET is at the core of most .NET enterprise applications. While ADO.NET 1.x is powerful, its successor ADO.NET 2 contains several new features that are can benefit an application. I’ll review these new features and how to take advantage of them including binary serialization of DataSets, new features and objects built into the DataSet and enhancements to strongly typed DataSets. <br /><br /><b>Lightweight Promotable Transactions using System Transactions and ADO.NET 2 (2:00 pm to 3:00 pm, Thursday, June 30)</b> <br />The.NET Framework v2 includes the System.Transactions namespace that enhances transactional support for managed code. I’ll discuss how System.Transactions can handle transactions without using other common practices such as deriving from a ServicedComponent, using interception, or using reflection. Designed to integrate with SQL Server 2005, System.Transactions supports the intelligent and automatic promotion of local lightweight transactions to fully distributed transactions. It also introduces a new class called LightweightTransactionManager, which is a faster alternative to using the DTC for local transactions. I will walk through examples that modify the default transactional settings of the implicit local transaction and modify the isolation level, timeout period and transaction’s context. I will demonstrate how and when the System.Transactions namespace delegates the promotion of a lightweight transaction to a fully distributed transaction. I will also discuss how to develop explicit transactions and manually choose when and if to enlist in a transaction context. <br /><br /><a href="http://www.ftponline.com/conferences/vslive/2005/bo/">&lt;IMG src=”/photos/jpapa/images/60702/original.aspx” border=0&gt;</a></p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/finding-nunit.html">Finding NUnit</a>
  </h2>

  <div>
    
    
    <p><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnpag2/html/entlib.asp">Microsoft's Enterprise Library</a> (Ent Lib) was developed using the oft spoken of Test Driven Development methodology (TDD). But of course if you are new to TDD or are aware of it but have not used it yet, you'll want to download and install nUnit to try it out. You can find NUnit here <a href="http://www.nunit.org/">http://www.nunit.org</a> and then navigate to their download page. All of the Ent Lib code has sub folders labelled "Test" which contain the test code that NUnit looks for. NUnit is pretty easy to set up and try out, especially if you load one of the QuickStarts that come with Ent Lib into Visual Studio.NET. Give it a shot and check it out. Its a pretty cool concept and in practical real world scenarios, it has helped my projects come together more quickly. It has been especially helpful on projects with large numbers of developers as it reduces the number of errors in unit testing. And when errors are present, it is easy for other developers to fix them. I'll talk a lot more about TDD and Ent Lib in specifics in future blogs.</p>
<p>Once you find NUnit, you can start setting up your own classes that can be used by it. Setting up a class for the TDD model is quite simple. Below I have shown part of the SqlDatabaseFixture class from the Ent Lib DAAB (located in the Sql\Tests folder). You really only have to follow a few steps within the code.</p>
<ol> <li>Surround your test class with the compilation directive <li>Reference the NUnit.Framework and include it in a using statement <li>Decorate your test class with the [TestFixture] attribute (NUnit looks for these attributes) <li>Decorate your test method with the [Test] attribute and make sure they are declared as void <li>Use one or more Assert statements to look for valid conditions (or invalid)</li>Go ahead and give it a whirl in your code.<br /><br /> <fieldset><legend>SqlDatabaseFixture</legend>&lt;FONT color=#000000 size=2&gt;&lt;FONT color=#0000ff size=2&gt;#if UNIT_TESTS <br />&lt;FONT color=#0000ff size=2&gt;using System.Data; <br />&lt;FONT color=#0000ff size=2&gt;using System.Data.SqlClient; <br />&lt;FONT color=#0000ff size=2&gt;using Microsoft.Practices.EnterpriseLibrary.Configuration; <br />&lt;FONT color=#0000ff size=2&gt;using Microsoft.Practices.EnterpriseLibrary.Data.Tests; <br />&lt;FONT color=#0000ff size=2&gt;using NUnit.Framework; <br /><br />&lt;FONT color=#0000ff size=2&gt;namespace Microsoft.Practices.EnterpriseLibrary.Data.Sql.Tests <br />{ <br />[TestFixture] <br />&lt;FONT color=#0000ff size=2&gt;public class SqlDatabaseFixture <br />{ <br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;FONT color=#0000ff size=2&gt;private static ConfigurationContext context = &lt;FONT color=#0000ff size=2&gt;new TestConfigurationContext(); <br /><br />&nbsp;&nbsp;&nbsp;&nbsp;[Test] <br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;FONT color=#0000ff size=2&gt;public void ConnectionTest() <br />&nbsp;&nbsp;&nbsp;&nbsp;{ <br />&nbsp;&nbsp;&nbsp;&nbsp;SqlDatabase sqlDatabase = &lt;FONT color=#0000ff size=2&gt;new SqlDatabase(); <br />&nbsp;&nbsp;&nbsp;&nbsp;sqlDatabase.ConfigurationName = "NewDatabase"; <br />&nbsp;&nbsp;&nbsp;&nbsp;sqlDatabase.Initialize(&lt;FONT color=#0000ff size=2&gt;new DatabaseConfigurationView(context)); <br /><br />&nbsp;&nbsp;&nbsp;&nbsp;IDbConnection connection = sqlDatabase.GetConnection(); <br />&nbsp;&nbsp;&nbsp;&nbsp;Assert.IsNotNull(connection); <br />&nbsp;&nbsp;&nbsp;&nbsp;Assert.IsTrue(connection &lt;FONT color=#0000ff size=2&gt;is SqlConnection); <br />&nbsp;&nbsp;&nbsp;&nbsp;connection.Open(); <br />&nbsp;&nbsp;&nbsp;&nbsp;DBCommandWrapper cmd = sqlDatabase.GetSqlStringCommandWrapper("Select * from Region"); <br />&nbsp;&nbsp;&nbsp;&nbsp;cmd.CommandTimeout = 60; <br />&nbsp;&nbsp;&nbsp;&nbsp;Assert.AreEqual(cmd.CommandTimeout, 60); <br />&nbsp;&nbsp;&nbsp;&nbsp;} <br />} <br /></fieldset> <p> <p>Here is the image of NUnit running the test fixture SqlDatabaseFixture for Ent Lib's DAAB QuickStart. </p><br />&lt;IMG src="/photos/jpapa/images/60947/original.aspx" border=0&gt; <p>&nbsp;</p> <p></p>



</p></li></li></li></li></ol>

    
    
  </div>

</article>

<hr/>

<ul class="pager"> 

  
  <li class="previous">
    
    <a href="/page83">&larr; Newer</a>
    
  </li>
  
  
  <li>
    <span class="page_number">Page: 84 of 86</span>
  </li>

  
  <li class="next">
    <a href="/page85">Older &rarr;</a>
  </li>
  

</ul>





      <footer class="footer-text">
        <hr/>
        <p>
        Copyright © 2015 - John Papa Blog content licensed under the Creative Commons <a href="http://creativecommons.org/licenses/by/2.5/">CC BY 2.5</a>
        | Unless otherwise stated or granted, code samples licensed under the <a href="http://sm.mit-license.org/">MIT license</a>.
        | Site design based on the <a href="https://github.com/dbtek/dbyll">dbyll theme</a> under the <a href="http://sm.mit-license.org/">MIT license</a>
      </p>

      </footer>

    </div>

    <script type="text/javascript" src="/assets/resources/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="/assets/resources/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/assets/js/app.js"></script>

    <!--Developer Media Links-->
    <script type='text/javascript'>
        function _dmBootstrap(file) {
    var _dma = document.createElement('script'); _dma.type = 'text/javascript'; _dma.async = true; _dma.src = ('https:' == document.location.protocol ? 'https://' : 'http://')
    + file;
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(_dma);
    }
    function _dmFollowup(file) { if (typeof DMAds === 'undefined') _dmBootstrap('cdn2.DeveloperMedia.com/a.min.js');}
    (function () { _dmBootstrap('cdn1.DeveloperMedia.com/a.min.js');
    setTimeout(_dmFollowup, 2000);})();
    </script>

    <!--<script language="JavaScript" src="http://ad.doubleclick.net/N6839/adj/lqm.johnpapa.site/ron;kw=%2Cjohn%2Cpapa%2Cblog%2Cjohnpapa%7Bdot%7Dnet%2Cjohnpapa%2Cpappa%2Cwww%7Bdot%7Djohnpapa%7Bdot%7Dnet%2Cjon%2Cangular%2Cjhon;sz=160x600;dc_ref=http%3A%2F%2Fwww.johnpapa.net%2F;tile=1;ord=BEAAB484DA88D8D84B9DCB004E5712BE?"
    type="text/javascript"></script>-->

    <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="728x90" class="col-centered"></div>

</body>

</html>


<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl =
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'johnpapa']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

