<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>dbyll</title>
	
	<meta name="author" content="dbyll">

	<!-- Enable responsive viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Le styles -->
	<link href="/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<link href="/assets/resources/syntax/syntax.css" rel="stylesheet">
	<link href="/assets/css/style.css" rel="stylesheet">

	<!-- Le fav and touch icons -->
	<!-- Update these with your own images
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

	<link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">
</head>

<body>
	<nav class="navbar navbar-default visible-xs" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
			<a type="button" class="navbar-toggle nav-link" href="http://github.com/dbtek">
				<i class="fa fa-github"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="http://twitter.com/dbtek">
				<i class="fa fa-twitter"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="mailto:dbyll@ismaildemirbilek.com">
				<i class="fa fa-envelope"></i>
			</a>
			
			<a class="navbar-brand" href="/">
				<img src="http://www.gravatar.com/avatar/726351295ec82e145928582f595aa3aa?s=35" class="img-circle" />
				
			</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/">Home</a></li>
				<li><a href="/categories.html">Categories</a></li>
				<li><a href="/tags.html">Tags</a></li>
			</ul>
		</div><!-- /.navbar-collapse -->
	</nav>

	<!-- nav-menu-dropdown -->
	<div class="btn-group hidden-xs" id="nav-menu">
		<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
			<i class="fa fa-bars"></i>
		</button>
		<ul class="dropdown-menu" role="menu">
			<li><a href="/"><i class="fa fa-home"></i>Home</a></li>
			<li><a href="/categories.html"><i class="fa fa-folder"></i>Categories</a></li>
			<li><a href="/tags.html"><i class="fa fa-tags"></i>Tags</a></li>
			<li class="divider"></li>
			<li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
		</ul>
	</div>

	<div class="col-sm-3 sidebar hidden-xs">
		<!-- sidebar.html -->
<header class="sidebar-header" role="banner">
	<a href="/">
		<img src="http://www.gravatar.com/avatar/726351295ec82e145928582f595aa3aa?s=150" class="img-circle" />
	</a>
	<h3 class="title">
        <a href="/"></a>
    </h3>
</header>


<div id="bio" class="text-center">
	Your stylish, minimalist theme!
</div>


<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/dbtek">
				<i class="fa fa-github-alt fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://twitter.com/dbtek">
				<i class="fa fa-twitter fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="mailto:dbyll@ismaildemirbilek.com">
				<i class="fa fa-envelope fa-lg"></i>
			</a>
		</li>
		
	</ul>
	<ul id="contact-list-secondary" class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://pinterest.com/asd123">
				<i class="fa fa-pinterest fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://linkedin.com/in/asd123">
				<i class="fa fa-linkedin fa-lg"></i>
			</a>
		</li>
		
		<li>
			<a class="btn btn-default btn-sm" href="/feed.xml">
				<i class="fa fa-rss fa-lg"></i>
			</a>
		</li>
	</ul>
</div>
<!-- sidebar.html end -->

	</div>

	<div class="col-sm-9 col-sm-offset-3">
		<div class="page-header">
  <h1>dbyll </h1>
</div>



<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/find-sql-server-stored-procedures-containing-some-text.html">Find SQL Server Stored Procedures Containing Some Text</a>
  </h2>

  <div>
    
    
    <p>Relatively basic stuff here, but I do like to stick to the KISS rule. I am often required to search SQL Server's stored procedures to find out which ones refer to specific fields, tables, or even variable names. Recently, I had to&nbsp;refactor several stored procedures defined a specific alias for a column. Being the geek that I am, I wrote a little stored proc helper routine that quickly came up with the results I needed. In my case, there were over 1000 procs to search and my results turned up 25 procs to refactor. </p>
<div style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 0pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 0pt; FONT-SIZE: 8pt; BACKGROUND: white; PADDING-BOTTOM: 0pt; BORDER-LEFT: windowtext 1pt solid; COLOR: black; PADDING-TOP: 0pt; BORDER-BOTTOM: windowtext 1pt solid; FONT-FAMILY: Courier New"><pre style="MARGIN: 0px"><span style="COLOR: blue">CREATE PROCEDURE </span>sp_find_procs_containing</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; @search <span style="COLOR: blue">VARCHAR</span>(100) = <span style="COLOR: maroon">''</span></pre><pre style="MARGIN: 0px"><span style="COLOR: blue">AS</span></pre><pre style="MARGIN: 0px"><span style="COLOR: blue">SET </span>@search = <span style="COLOR: maroon">'%' </span>+ @search + <span style="COLOR: maroon">'%'</span></pre><pre style="MARGIN: 0px"><span style="COLOR: blue">SELECT&nbsp;&nbsp;&nbsp; </span></pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; ROUTINE_NAME,</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; ROUTINE_DEFINITION</pre><pre style="MARGIN: 0px"><span style="COLOR: blue">FROM&nbsp;&nbsp;&nbsp; </span></pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; INFORMATION_SCHEMA.ROUTINES</pre><pre style="MARGIN: 0px"><span style="COLOR: blue">WHERE&nbsp;&nbsp;&nbsp; </span></pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; ROUTINE_DEFINITION <span style="COLOR: blue">LIKE </span>@search</pre><pre style="MARGIN: 0px"><span style="COLOR: blue">ORDER BY</span></pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; ROUTINE_NAME</pre><pre style="MARGIN: 0px">GO</pre></div>
<p>If you invoke this proc and pass it the phrase you are looking for in the proc, it will return them in sorted order. Not brain surgery, just something to help me code faster. </p>
<p>As you can tell, I like the INFORMATION_SCHEMA views. Here is <a href="/blogs/john.papa/archive/2005/06/06/64145.aspx">another post</a> I put up a while back on using them.</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/enterprise-library-s-data-access-application-block-part-2.html">Enterprise Library's Data Access Application Block - Part 2</a>
  </h2>

  <div>
    
    
    <p>In the&nbsp;<a href="http://msdn.microsoft.com/msdnmag/issues/05/08/default.aspx">August 2005 issue of MSDN Magazine</a> I continued my discussion of the Enterprise Library’s Data Access Application Block. This is <a href="http://msdn.microsoft.com/msdnmag/issues/05/08/DataPoints/default.aspx">part 2</a> in a 3 part series where I explore the Enterprise Library DAAB <a href="http://msdn.microsoft.com/msdnmag/issues/05/07/DataPoints/default.aspx">in my Data Points column</a>.&nbsp;I had a lot of&nbsp;good feedback from&nbsp;part 1, which I will try to answer in my blog and possibly in a future follow up article. I have been surprised at how many people&nbsp;are so interested in Ent Lib&nbsp;in general. Its not a solution for everything, but it certainly does have great value and the development community appears to be very interested in it. </p>
<p>You can read the article <a href="http://msdn.microsoft.com/msdnmag/issues/05/08/DataPoints/default.aspx">online here</a>. If you want to read Part 1 first, you can catch that <a href="http://msdn.microsoft.com/msdnmag/issues/05/07/DataPoints/default.aspx">online here</a>.</p>
<p><a href="http://msdn.microsoft.com/msdnmag/issues/05/08/default.aspx">&lt;IMG src=”/photos/jpapa/images/129712/original.aspx” border=0&gt;</a></p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/enterprise-library-data-block-changes.html">Enterprise Library - Data Block Changes</a>
  </h2>

  <div>
    
    
    <p>If you have not checked out the latest build of Ent Lib, you can get the Enterprise Library – June 2005 release <a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=A7D2A109-660E-444E-945A-6B32AF1581B3&amp;displaylang=en">here</a>. The <a href="http://msdn.microsoft.com/practices/default.aspx?pull=/library/en-us/dnpag2/html/june2005release.asp">list of changes </a>can be found <a href="http://msdn.microsoft.com/practices/default.aspx?pull=/library/en-us/dnpag2/html/june2005release.asp">here</a>, as well. Borrowing from their master list, the list of changes to the Data Access Application Blocks are as follows:</p>
<ul> <li>The new method named <b>GetStoredProcCommandWrapperWithSourceColumns</b> is added to the <b>Database </b>class. This method provides creation of a stored procedure command wrapper whose parameter values come from source columns in a <b>DataTable</b>. In addition, new public methods provide access to the <b>DbDataAdapter</b> object for the current database connection. <li>The <b>DataConnectionFailedEvent </b>and <b>DataConnectionOpenedEvent </b>classes are updated to be thread safe. <li>The <b>OracleCommandWrapper</b> class is updated to perform proper conversion between parameters of types not recognized by Oracle and native Oracle types. </li> <p>If you haven’t jumped into the Ent Lib yet, its worth a good look. The code is open so you can build on what you don’t like or leave it as is. You can also use some blocks and ignore others (as I do). I am looking forward to the next version (v 2.0). If you are too, check out <a href="http://blogs.msdn.com/tomholl/">Tom Hollander’s blog </a>occasionally as well. He often has good posts on Ent Lib. If you are looking to jump in, you can take a look at <a href="http://msdn.microsoft.com/msdnmag/issues/05/07/DataPoints/default.aspx">Part 1</a> and <a href="http://msdn.microsoft.com/msdnmag/issues/05/08/DataPoints/default.aspx">Part 2</a> of my 3 part series on the Data Access Applicaiton Block online at <a href="http://msdn.microsoft.com/msdnmag">MSDN Magazine</a>. </p> <p>I’ve received a lot of good feedback on these articles with a lot of good questions and what if scenarios. Unfortunately, IU have not been able to keep up with the number of responses I have received so please don’t think I am ignoring you if I don’t get back right away. I do read all of my email and I appreciate all of your input, so please keep it coming and I will try to respond as much as I can.</p>



</li></li></ul>

    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/enterprise-library-data-access-application-block-part-3.html">Enterprise Library's Data Access Application Block - Part 3</a>
  </h2>

  <div>
    
    
    <p>In the&nbsp;<a href="http://msdn.microsoft.com/msdnmag/issues/05/10/default.aspx">October 2005 issue of MSDN Magazine</a>&nbsp;I continued my discussion of the Enterprise Library’s Data Access Application Block. This is the final episode in the trilogy where I explore the Enterprise Library DAAB <a href="http://msdn.microsoft.com/msdnmag/issues/05/07/DataPoints/default.aspx">in my Data Points column</a>.&nbsp;I had a lot of&nbsp;good feedback from&nbsp;parts 1 and 2.&nbsp;OK, so I generally don't like write 3 part articles, but I just kept&nbsp;running out of room (after all, magazines have space limitations).&nbsp;There is just so much to say about the Ent Lib DAAB :-)</p>
<p>You can read the article <a href="http://msdn.microsoft.com/msdnmag/issues/05/10/DataPoints/default.aspx">online here</a>. Or you can read the whole series of the Ent Lib DAAB discussion at these links:</p>
<ul> <li><a href="http://msdn.microsoft.com/msdnmag/issues/05/07/DataPoints/">The Enterprise Library Data Access Application Block, Part 1</a> <li><a href="http://msdn.microsoft.com/msdnmag/issues/05/08/DataPoints/">The Enterprise Library Data Access Application Block, Part 2</a> <li><a href="http://msdn.microsoft.com/msdnmag/issues/05/10/DataPoints/">The Enterprise Library Data Access Application Block, Part 3</a></li> <p><a href="http://msdn.microsoft.com/msdnmag/issues/05/10/default.aspx">&lt;IMG src="/photos/jpapa/images/131961/original.aspx" border=0&gt;</a></p> <p>&nbsp;</p> <p>In the upcoming issues I'll be getting into ADO.NET 2 and some of its features. I've also been toying with a follow up article on system.transactions since so much has changed and I have had so many good comments and questions on the topic. </p>



</li></li></ul>

    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/dual-core-processor-for-visual-studio-net-development.html">Dual Core Processor for Visual Studio.NET Development</a>
  </h2>

  <div>
    
    
    <p>I finally broke down and bought a new development PC. And to those who read <a href="/blogs/john.papa/archive/2005/08/02/130196.aspx">my post</a> on how my hard drive blew on my last PC twice, in addition to backups I got a RAID 1 array in this PC.&nbsp; But the coolest part of this story is how fast I can load projects, develop, and make builds with the new dual core processor. [:D] Even with loading a project with ReSharper (which is a very slow loading tool) Visual Studio.NET loads my project quickly. I bought a 3ghz dual core processor (not Extreme Edition, didn't have the cash for that). I would not have thought the dual core would have sped things up so much because it is not really multi tasking much in development, but it did make a big difference for me. It is probably because my PC also does a lot of oother things at the same time (web surfing, SQL Server jobs, serves ASP.NET pages, and some multimedia. My wife laughs at me because the PC is never fast enough. Frankly I don't know exactly why it is so much faster, but I am thrilled that it is!</p>
<p>I'll be running some tests to see how things compare against benchmarks I ran on my former development PC over the next few weeks. It will be interesting to see how that turns out.</p>
<p>Of course, I had to go buy a new PC game to see how it works in a dual processor environment too. So I picked up a role playing game called Dungeon Siege 2 last night. I am not much of a gamer because frankly I don't ever find the time. But I am deterined to give this one a shot. I'll post more on that experience later.</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/does-your-app-need-an-independent-data-layer.html">Does Your App Need an Independent Data Layer ?</a>
  </h2>

  <div>
    
    
    <p>Steve Joubert,&nbsp;a colleague of mine at <a href="http://www.aspsoft.com">ASPSOFT</a>, recently had his article <a href="http://www.simple-talk.com/2005/10/03/net-data-access/">Does Your App Need an Independent Data Layer ?</a> published. You can check it out online at the <a href="http://www.simple-talk.com/">Simple Talk</a> web site.</p>
<p>Congratualtions Steve!</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/displaying-the-contents-and-row-versions-of-an-ado-net-dataset.html">Displaying the Contents (and Row Versions) of an ADO.NET DataSet</a>
  </h2>

  <div>
    
    
    <p>Was asked for this code a few days ago after a quick demo I did, so I thought I'd throw it out here. Its a&nbsp;quick code snippet that displays the contents of a DataSet for debugging purposes. But first, here is a quick code snippet that grabs a DataSet full of 2 DataTables.</p>
<div style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 0pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 0pt; FONT-SIZE: 8pt; BACKGROUND: white; PADDING-BOTTOM: 0pt; BORDER-LEFT: windowtext 1pt solid; COLOR: black; PADDING-TOP: 0pt; BORDER-BOTTOM: windowtext 1pt solid; FONT-FAMILY: Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: blue">private</span> <span style="COLOR: blue">void</span> GetData()<pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="COLOR: blue">string</span> cnStr = <span style="COLOR: maroon">@"server=Mine;database=northwind;integrated security=true;"</span>;</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; SqlConnection cn = <span style="COLOR: blue">new</span> SqlConnection(cnStr);</pre><pre style="MARGIN: 0px">&nbsp;</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; DataSet ds = <span style="COLOR: blue">new</span> DataSet(<span style="COLOR: maroon">"MyDataSet"</span>);</pre><pre style="MARGIN: 0px">&nbsp;</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="COLOR: blue">string</span> customerSql = <span style="COLOR: maroon">"SELECT CustomerID, CompanyName, City, Country"</span></pre><pre style="MARGIN: 0px"><span style="COLOR: maroon">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ " FROM Customers ORDER BY CompanyName"</span>;</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; SqlCommand customerCmd = <span style="COLOR: blue">new</span> SqlCommand(customerSql);</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; customerCmd.CommandType = CommandType.Text;</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; customerCmd.Connection = cn;</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; SqlDataAdapter da = <span style="COLOR: blue">new</span> SqlDataAdapter(customerCmd);</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; da.Fill(ds, <span style="COLOR: maroon">"Customers"</span>);</pre><pre style="MARGIN: 0px">&nbsp;</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="COLOR: blue">string</span> orderSql = <span style="COLOR: maroon">"SELECT OrderID, CustomerID, OrderDate "</span></pre><pre style="MARGIN: 0px"><span style="COLOR: maroon">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ " FROM Orders ORDER BY OrderDate DESC"</span>;</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; SqlCommand orderCmd = <span style="COLOR: blue">new</span> SqlCommand(orderSql);</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; orderCmd.CommandType = CommandType.Text;</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; orderCmd.Connection = cn;</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; da.SelectCommand = orderCmd;</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; da.Fill(ds, <span style="COLOR: maroon">"Orders"</span>);</pre><pre style="MARGIN: 0px">&nbsp;</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; DisplayDataSet(ds, <span style="COLOR: maroon">"My Data"</span>);</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</pre></div>
<!--EndFragment-->
<p>And here is the code snippet that iterates through the DataSet to show the DataTables:</p>
<div style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 0pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 0pt; FONT-SIZE: 8pt; BACKGROUND: white; PADDING-BOTTOM: 0pt; BORDER-LEFT: windowtext 1pt solid; COLOR: black; PADDING-TOP: 0pt; BORDER-BOTTOM: windowtext 1pt solid; FONT-FAMILY: Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="COLOR: blue">private</span> <span style="COLOR: blue">void</span> DisplayDataSet(DataSet ds, <span style="COLOR: blue">string</span> title)<pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Debug.WriteLine(title);</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="COLOR: green">//--- Loop through the DataTables</span></pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="COLOR: blue">foreach</span> (DataTable table <span style="COLOR: blue">in</span> ds.Tables)</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Debug.WriteLine(<span style="COLOR: maroon">"*** DataTable: "</span> + table.TableName + <span style="COLOR: maroon">"***"</span>);</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="COLOR: green">//--- Loop through each DataTable's DataRows</span></pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="COLOR: blue">foreach</span> (DataRow row <span style="COLOR: blue">in</span> table.Rows)</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="COLOR: green">//--- Display the original values, if there are any.</span></pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="COLOR: blue">if</span> (row.HasVersion(System.Data.DataRowVersion.Original))</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Debug.Write(<span style="COLOR: maroon">"Original Row Values ===&gt; "</span>);</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="COLOR: blue">foreach</span>(DataColumn column <span style="COLOR: blue">in</span> table.Columns)</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Debug.Write(column.ColumnName + <span style="COLOR: maroon">" = "</span> + </pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row[column, DataRowVersion.Original] + <span style="COLOR: maroon">", "</span>);</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Debug.WriteLine(<span style="COLOR: maroon">""</span>);</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&amp;nbsp
; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="COLOR: green">//--- Display the current values, if there are any.</span></pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="COLOR: blue">if</span> (row.HasVersion(System.Data.DataRowVersion.Current))</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Debug.Write(<span style="COLOR: maroon">"Current Row Values ====&gt; "</span>);</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="COLOR: blue">foreach</span>(DataColumn column <span style="COLOR: blue">in</span> table.Columns)</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Debug.Write(column.ColumnName + <span style="COLOR: maroon">" = "</span> + </pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row[column, DataRowVersion.Current] + <span style="COLOR: maroon">", "</span>);</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Debug.WriteLine(<span style="COLOR: maroon">""</span>);</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Debug.WriteLine(<span style="COLOR: maroon">""</span>);</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</pre><pre style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</pre></div>
<!--EndFragment-->
<p>The code is pretty straightforward for DisplayDataSet. I loop through each table in the DataSet, then through the rows in each table, and finally through the columns in each row. Before checking each column, however, I first check to make sure the row has an Original version and/or a Current version. This is nice for displaying the original and current versions of a column's value when you allow the user to edit multiple rows and send all of the changes to the server in a batch. If you don't check if the row has an original version first and the row happens to have been a new row, then it will throw an exception. </p>
<p>I&nbsp;often take this code and modify it for the debugging purpose of the moment. I've used a couple that throw them into hierarchical DataGrids and make everything nice and pretty. But sometimes I just want a quick and dirty method with a quick and drity code base like this.&nbsp;There are tools out there that you can download to do this, but if all you need is a quick method to display the data and its row versions, this will do nicely too.</p>
<p>Oh ... and the code above assumes the following <span style="COLOR: blue">using</span> statements:</p>
<div style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 0pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 0pt; FONT-SIZE: 8pt; BACKGROUND: white; PADDING-BOTTOM: 0pt; BORDER-LEFT: windowtext 1pt solid; COLOR: black; PADDING-TOP: 0pt; BORDER-BOTTOM: windowtext 1pt solid; FONT-FAMILY: Courier New"><pre style="MARGIN: 0px"><span style="COLOR: blue">using</span> System;</pre><pre style="MARGIN: 0px"><span style="COLOR: blue">using</span> System.Data;</pre><pre style="MARGIN: 0px"><span style="COLOR: blue">using</span> System.Diagnostics;</pre></div>
<!--EndFragment-->


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/dataset-and-the-datatable-in-ado-net-2.html">DataSet and the DataTable in ADO.NET 2</a>
  </h2>

  <div>
    
    
    <p>The&nbsp;<a href="http://msdn.microsoft.com/msdnmag/issues/05/11/default.aspx">November 2005 issue of MSDN Magazine</a>&nbsp;is now posted online. My latest <a href="http://msdn.microsoft.com/msdnmag/issues/05/11/default.aspx">Data Points</a> column outlines the evolution of the <a href="http://msdn.microsoft.com/msdnmag/issues/05/11/DataPoints/default.aspx">DataSet and the DataTable in ADO.NET 2</a>. </p>
<p>You can read the article <a href="http://msdn.microsoft.com/msdnmag/issues/05/11/DataPoints/default.aspx">online here</a>. </p>
<p><a href="http://msdn.microsoft.com/msdnmag/issues/05/11/default.aspx">&lt;IMG src="/photos/jpapa/images/133171/original.aspx" border=0&gt;</a></p>
<p>&nbsp;</p>
<p>In the upcoming issues I'll be getting into some more of ADO.NET 2's new features, a follow up article on system.transactions, and some of the T-SQL enhancements in SQL Server 2005.</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/custom-tooltips-in-winform-treeviews.html">Custom Tooltips in WinForm TreeViews</a>
  </h2>

  <div>
    
    
    <p>This is one of those simple coding issues that I was recently faced with that I wish I had a simple example to show me how to knock this out. I had to create a treeview whose nodes were supposed to display a tooltip that could change based on the selected node. Pretty straightforward issue overall, but I ran into a problem: the tooltips weren't working. OK, so it was a big problem with a simple solution. Long story short, there are a few key ingredients in setting tooltips that change based on the node you have selected. My problem stemmed from forgetting to deactivate the tooltip and then reactivate it. I did not see this anywhere in the documentation but I stumbled across it by trying different properties out. Now, maybe this is common knowledge to some or even most of you, but to me it sure wasn't. But I have run into controls in the past that needed to be turned off and on to work properly. So I guess I just chalk this up as one more.</p>
<p>Anyway, here is a short list of things to look for:</p>
<ul> <li>drag a tooltip control onto your designer that has the treeview control <li>create a mousemove event handler on the treeview to kick off the tooltip <li>check to make sure that a node is selected, or get out <li>check to make sure a different node is selected than previously, or get out <li>Make the tooltip deactive (tip.Active = false;) <li>Set the tooltip text (tip.SetTooltip(tree, toolTipText); <li>Make the tooltip active (tip.Active = true;)</li> <p>Now, I had an object stored in the tag of each treeview node. So I grab it, figure out which obejct I have and get a property of the object to use for the tooltip. This part is up to your implementation of course.</p> <p>&nbsp;</p> <fieldset><legend>Tooltips</legend><pre><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Arial"> <span style="COLOR: blue">private void</span> tree_MouseMove(<span style="COLOR: blue">object</span> sender, System.Windows.Forms.MouseEventArgs e) { TreeNode currentNode = tree.GetNodeAt(e.X, e.Y); <span style="COLOR: blue">if</span> ((currentNode == <span style="COLOR: blue">null</span>) || (previousNode == currentNode) || (currentNode.Tag == <span style="COLOR: blue">null</span>)) <span style="COLOR: blue">return</span>; <span style="COLOR: blue">string</span> toolTipText = string.Empty; previousNode = currentNode; <span style="COLOR: blue">object</span> o = previousNode.Tag; <span style="COLOR: blue">if</span> (o <span style="COLOR: blue">is</span> Class1) toolTipText = Class1.Description; <span style="COLOR: blue">else if</span> (<span style="COLOR: blue">o is</span> Class2) toolTipText = Class2.Description; <span style="COLOR: blue">else if</span> (o <span style="COLOR: blue">is</span> Class3) toolTipText = Class3.Description; <span style="COLOR: blue">else</span> toolTipText = <span style="COLOR: blue">string</span>.Empty; <span style="COLOR: green">// Turn off the tooltip so we can change the text</span> <span style="COLOR: blue">if</span> (tip.Active) tip.Active = <span style="COLOR: blue">false</span>; <span style="COLOR: green">// Change the tooltip text</span> tip.SetToolTip(tree, toolTipText); <span style="COLOR: green">// Turn on the tooltip </span> tip.Active = <span style="COLOR: blue">true</span>; } </span></pre></fieldset> <br />



</li></li></li></li></li></li></ul>

    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/coming-to-orlando-in-october.html">Coming to Orlando in October</a>
  </h2>

  <div>
    
    
    <p><a href="http://www.ftponline.com/conferences/vslive/2005/bo/">VSLive Boston</a> in late June was fun. I spoke on 2 topics (one regarding the new features of <a href="/blogs/john.papa/archive/2005/06/15/64596.aspx">ADO.NET 2</a> and the other one regarding <a href="/blogs/john.papa/archive/2005/06/15/64595.aspx">System.Transactions</a>). I had a good time talking to several attendees at VSLive including a couple of our codebetter blog readers. One thing I love about presenting at conferences is that I get to meet really interesting and great people. </p>
<p>I just confirmed that I will also be presenting 2 different topics at <a href="http://www.ftponline.com/conferences/vslive/2005/or/">VSLive Orlando</a>&nbsp;in October. You can check out the schedule of presentations for VSLive Orlando <a href="http://www.ftponline.com/conferences/vslive/2005/or/agenda.aspx">here</a>. The topics and their brief summaries are below. Once I get the slides for these to a more completed state I will post their agendas as I did with the Boston ones <a href="/blogs/john.papa/archive/2005/06/15/64596.aspx">here </a>and <a href="http://www.ftponline.com/conferences/vslive/2005/bo/">here</a>. I'll be wearing my codebetter.com polo shirt, so track me down if you will be there too. </p>
<p><a href="http://www.ftponline.com/conferences/vslive/2005/or/sclive-sessions.aspx#efficientdata"><strong>Efficient Data Access with ADO.NET and SQL</strong><br /></a>Using an efficient data access strategy is essential in designing scalable and efficient enterprise solutions. In this session I will review several data access techniques that can improve performance and/or ease maintenance in applications. I’ll discuss efficient ways to implement ADO.NET database connections, automatic closure of connections and using connection pooling. I will also review some performance and efficiency tips when executing stored procedures, using parameterized queries, and preventing SQL injection attacks. </p>
<p><a href="http://www.ftponline.com/conferences/vslive/2005/or/asp-sessions.aspx#editingmaster"><strong>Editing Master and Detail Records in ASP.NET 2.0</strong></a> <br />The ASP.NET 2.0 GridView and DetailsView controls add tremendous value to developers who need to create editable web forms with master detail data. These controls reduce the amount of code required to page, sort and handle many events that formerly required custom event handlers. This session will demonstrate how to migrate code to these controls from the ASP.NET 1.x DataGrid in a mutli tier application. <br /></p>


    
    
  </div>

</article>

<hr/>

<ul class="pager"> 

  
  <li class="previous">
    
    <a href="/page128">&larr; Newer</a>
    
  </li>
  
  
  <li>
    <span class="page_number">Page: 129 of 136</span>
  </li>

  
  <li class="next">
    <a href="/page130">Older &rarr;</a>
  </li>
  

</ul>




		<footer>
			<hr/>
			<p>
				&copy; 2015 dbyll with Jekyll. Theme: <a href="https://github.com/dbtek/dbyll">dbyll</a> by dbtek.
			</p>
		</footer>
	</div>

	<script type="text/javascript" src="/assets/resources/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="/assets/resources/bootstrap/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/assets/js/app.js"></script>
</body>
</html>



<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl =
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'dbyll']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

