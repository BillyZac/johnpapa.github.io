<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>dbyll</title>
	
	<meta name="author" content="dbyll">

	<!-- Enable responsive viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Le styles -->
	<link href="/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<link href="/assets/resources/syntax/syntax.css" rel="stylesheet">
	<link href="/assets/css/style.css" rel="stylesheet">

	<!-- Le fav and touch icons -->
	<!-- Update these with your own images
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

	<link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">
</head>

<body>
	<nav class="navbar navbar-default visible-xs" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
			<a type="button" class="navbar-toggle nav-link" href="http://github.com/dbtek">
				<i class="fa fa-github"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="http://twitter.com/dbtek">
				<i class="fa fa-twitter"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="mailto:dbyll@ismaildemirbilek.com">
				<i class="fa fa-envelope"></i>
			</a>
			
			<a class="navbar-brand" href="/">
				<img src="http://www.gravatar.com/avatar/726351295ec82e145928582f595aa3aa?s=35" class="img-circle" />
				
			</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/">Home</a></li>
				<li><a href="/categories.html">Categories</a></li>
				<li><a href="/tags.html">Tags</a></li>
			</ul>
		</div><!-- /.navbar-collapse -->
	</nav>

	<!-- nav-menu-dropdown -->
	<div class="btn-group hidden-xs" id="nav-menu">
		<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
			<i class="fa fa-bars"></i>
		</button>
		<ul class="dropdown-menu" role="menu">
			<li><a href="/"><i class="fa fa-home"></i>Home</a></li>
			<li><a href="/categories.html"><i class="fa fa-folder"></i>Categories</a></li>
			<li><a href="/tags.html"><i class="fa fa-tags"></i>Tags</a></li>
			<li class="divider"></li>
			<li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
		</ul>
	</div>

	<div class="col-sm-3 sidebar hidden-xs">
		<!-- sidebar.html -->
<header class="sidebar-header" role="banner">
	<a href="/">
		<img src="http://www.gravatar.com/avatar/726351295ec82e145928582f595aa3aa?s=150" class="img-circle" />
	</a>
	<h3 class="title">
        <a href="/"></a>
    </h3>
</header>


<div id="bio" class="text-center">
	Your stylish, minimalist theme!
</div>


<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/dbtek">
				<i class="fa fa-github-alt fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://twitter.com/dbtek">
				<i class="fa fa-twitter fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="mailto:dbyll@ismaildemirbilek.com">
				<i class="fa fa-envelope fa-lg"></i>
			</a>
		</li>
		
	</ul>
	<ul id="contact-list-secondary" class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://pinterest.com/asd123">
				<i class="fa fa-pinterest fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://linkedin.com/in/asd123">
				<i class="fa fa-linkedin fa-lg"></i>
			</a>
		</li>
		
		<li>
			<a class="btn btn-default btn-sm" href="/feed.xml">
				<i class="fa fa-rss fa-lg"></i>
			</a>
		</li>
	</ul>
</div>
<!-- sidebar.html end -->

	</div>

	<div class="col-sm-9 col-sm-offset-3">
		<div class="page-header">
  <h1>dbyll </h1>
</div>



<article class="home">

  <span class="post-date">
    
    January
    20th,
    
    2010
  </span>

  <h2>
    <a href="/silverlight/2010/01/20/multi-touch-101-silverlight-tv-episode-3.html">Multi-Touch 101 - Silverlight TV Episode 3</a>
  </h2>

  <div>
    
    
    <p><a href="http://channel9.msdn.com/shows/SilverlightTV/"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="MediumSLTVBanner" border="0" alt="MediumSLTVBanner" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/MultiTouch101SilverlightTVEpisode3_85C/MediumSLTVBanner_3.png" width="113" height="61" /></a>The <a href="http://channel9.msdn.com/shows/SilverlightTV/Silverlight-TV-Episode-3-Multi-Touch-101-with-Silverlight/">latest episode of Silverlight TV is now available on Channel 9</a>! Since this is our opening week we have published 3 new episodes. We’ve had a lot of great feedback and appreciate that so many of you are subscribing to the show, watching us, and providing feedback and comments! We’ll be publishing a schedule for shows as they evolve, but generally you will see a new episode every Thursday. We will post bonus shows as they come in, too!</p>
<p>But back to episode 3 … this is a great quick demo by David Kelley on multi touch in Silverlight. Silverlight TV is once again unscripted, shot in 1 take with warts and all. Don’t miss this one! </p>
<p><a href="http://channel9.msdn.com/shows/SilverlightTV/Silverlight-TV-Episode-3-Multi-Touch-101-with-Silverlight/"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/MultiTouch101SilverlightTVEpisode3_85C/image_3.png" width="360" height="237" /></a> </p>
<p>In this episode, John interviews Silverlight MVP David Kelley about developing multi-touch applications in Silverlight. David discusses the types of multi-touch hardware and his experiences in developing real world multi-touch applications. Then he jumps right into the code and shows how to create a multi-touch application with Silverlight 3 or 4! The application David demonstrates walks through the key multi-touch events, handling those events, touch IDs, tracking the location of the touch points, and much more. </p>
<blockquote>   <p><strong><font color="#ff0000">UPDATE</font></strong></p>    <p>Here are some useful links that David provided: </p>    <ul>     <li>here is a quick post to the SL3 code we used from Tim Heuer </li>      <ul>       <li><a href="http://timheuer.com/blog/archive/2009/07/30/silverlight-3-multi-touch-introduction-fundamentals-basics.aspx">http://timheuer.com/blog/archive/2009/07/30/silverlight-3-multi-touch-introduction-fundamentals-basics.aspx</a></li>     </ul>      <li>this code converts easily to SL4 also here is a quick post more about the UX concepts used in multitouch</li>      <ul>       <li><a href="http://hackingsilverlight.blogspot.com/2010/01/silverlight-multi-touch-in-real-world.html">http://hackingsilverlight.blogspot.com/2010/01/silverlight-multi-touch-in-real-world.html</a></li>     </ul>      <li>also the simon demo that includes multitouch (will have an SL4 version at MIX) that Davide Zordan and I worked on.</li>      <ul>       <li><a href="http://simon.codeplex.com/">http://simon.codeplex.com/</a></li>     </ul>   </ul> </blockquote>
<p>&#160;</p>
<p>And remember that you can subscribe to Silverlight TV several ways:</p>
<ul>   <ul>     <li><a href="http://channel9.msdn.com/shows/SilverlightTV/RSS/">Subscribe to the RSS feed for the show itself</a> </li>      <li><a href="http://channel9.msdn.com/shows/SilverlightTV/feed/zune/">Subscribe to the show on your Zune</a> </li>      <li><a href="http://channel9.msdn.com/shows/SilverlightTV/feed/ipod/">Subscribe to the show for your iPod</a> </li>   </ul> </ul>
<p>If you have not watched the previous episodes of Silverlight TV, you can catch them here. </p>
<p><a href="http://channel9.msdn.com/shows/SilverlightTV/Silverlight-TV-Episode-2-Perspectives-on-Flash-and-Silverlight/"><strong>Episode 2: Perspectives on Flash and Silverlight</strong></a></p>
<p><a href="http://channel9.msdn.com/shows/SilverlightTV/Silverlight-TV-Episode-2-Perspectives-on-Flash-and-Silverlight/"><img title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/SilverlightTVEpisode2PerspectivesonFlash_9DAF/image_3.png" width="255" height="151" /></a></p>
<p>&#160;</p>
<p><a href="http://channel9.msdn.com/shows/SilverlightTV/Out-of-Browser-in-Silverlight-4-Silverlight-TV-Episode-1/"><strong>Episode 1: The Joys of Trusted Out-of-Browser Applications in Silverlight 4</strong></a></p>
<p><a href="http://channel9.msdn.com/shows/SilverlightTV/Out-of-Browser-in-Silverlight-4-Silverlight-TV-Episode-1/"><img title="clip_image001" border="0" alt="clip_image001" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7f977e907c4d_EE29/clip_image001_64b0d373-2931-4a04-8ed9-d0ed32699463.jpg" width="256" height="146" /></a></p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    January
    19th,
    
    2010
  </span>

  <h2>
    <a href="/silverlight/2010/01/19/hidden-gems-why-net-developers-need-to-take-a-2nd-look-at-project-rosetta.html">Hidden Gems&#58; Why .NET Developers Need to Take a 2nd Look at Project Rosetta</a>
  </h2>

  <div>
    
    
    <p>Many of you have heard of <a href="http://visitmix.com/labs/rosetta">Project Rosetta</a> by now, but for those who have not here is an <a href="http://visitmix.com/labs/rosetta">excerpt from the site</a>:</p>
<blockquote>   <p>The goal of the project is to help designers and UI developers learn new technologies by relating concepts and skills in a visual way from one technology to another.</p> </blockquote>
<p><a href="http://visitmix.com/labs/rosetta/FTSL/Guide/"><img alt="" src="http://visitmix.com/labs/rosetta/images/ftsl/guide/movieclip.jpg" width="501" height="48" /></a></p>
<p>One of the first areas this site has focused on is helping bridge the gap for those transitioning from Flash to Silverlight. There is a great guide on the site titled “<a href="http://visitmix.com/labs/rosetta/FTSL/Guide/">Flash to Silverlight Guide</a>” that walks through concepts in Flash and applies them to how they are tackled in Silverlight.</p>
<p>OK, so why am I telling you all of this if its focused on Flash developers? Good question, so let me get to my main point. The site is NOT just for Flash developers. It also has some awesome content for getting up to speed on Silverlight development aspects you use (or should use) every day. Got your attention? Good! </p>
<p><strong>The content on this site is an excellent source at bringing a .NET developer up to speed on some design skills. </strong>So before you say “yeah right”, take a look at the tutorials on this site. They are very easy, take just minutes, and demonstrate ways to create very compelling results.<a href="http://visitmix.com/labs/rosetta/EyesOfBlend/"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/Why.NETDevelopersNeedtoTakeaSecondLookat_7368/image_5.png" width="500" height="97" /></a></p>
<p></p>
<p></p>
<p>For example, check out this set of tutorials called <a href="http://visitmix.com/labs/rosetta/EyesOfBlend/">“Through the Eyes of Expression Blend”</a> (see below). The tutorials are very straight forward and show how to draw shapes/pictures, create transforms, animate elements, play video, manipulate text, import images, skin controls, and work with behaviors. These are key skills in designing and developing Silverlight applications.</p>
<ul>   <li>     <p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/Why.NETDevelopersNeedtoTakeaSecondLookat_7368/tutorial1%5B1%5D_2.jpg"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="tutorial1[1]" border="0" alt="tutorial1[1]" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/Why.NETDevelopersNeedtoTakeaSecondLookat_7368/tutorial1%5B1%5D_thumb.jpg" width="57" height="44" /></a> <a href="http://visitmix.com/labs/rosetta/EyesOfBlend/Drawing/"><strong>1. Drawing an emoticon in Expression Blend</strong></a>        <br />First steps in getting to know the tools and workspace in Blend</p>   </li>    <li>     <p><a href="http://visitmix.com/labs/rosetta/EyesOfBlend/Transforms/"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="tutorial2[1]" border="0" alt="tutorial2[1]" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/Why.NETDevelopersNeedtoTakeaSecondLookat_7368/tutorial2%5B1%5D_edfc7b30-0cda-4c91-94cc-fd397cd05599.jpg" width="57" height="44" /> <strong>2. Element Transformations</strong></a>        <br />Learn to use Scale, Rotate, Skew and 2.5D Transformations</p>   </li>    <li>     <p><a href="http://visitmix.com/labs/rosetta/EyesOfBlend/Animation/"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="tutorial3[1]" border="0" alt="tutorial3[1]" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/Why.NETDevelopersNeedtoTakeaSecondLookat_7368/tutorial3%5B1%5D_6432d9fa-6bda-4917-9111-456be4b9578a.jpg" width="57" height="44" /></a><a href="http://visitmix.com/labs/rosetta/EyesOfBlend/Animation/">3. Get Started with Animation</a><strong></strong>        <br />A Quick Overview on Creating Time-Based Animations</p>   </li>    <li>     <p><a href="http://visitmix.com/labs/rosetta/EyesOfBlend/Media/"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="tutorial4[1]" border="0" alt="tutorial4[1]" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/Why.NETDevelopersNeedtoTakeaSecondLookat_7368/tutorial4%5B1%5D_ac7c06a5-744f-421a-88a9-7bf73085c4f6.jpg" width="57" height="44" /> <strong>4. Playing Video with the MediaElement</strong></a>        <br />Using the flexible MediaElement control as a reusable Surface</p>   </li>    <li>     <p><a href="http://visitmix.com/labs/rosetta/EyesOfBlend/Layout/"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="tutorial5[1]" border="0" alt="tutorial5[1]" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/Why.NETDevelopersNeedtoTakeaSecondLookat_7368/tutorial5%5B1%5D_d97ff202-b003-4212-a046-f063c6831aa2.jpg" width="57" height="44" /> <strong>5. Arranging Pictures to Learn Layout</strong></a>        <br />Use the Grid, StackPanel, ScrollableViewer and Border to position Images</p>   </li>    <li>     <p><a href="http://visitmix.com/labs/rosetta/EyesOfBlend/Text/"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="tutorial6[1]" border="0" alt="tutorial6[1]" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/Why.NETDevelopersNeedtoTakeaSecondLookat_7368/tutorial6%5B1%5D_f893f622-2b60-463f-ab1d-e795fbfe9040.jpg" width="57" height="44" /> <strong>6. A Look at Text in Silverlight</strong></a>        <br />Learn about Displaying Text, Font Properties and Embedding Fonts</p>   </li>    <li>     <p><a href="http://visitmix.com/labs/rosetta/EyesOfBlend/Import/"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="tutorial6b[1]" border="0" alt="tutorial6b[1]" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/Why.NETDevelopersNeedtoTakeaSecondLookat_7368/tutorial6b%5B1%5D_e9978140-0924-4b1a-93dd-0018e8e91622.jpg" width="57" height="44" /> <strong>7. Import an Adobe Photoshop File into Blend</strong></a>        <br />Convert the assets from a Photoshop file into Interactive Controls</p>   </li>    <li>     <p><a href="http://visitmix.com/labs/rosetta/EyesOfBlend/Skinning/"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="tutorial7[1]" border="0" alt="tutorial7[1]" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/Why.NETDevelopersNeedtoTakeaSecondLookat_7368/tutorial7%5B1%5D_331c97a6-2262-47b8-b90e-ed9eadc94e70.jpg" width="57" height="44" /> <strong>8. Styling and Skinning Controls</strong></a>        <br />Customize the Look by Setting Properties and Building Templates</p>   </li>    <li>     <p><a href="http://visitmix.com/labs/rosetta/EyesOfBlend/DataTemplates/"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="tutorial8[1]" border="0" alt="tutorial8[1]" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/Why.NETDevelopersNeedtoTakeaSecondLookat_7368/tutorial8%5B1%5D_e01c4a61-d7bb-4570-a6f9-f5ebd712aeb1.jpg" width="57" height="44" /> <strong>9. Styling and working with Design-Time Data</strong></a>        <br />Explore how Templates and Bindings are used to display dynamic data</p>   </li>    <li>     <p><a href="http://visitmix.com/labs/rosetta/EyesOfBlend/Behaviors/"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="tutorial9[1]" border="0" alt="tutorial9[1]" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/Why.NETDevelopersNeedtoTakeaSecondLookat_7368/tutorial9%5B1%5D_b7760429-43a9-439e-9065-2649911ab087.jpg" width="57" height="44" /> <strong>10. Giving Behav
iors a Test Drive</strong></a>        <br />A brief overview and walkthrough of the Behaviors included with Blend</p>   </li> </ul>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p>&#160;</p>
<p>Give these some of your attention if you have mad developer skills but want to brush up on these talents.</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    January
    18th,
    
    2010
  </span>

  <h2>
    <a href="/silverlight/2010/01/18/silverlight-tv-episode-2-ndash-perspectives-on-flash-and-silverlight.html">Silverlight TV Episode 2 – Perspectives on Flash and Silverlight</a>
  </h2>

  <div>
    
    
    <p>Thank you to everyone for watching <a href="http://channel9.msdn.com/shows/SilverlightTV/">Silverlight TV</a> on <a href="http://channel9.msdn.com/">Channel 9</a>! We have been getting some great feedback on what we should include in future shows. We’ll be scheduling quite a few shows in the near future, starting with 2 new episodes that will air this week. </p>
<p>&#160;<a href="http://channel9.msdn.com/shows/SilverlightTV/Silverlight-TV-Episode-2-Perspectives-on-Flash-and-Silverlight/"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/SilverlightTVEpisode2PerspectivesonFlash_9DAF/image_3.png" width="414" height="245" /></a></p>
<p>The <a href="http://channel9.msdn.com/shows/SilverlightTV/Silverlight-TV-Episode-2-Perspectives-on-Flash-and-Silverlight/">first new episode this week is with Mike Downey</a>. Every time I talk to Mike I am impressed! Mike spent some time with me to explain how he starting get interested in moving from Flash to Silverlight.</p>
<blockquote>   <p><a href="http://channel9.msdn.com/shows/SilverlightTV/Silverlight-TV-Episode-2-Perspectives-on-Flash-and-Silverlight/">Silverlight TV Episode 2: Perspectives on Flash and Silverlight</a></p>    <p>Mike Downey (Principal Evangelist) shares his experiences with Flash, Flex and Air and discusses how they compare with Silverlight's offerings. Hear Mike, a former Flash evangelist for 9 years before coming to Microsoft last year, discuss his decision to switch to Silverlight and what incredible projects he has already influenced with Silverlight.</p> </blockquote>
<p>Keep an eye out for another episode later this week. You can be alerted when news shows are available by:</p>
<ul>   <li><a href="http://www.twitter.com/SilverlightTV">Follow us on Twitter @SilverlightTV</a></li>    <li><a href="http://channel9.msdn.com/shows/SilverlightTV/RSS/">Subscribe to the RSS feed for the show itself</a></li>    <li><a href="http://channel9.msdn.com/shows/SilverlightTV/feed/zune/">Subscribe to the show on your Zune</a></li>    <li><a href="http://channel9.msdn.com/shows/SilverlightTV/feed/ipod/">Subscribe to the show for your iPod</a></li> </ul>
<p>&#160; <a href="http://channel9.msdn.com/shows/SilverlightTV/"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="MediumSLTVBanner" border="0" alt="MediumSLTVBanner" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/SilverlightTVEpisode2PerspectivesonFlash_9DAF/MediumSLTVBanner_3.png" width="244" height="130" /></a></p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    January
    17th,
    
    2010
  </span>

  <h2>
    <a href="/silverlight/2010/01/17/get-your-questions-answered-on-silverlight-tv.html">Get Your Questions Answered on Silverlight TV</a>
  </h2>

  <div>
    
    
    <p>The <a href="http://channel9.msdn.com/shows/SilverlightTV/Out-of-Browser-in-Silverlight-4-Silverlight-TV-Episode-1/">first episode of Silverlight TV</a> is in the books. A special thank you to Keith Smith for coming on and doing a fantastic job and to everyone who watched our show! The planning for many future episodes is under way. One of the plans is to have take the questions we receive from Twitter to <a href="http://www.twitter.com/SilverlightTV">@SilverlightTV</a>, find the appropriate resource, and read (and where appropriate) demonstrate the answers on the show. So if you have any technical questions please forward them to <a href="http://www.twitter.com/SilverlightTV">@SilverlightTV</a> and we will organize some of them for future shows. For example, I am going to shoot some shows next week on MEF so if you have a questions such as “how do you filter exportable components using MEF?”, this would be an ideal time to get these questions in. We will try to get your questions in the show, but of course we cannot promise depending on time, number of questions we receive and if the topic is being covered. </p>
<p>&#160; <a href="http://channel9.msdn.com/shows/SilverlightTV/"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/GetYourQuestionsAnsweredonSilverlightTV_86D6/image_3.png" width="428" height="230" /></a></p>
<p>The upcoming schedule is looking like we will have a few shows on these topics (subject to change as guest schedules allow):</p>
<p>- Multi-Touch</p>
<p>- MEF</p>
<p>- RIA Services</p>
<p>- Silverlight HVP</p>
<p>- Design in Blend</p>
<p>- Splash screen creation</p>
<p>- XAP size management</p>
<p>- Panel discussion on general Silverlight questions</p>
<p>- New text features in Silverlight</p>
<p>- MVVM</p>
<p><a href="http://twitter.com/SilverlightTV"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="SilverlightTV_100px" border="0" alt="SilverlightTV_100px" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/GetYourQuestionsAnsweredonSilverlightTV_86D6/SilverlightTV_100px_3.png" width="104" height="104" /></a></p>
<p>If you have topics you wish to see please feel free to comment at <a href="http://www.twitter.com/SilverlightTV">@SilverlightTV</a>. There is a lot to cover and we’ll do our best to find some great guests: some you know well and others you really should know!</p>
<p>Thanks for watching Silverlight TV!</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    January
    15th,
    
    2010
  </span>

  <h2>
    <a href="/silverlight/2010/01/15/premier-of-silverlight-tv.html">Premier of Silverlight TV</a>
  </h2>

  <div>
    
    
    <p>I am proud to announce the premier of <a href="http://channel9.msdn.com/shows/SilverlightTV/">Silverlight TV</a> airing on <a href="http://channel9.msdn.com/">Channel 9</a>! You can watch the first episode right here where Keith Smith (Silverlight Group Program Manager), along with host John Papa (Silverlight Evangelist), discuss Silverlight 4's out-of-browser applications<a href="http://channel9.msdn.com/shows/SilverlightTV/Out-of-Browser-in-Silverlight-4-Silverlight-TV-Episode-1/">. Keith demonstrates how to set up a Trusted application using the out-of-browser features</a>, interact with the file system, integrate with COM and debug out-of-browser applications!</p>
<p>The mission of Silverlight TV is to provide premium Silverlight content through exclusive interviews with the members of the Silverlight product teams, partners and community leaders. Please help us get the word out about Silverlight TV by blogging, tweeting, emailing and shouting out loud! (I can't hear you!) </p>
<p><a href="http://channel9.msdn.com/shows/SilverlightTV/"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="clip_image001" border="0" alt="clip_image001" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7f977e907c4d_EE29/clip_image001_64b0d373-2931-4a04-8ed9-d0ed32699463.jpg" width="244" height="139" /></a></p>
<p><em><font size="2"><a href="http://channel9.msdn.com/shows/SilverlightTV/Out-of-Browser-in-Silverlight-4-Silverlight-TV-Episode-1/">Silverlight TV, Episode 1: The Joys of Trusted Out-of-Browser Applications in Silverlight 4</a></font></em></p>
<p>I’ve included a list of important links for Silverlight TV as well as a FAQ.    <table border="1" cellspacing="0" cellpadding="0"><tbody>       <tr>         <td colspan="2">           <p align="center"><b>Key links for Silverlight TV</b></p>         </td>       </tr>        <tr>         <td width="162">           <p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7f977e907c4d_EE29/TinySLTV_2.jpg"><img style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="TinySLTV" border="0" alt="TinySLTV" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7f977e907c4d_EE29/TinySLTV_thumb.jpg" width="152" height="50" /></a> </p>         </td>          <td width="306">           <p><a href="http://channel9.msdn.com/shows/SilverlightTV/">Watch Silverlight TV Shows on Channel 9</a></p>            <p>Watch shows and catch the latest news in our Silverlight TV blog</p>         </td>       </tr>        <tr>         <td width="162">           <p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7f977e907c4d_EE29/RSS_2.png"><img style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="RSS" border="0" alt="RSS" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7f977e907c4d_EE29/RSS_thumb.png" width="56" height="56" /></a> </p>         </td>          <td width="306">           <p><a href="http://channel9.msdn.com/shows/SilverlightTV/RSS/">Silverlight TV RSS Feed</a></p>            <p>Subscribe to the RSS feed for the show on Channel 9.</p>         </td>       </tr>        <tr>         <td width="162">           <p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7f977e907c4d_EE29/SilverlightTV_Bug_2.png"><img style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="SilverlightTV_Bug" border="0" alt="SilverlightTV_Bug" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7f977e907c4d_EE29/SilverlightTV_Bug_thumb.png" width="64" height="64" /></a> </p>         </td>          <td width="306">           <p><a href="http://www.twitter.com/SilverlightTV">Silverlight TV on Twitter</a></p>            <p>Follow <a href="http://www.twitter.com/SilverlightTV">@SilverlightTV</a> on Twitter for updates, alerts for new shows, and to submit comments and feedback. </p>         </td>       </tr>     </tbody></table> </p>
<p><b><i><font size="4">FAQ about Silverlight TV:</font></i></b></p>
<p><b></b></p>
<blockquote>   <p><b>Q. What is Silverlight TV?</b></p>    <p><b>A</b>. Silverlight TV is a new show in Channel 9’s lineup. Go behind the scenes at Microsoft with John Papa and learn what the Silverlight product team is dreaming up next. See exclusive interviews with the Silverlight product team, watch how community leaders are using Silverlight to solve real problems, and keep up with the latest happenings with Silverlight. Catch the inside scoop on Silverlight with Silverlight TV!</p>    <p><b></b></p>    <p><b>Q. Where can I watch Silverlight TV?</b></p>    <p><b>A</b>. Silverlight TV airs on <a href="http://channel9.msdn.com/shows/SilverlightTV/">Channel 9</a></p>    <p><b></b></p>    <p><b>Q. Who would benefit from watching Silverlight TV?</b></p>    <p><b>A. </b>Anyone interested in technical “how-to’s”, key Silverlight features, experiences from the real applications, and great examples of Silverlight. <b></b></p>    <p><b></b></p>    <p><b>Q. How long is each show?</b></p>    <p><b>A.</b> Each show lasts about 10-15 minutes, depending on the topic. </p>    <p><b></b></p>    <p><b>Q. How often will Silverlight TV air?</b></p>    <p><b>A.</b> Silverlight TV runs on an bi weekly schedule, however bonus shows will air prior to major events and announcements. For example, Silverlight TV will air once a week during the run-up to <a href="http://live.visitmix.com/">MIX10</a>.</p>    <p><b></b></p>    <p><b>Q. How do I request a topic for Silverlight TV?</b></p>    <p><b>A. </b>Send a message to <a href="http://www.twitter.com/SilverlightTV">@SilverlightTV</a> on Twitter. </p>    <p><b>Q. How can I help Silverlight TV?</b></p>    <p><b>A</b>. Blog, Tweet, Email, and Shout! Let all of your channels know about the new show! Feel free to forward this information to anyone who might be interested in Silverlight. </p> </blockquote>
<p>&#160;</p>
<p><strong><font color="#ff0000">More shows will air VERY soon!</font></strong></p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    January
    15th,
    
    2010
  </span>

  <h2>
    <a href="/silverlight/2010/01/15/use-your-silverlight-skills-to-win-a-pass-to-mix.html">Use Your Silverlight Skills to Win a Pass to MIX</a>
  </h2>

  <div>
    
    
    <p>The <a href="http://contest.silverlightshow.net/">Silverlight Show web site is hosting a contest</a> that can help you get a pass to MIX and/or get some travel expenses paid! Several Silverlight community leaders and our own Expression Evangelist, Adam Kinney, are judging the entries. Get your entries in by Feb 15th, 2010 <a href="http://contest.silverlightshow.net/">by registering for the contest here</a>.</p>
<p><a href="http://contest.silverlightshow.net/"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/UseYourSilverlightSkillstoWinaPasstoMIX_72B9/image_3.png" width="244" height="84" /></a> </p>
<p><strong>What Can I Win?</strong></p>
<p>I love contests, especially when the prizes rock! The Silverlight Show web site is hosting a great contest where you can use your Silverlight skills and win some great prizes that including passes to MIX! Here are the details for the prizes that I pulled from their web site:</p>
<blockquote>   <p>Our Grand Prize winner will receive a trip to <a href="http://live.visitmix.com/">MIX10 event</a> in Las Vegas (MIX10 pass, 3-night hotel stay at <a href="http://mandalaybay.com/">Mandalay Bay Hotel</a> and 1,000 USD for travel expenses included), and <a href="http://www.telerik.com">Telerik</a> Premium Collection for .NET! Two more MIX10 passes and more awards from <a href="http://www.telerik.com">Telerik</a> await the first runner-up, and the Community Choice winner! <a href="http://contest.silverlightshow.net/ContestRules.aspx#Prizes">Read more on the prizes.</a></p> </blockquote>
<p><strong>How do I Win?</strong></p>
<p>The contest asks participants to create a Silverlight application that helps support any kind of eco friendly activity. I copied this from the contest rules section of the web site:</p>
<blockquote>   <p>We invite you to use your Silverlight skills and imagination to design attractive, educative and informative Silverlight-based applications that help support and promote any kind of environment-friendly activities. Read the <a href="http://contest.silverlightshow.net/ContestRules.aspx">Official Rules</a> of our green contest!</p> </blockquote>
<p><strong>What about those discounts for MIX?</strong></p>
<p>Glad you asked! Don’t forget <strong>today is the last day </strong>for the $600 discount and free hotel night.</p>
<blockquote>   <p>If you register <strong>by Friday January 15th </strong>you get a free hotel night at the Mandalay Bay(for a 3 night stay) and get $600 off your MIX10 pass! So go register now before this expires in 2 days: <a href="http://live.visitmix.com/Registration">http://live.visitmix.com/Registration</a></p>    <p><a href="http://live.visitmix.com/"><img title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/DeepDiscountsforMIX10EndJan15th_7A1B/image_6.png" width="444" height="78" /></a></p></blockquote>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    January
    14th,
    
    2010
  </span>

  <h2>
    <a href="/silverlight/2010/01/14/deep-discounts-for-mix-10-end-jan-15th.html">Deep Discounts for MIX 10 End Jan 15th</a>
  </h2>

  <div>
    
    
    <p>My favorite conference of the year is approaching fast! MIX10 is shaping up to be a fantastic conference yet again. If you have attended MIX in prior years you know how the people and conversations found at MIX are top notch, rewarding and just a lot of fun. One of most memorable times at MIX09 is just the time I hung out in the common room where it seems everyone gathers before, during and after sessions. The keynote, sessions and speakers are all top notch and the after parties are not to be missed!</p>
<p><a href="http://live.visitmix.com/"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/DeepDiscountsforMIX10EndJan15th_7A1B/image_6.png" width="644" height="113" /></a> </p>
<p><strong>How can I get there?</strong></p>
<p>Last year there was a very popular discount promotion where you can get half price off and a deep discount on the hotel. This promotion is being offered again this year. If you register <strong>by Friday January 15th </strong>you get a free hotel night at the Mandalay Bay(for a 3 night stay) and get $600 off your MIX10 pass! So go register now before this expires in 2 days: <a title="http://live.visitmix.com/Registration" href="http://live.visitmix.com/Registration">http://live.visitmix.com/Registration</a></p>
<p><strong>Open Call For Speakers</strong></p>
<p>Something new this year for MIX is the open call for sessions. This year the best of the session proposals sent in via the MIX website are <a href="http://visitmix.com/opencallvote/">on a ballot where you can vote for them</a>. The top proposals getting the most votes will be added to the MIX schedule and the speakers will get their MIX pass on Microsoft <a href="http://live.visitmix.com/opencall">(details are here)</a>!&#160; Here is your chance to vote for the sessions you want to see at MIX. There are several great sessions proposals from community presenters on the ballot. <strong>Voting ends Friday Jan 15th, so hurry and vote now</strong>.</p>
<p><strong><a href="http://mix10k.visitmix.com/">Yet another way to get to MIX!</a></strong></p>
<p>Create an app, under 10k, and you could get a trip to MIX10! The popular MIX 10K Challenge is back again this year too. All participants get a free MIX 10K t0shirt designed for the MIX10 event. The grand prize winner will receive a trip to MIX10! <a href="http://mix10k.visitmix.com/">Official rules are on the web site</a>, where you can also <a href="http://mix10k.visitmix.com/">submit your entry</a>. Submissions must be received by Jan 29th, so gets yours in soon. </p>
<p><a href="http://mix10k.visitmix.com/"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/DeepDiscountsforMIX10EndJan15th_7A1B/image_5.png" width="242" height="181" /></a> </p>
<p>I look forward to seeing you there at MIX10!</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    January
    13th,
    
    2010
  </span>

  <h2>
    <a href="/silverlight/2010/01/13/seattle-silverlight-user-group-ndash-tonight.html">Seattle Silverlight User Group – Tonight!</a>
  </h2>

  <div>
    
    
    <p>Tonight I have the privilege of <a href="http://www.seattlesilverlight.net/">presenting an Overview of Silverlight 4 to the Seattle Silverlight User Group</a> (SeaSLUG as they like to be called). </p>
<p>The event starts at 7pm tonight, January 13th at the cafeteria in Building 40/41 on the Microsoft campus. this is a free event that should be a great gathering of the local Silverlight talent. I am looking forward to presenting several demos highlighting the new features and gathering feedback from the attendees.</p>
<p><strong>Where</strong>: Cafeteria in Building 40/41 on the Microsoft campus</p>
<p><strong>When</strong>: January 13th @ 7:00pm (tonight!)</p>
<p><strong>Directions</strong>: Directions can be found on the <a href="http://www.seattlesilverlight.net/">Silverlight User Group’s web site here</a>.</p>
<p>&#160;</p>
<p><a href="http://www.seattlesilverlight.net/"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/SeattleSilverlightUserGroupTonight_D9C3/image_3.png" width="282" height="216" /></a></p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    December
    31st,
    
    2009
  </span>

  <h2>
    <a href="/silverlight/2009/12/31/saving-snapshots-to-png-in-silverlight-4-and-the-webcam.html">Saving Snapshots to PNG in Silverlight 4 and the WebCam</a>
  </h2>

  <div>
    
    
    <p>This week I decided to experiment with a few webcam features and put together an application that activates a webcam, allows the user to take snapshots, and save the snapshots to PNG files. I like when demos use MVVM out of the box instead of just throwing all of the code in a single code behind, so one of my goals was to make a passing effort to break the code out and use MVVM practices.</p>
<p>The first thing I did was grab <a href="http://silverlight.net/learn/videos/silverlight-4-beta-videos/access-web-camera-microphone/">Tim Heuer’s webcam sample</a> which already handles activating the webcam. Tim did a great job with this, so instead of reinventing the wheel for this demo I decided to start with his code and add my requirements. First I wanted to hit the UI, so I created a new project, and copied the UI from Tim then took out what I did not need and add what I did need. Of course I did all of this in Expression Blend. Cider is great, but I’m faster in Blend by far. The UI is very simple, so this was a minimal effort. Here is the basic UI:</p>
<p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/SavingSnapshotstoPNGinSilverlight4andthe_C0F2/image_8.png" width="410" height="541" /></p>
<blockquote>   <p><em>This sample application uses the .NET ImageTools library. You can grab the source or binaries for it on </em><a href="http://imagetools.codeplex.com/"><em>codeplex here</em></a><em>.</em></p> </blockquote>
<p><strong>Files</strong></p>
<p>There are only a few files in this project, as shown in the image below.</p>
<ul>   <li>MainPage.xaml      <ul>       <li>View </li>     </ul>   </li>    <li>MainPageViewModel      <ul>       <li>ViewModel </li>     </ul>   </li>    <li>DelegateCommand      <ul>       <li>Generic class to handle the commanding features </li>     </ul>   </li>    <li>ViewModelBase      <ul>       <li>Contains basic VM features, like INotifyPropertyChanged implementation </li>     </ul>   </li>    <li>BitmapExtensions      <ul>       <li>Contains some simplification code to save to PNG from a WriteableBitmap </li>        <li>This uses the ImageTools.dll from codeplex </li>     </ul>   </li> </ul>
<p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/SavingSnapshotstoPNGinSilverlight4andthe_C0F2/image_7.png" width="285" height="540" /></p>
<p><strong>ViewModel</strong></p>
<p>The demo uses a View named MainPage.xaml as shown in the above screen capture. The View is bound to an instance of a ViewModel named MainPageViewModel. The VM contains several properties that the View uses in its bnidings:</p>
<ul>   <li>ICommand StartCaptureCommand </li>    <li>ICommand StopCaptureCommand </li>    <li>ICommand TakeSnapshotCommand </li>    <li>ICommand SaveSnapshotCommand </li>    <li>ObservableCollection&lt;WriteableBitmap&gt; Images </li>    <li>VideoBrush VideoBrush </li>    <li>WriteableBitmap SelectedSnapshot </li> </ul>
<p>The commands handle the interaction with the capture process and saving to the PNG file. We’ll look at those closer in a moment. The Images collection contains a series of WriteableBitmap instances that are gathered from the capture process. When someone clicks the Take Snapshot button, the WriteableBitmap is retrieved from the capture stream and added to the Images collection.</p>
<p>The VideoBrush property exposes the video stream to the View, through bindings. I am not convinced this is the ideal way to go as I generally do not like to expose a brush from a VM since a brush is View specific. One alternative is to expose the stream in another fashion and use a converter (yuk). Or another option is to perform the video capture in the View. I don;t have a problem with this being done in the View, but I wanted to show how this could work with MVVM. In this case I feel it’s acceptable either way.</p>
<p>The SelectedSnapshot property represents the WriteableBitmap that the user selects in the UI. When the user clicks the Save Snapshot button, this property is checked and saved to a PNG file.</p>
<p><strong>CaptureSource</strong></p>
<p>The code to activate the webcam and begin capturing the video stream is straightforward. First I created a private property named CapSource in my ViewModel. The CapSource is set in the constructor of the VM, with the video device set to the default video capture device as shown below:</p>
<div id="codeSnippetWrapper">   <div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">     <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum1">   1:</span> CapSource = <span style="color: #0000ff">new</span> CaptureSource</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum2">   2:</span> {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum3">   3:</span>     VideoCaptureDevice = CaptureDeviceConfiguration.GetDefaultVideoCaptureDevice()</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum4">   4:</span> };</pre>
<!--CRLF--></div>
</div>
<p><strong>Commanding</strong></p>
<p>I hooked a Command up to the “Start Capture” button using the new commanding features in Silverlight 4. The XAML to do this is very simple … you just bind to the Command which is in the ViewModel, in this case.</p>
<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">
<div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum1">   1:</span> <span style="color: #0000ff">&lt;</span><span style="color: #800000">StackPanel</span> <span style="color: #ff0000">Orientation</span><span style="color: #0000ff">=&quot;Horizontal&quot;</span> <span style="color: #ff0000">HorizontalAlignment</span><span style="color: #0000ff">=&quot;Center&quot;</span><span style="color: #0000ff">&gt;</span></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum2">   2:</span>     <span style="color: #0000ff">&lt;</span><span style="color: #800000">Button</span> <span style="color: #ff0000">Margin</span><span style="color: #0000ff">=&quot;5&quot;</span> <span style="color: #ff0000">Content</span><span style="color: #0000ff">=&quot;Start Capture&quot;</span> <span style="color: #ff0000">Height</span><span style="color: #0000ff">=&quot;25&quot;</span> <span style="color: #ff0000">Command</span><span style="color: #0000ff">=&quot;{Binding StartCaptureCommand}&quot;</span> <span style="color: #0000ff">/&gt;</span></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum3">   3:</span>     <span style="color: #0000ff">&lt;</span><span style="color: #800000">Button</span> <span style="color: #ff0000">Margin</span><span style="color: #0000ff">=&quot;5&quot;</span> <span style="color: #ff0000">Content</span><span style="color: #0000ff">=&quot;Stop Capture&quot;</span> <span style="color: #ff0000">Height</span><span style="color: #0000ff">=&quot;25&quot;</span> <span style="color: #ff0000">Command</span><span style="color: #0000ff">=&quot;{Binding StopCaptureCommand}&quot;</span> <span style="color: #0000ff">/&gt;</span></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum4">   4:</span>     <span style="color: #0000ff">&lt;</span><span style="color: #800000">Button</span> <span style="color: #ff0000">Margin</span><span style="color: #0000ff">=&quot;5&quot;</span> <span style="color: #ff0000">Content</span><span style="color: #0000ff">=&quot;Take Snapshot&quot;</span> <span style="color: #ff0000">Height</span><span style="color: #0000ff">=&quot;25&quot;</span> <span style="color: #ff0000">Command</span><span style="color: #0000ff">=&quot;{Binding TakeSnapshotCommand}&quot;</span> <span style="color: #0000ff">/&gt;</span></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum5">   5:</span>     <span style="color: #0000ff">&lt;</span><span style="color: #800000">Button</span> <span style="color: #ff0000">Margin</span><span style="color: #0000ff">=&quot;5&quot;</span> <span style="color: #ff0000">Content</span><span style="color: #0000ff">=&quot;Save Snapshot&quot;</span> <span style="color: #ff0000">Height</span><span style="color: #0000ff">=&quot;25&quot;</span> <span style="color: #ff0000">Command</span><span style="color: #0000ff">=&quot;{Binding SaveSnapshotCommand}&quot;</span><span style="color: #0000ff">/&gt;</span></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum6">   6:</span> <span style="color: #0000ff">&lt;/</span><span style="color: #800000">StackPanel</span><span style="color: #0000ff">&gt;</span></pre>
<!--CRLF--></div>
</div>
<p>The commands are set up in the constructor of the VM. I assigned each of the commands an action (for performing the action when the button is clicked) and a function (for determining if the button should be enabled or not). In Silverlight 4 we have the ICommand interface and now the new binding properties: Command and CommandProperty. We still need a commanding implementation. You can write one for each command (yuk), create some sort of command manager, or use an implementation of the DelegateCommand class. I chose the latter in this case because it is simple and still abstracts the boring parts of the commands for reuse. (You can check out the DelegateCommand class in the source code for this sample project.)</p>
<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">
<div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum1">   1:</span> StartCaptureCommand = <span style="color: #0000ff">new</span> DelegateCommand(StartCapture, CanStartCapture);</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum2">   2:</span> StopCaptureCommand = <span style="color: #0000ff">new</span> DelegateCommand(StopCapture, CanStopCapture);</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum3">   3:</span> TakeSnapshotCommand = <span style="color: #0000ff">new</span> DelegateCommand(TakeSnapshot, CanTakeSnapshot);</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum4">   4:</span> SaveSnapshotCommand = <span style="color: #0000ff">new</span> DelegateCommand(SaveSnapshot, CanSaveSnapshot);</pre>
<!--CRLF--></div>
</div>
<p><strong>Capture Video</strong></p>
<p>When the user clicks the button, the command fires in the VM. The StartCapture method checks the state of the capture and stops it if it is already in process. Then the VideoBrush is set to the capture source.</p>
<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">
<div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum1">   1:</span> <span style="color: #0000ff">private</span> <span style="color: #0000ff">void</span> StartCapture(<span style="color: #0000ff">object</span> obj)</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum2">   2:</span> {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum3">   3:</span>     <span style="color: #0000ff">if</span> (CapSource != <span style="color: #0000ff">null</span>)</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum4">   4:</span>     {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum5">   5:</span>         <span style="color: #0000ff">if</span> (CapSource.State != CaptureState.Stopped)</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum6">   6:</span>         {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum7">   7:</span>             CapSource.Stop(); <span style="color: #008000">// stop whatever device may be capturing</span></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum8">   8:</span>         }</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum9">   9:</span>&#160; </pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum10">  10:</span>         <span style="color: #008000">// create the brush</span></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum11">  11:</span>         VideoBrush.SetSource(CapSource);</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum12">  12:</span>&#160; </pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum13">  13:</span>         <span style="color: #008000">// request user permission and display the capture</span></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum14">  14:</span>         <span style="color: #0000ff">if</span> (CaptureDeviceConfiguration.AllowedDeviceAccess || CaptureDeviceConfiguration.RequestDeviceAccess())</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum15">  15:</span>         {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum16">  16:</span>             CapSource.Start();</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum17">  17:</span>         }</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum18">  18:</span>     }</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum19">  19:</span>     RefreshCommandStates();</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum20">  20:</span> }</pre>
<!--CRLF--></div>
</div>
<p>The “if” statement checks if the user has already allowed access to the device by checking CaptureDeviceConfiguration.AllowedDeviceAccess. If not, the user will be prompted to allow access to the camera and microphone using the CaptureDeviceConfiguration.RequestDeviceAccess method (see below). Then the capture process is started.</p>
<p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/SavingSnapshotstoPNGinSilverlight4andthe_C0F2/image_11.png" width="568" height="221" /></p>
<p>Finally, the RefreshCommandStates method is fired, which indirectly (through INPC events and bindings) enables or disables the buttons appropriately.</p>
<p><strong>Take a Snapshot from the Video</strong></p>
<p>When the capture process has started and a user clicks the Take Snapshot button, the appropriate command is invoked in the VM and the capture source’s AsyncCaptureImage method is invoked. I used the Dispatcher to make sure I operated on the UI thread because I wanted to not only grab the bitmap but I also want to update the View’s state. Again, not sure I like this in a VM, but I’ll take some liberties here and apply the ForemostItHasToWork pattern.</p>
<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">
<div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum1">   1:</span> <span style="color: #0000ff">private</span> <span style="color: #0000ff">void</span> TakeSnapshot(<span style="color: #0000ff">object</span> obj)</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum2">   2:</span> {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum3">   3:</span>     <span style="color: #0000ff">if</span> (CapSource != <span style="color: #0000ff">null</span> &amp;&amp; CapSource.State == CaptureState.Started)</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum4">   4:</span>     {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum5">   5:</span>         CapSource.AsyncCaptureImage((bitmap) =&gt;</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum6">   6:</span>             {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum7">   7:</span>                 App.Current.Resources.Dispatcher.BeginInvoke(() =&gt;</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum8">   8:</span>                 {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum9">   9:</span>                     Images.Add(bitmap);</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum10">  10:</span>                     SelectedSnapshot = bitmap;</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum11">  11:</span>                     RefreshCommandStates();</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum12">  12:</span>                 });</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum13">  13:</span>             });</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum14">  14:</span>     }</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum15">  15:</span> }</pre>
<!--CRLF--></div>
</div>
<p>&#160;<img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/SavingSnapshotstoPNGinSilverlight4andthe_C0F2/image_17.png" width="542" height="682" /></p>
<p><strong>Save to PNG</strong></p>
<p>Once the user has selected an image in the list, the Save Snapshot button is enabled. When the user clicks this button the SaveSnapshotCommand in the VM retrieves the WriteableBitmap from the SelectedSnapshot&#160; property (which is bound to the SelectedItem of the ListBox). Then an extension method I created on the WriteableBitmap saves the snapshot to a PNG file.</p>
<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">
<div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum1">   1:</span> <span style="color: #0000ff">private</span> <span style="color: #0000ff">void</span> SaveSnapshot(<span style="color: #0000ff">object</span> obj)</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum2">   2:</span> {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum3">   3:</span>     var bitmap = SelectedSnapshot;</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum4">   4:</span>     <span style="color: #0000ff">if</span> (bitmap != <span style="color: #0000ff">null</span>)</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum5">   5:</span>     {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum6">   6:</span>         bitmap.SaveToPNG();</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum7">   7:</span>     }</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum8">   8:</span>     RefreshCommandStates();</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum9">   9:</span> }</pre>
<!--CRLF--></div>
</div>
<p>This prompts the user for the file name and saves the png.</p>
<p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/SavingSnapshotstoPNGinSilverlight4andthe_C0F2/image_16.png" width="500" height="387" /></p>
<p><strong>A Word About PNG Conversion</strong></p>
<p>Once you have a WriteableBitmap (or an image for that matter) you can convert it to a PNG file. To do this it makes sense to use one of the existing libraries of conversion tools. One such tool was written by Joe Stegman and <a href="http://blogs.msdn.com/jstegman/archive/2008/04/21/dynamic-image-generation-in-silverlight.aspx">can be found here</a>. Joe’s PNG converter is straightforward and simply requires that you add 2 classes to your project. Another option is to use one of the tools on codeplex. A popular choice seems to be the <a href="http://imagetools.codeplex.com/">.NET ImageTools library</a> (thanks to several people on Twitter for alerting me to this). This library can be referenced and used pretty easily. It does more than just conversion to a PNG, but it handles what I need with relative ease. For all it does, I could not find a simple method that accepted a WriteableBitmap and outputted a PNG (or any file format). So I quickly wrote up quick extension method&#160; that handles this for me. Since this was my first glance at this open source API, it is likely that there is an easier/better way to convert from a WriteableBitmap to a PNG using ImageTools, so if you find one please leave a comment and I will update the code. It does the job nicely though and handles compression of the PNG.</p>
<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">
<div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum1">   1:</span> <span style="color: #0000ff">public</span> <span style="color: #0000ff">static</span> <span style="color: #0000ff">void</span> SaveToPNG(<span style="color: #0000ff">this</span> WriteableBitmap bitmap)</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum2">   2:</span> {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum3">   3:</span>     <span style="color: #0000ff">if</span> (bitmap != <span style="color: #0000ff">null</span>)</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum4">   4:</span>     {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum5">   5:</span>         SaveFileDialog sfd = <span style="color: #0000ff">new</span> SaveFileDialog</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum6">   6:</span>                  {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum7">   7:</span>                  Filter = <span style="color: #006080">&quot;PNG Files (*.png)|*.png|All Files (*.*)|*.*&quot;</span>,</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum8">   8:</span>                  DefaultExt = <span style="color: #006080">&quot;.png&quot;</span>,</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum9">   9:</span>                  FilterIndex = 1</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum10">  10:</span>                  };</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum11">  11:</span>&#160; </pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum12">  12:</span>         <span style="color: #0000ff">if</span> ((<span style="color: #0000ff">bool</span>)sfd.ShowDialog())</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum13">  13:</span>         {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum14">  14:</span>             var img = bitmap.ToImage();</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum15">  15:</span>             var encoder = <span style="color: #0000ff">new</span> PngEncoder();</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum16">  16:</span>             <span style="color: #0000ff">using</span> (Stream stream = sfd.OpenFile())</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum17">  17:</span>             {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum18">  18:</span>                 encoder.Encode(img, stream);</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum19">  19:</span>                 stream.Close();</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum20">  20:</span>             }</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum21">  21:</span>         }</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum22">  22:</span>     }</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum23">  23:</span> }</pre>
<!--CRLF--></div>
</div>
<p><strong>From Here</strong></p>
<p>The webcam and microphone features in Silverlight 4 are fun to work with and can be useful to grab images and save them (or email them, or stream them, etc). I had a good time putting this together and learned about the PNG conversion options along the way.</p>
<p>You can <a href="/wp-content/uploads/files/downloads/Papa-WebCamSnapshots.zip">download the source code here</a> for the entire sample application. Enjoy!</p>
<p><strong><font color="#ff0000">UPDATE (Jan 03,2010)</font></strong>: <a href="http://blog.galasoft.ch/">Laurent Bugnion</a> alerted me that there indeed is a ToImage method in the ImageTools library. The trick is to make sure you download the right link from the ImageTools codeplex site. The first link just gives you the basics, the second link gives you all the dll’s. Once I downloaded that second link I was able to add references to a few assemblies in the ImageTools library that cleaned out some of my code for my extension method. The net result is that my extension method is considerably shorter and clearer. I just updated the extension method in the above code window and in the downloadable code. Feel free to grab the latest and run with it!</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    December
    17th,
    
    2009
  </span>

  <h2>
    <a href="/silverlight/uncategorized/2009/12/17/silverlight-4-html-puzzle-how-does-it-work.html">Silverlight 4 HTML Puzzle&#58; How Does It Work?</a>
  </h2>

  <div>
    
    
    <p><a href="http://weblogs.asp.net/scottgu/archive/2009/12/16/silverlight-4-demos-from-my-pdc-keynote-now-available.aspx">Scott Guthrie just announced on his blog</a> that many of <a href="http://www.silverlight.net/community/samples/silverlight-4-beta/">the demos that he presented during the PDC keynote are now available online</a>. Both the demos and their source code are now online and available for you to download. Be sure to go grab the code and check them out! </p>
<blockquote>   <p><em>Learn More: </em>If you are interested in learning more about the features in Silverlight 4 beta, grab the <a href="http://ecn.channel9.msdn.com/o9/learn/Silverlight4/Labs/Overview/WhatsNewInSilverlight4.docx">Silverlight 4 Technical Whitepaper here</a>. You can also walk through some hands on labs and other learning materials from both:</p>    <ul>     <li><a href="http://channel9.msdn.com/learn/courses/Silverlight4/">Channel 9’s Silverlight 4 Training</a></li>      <li><a href="http://silverlight.net/learn/">Silverlight.net’s Silverlight 4 beta learning section</a>&#160;&#160; </li>   </ul> </blockquote>
<p>I decided to break down the project for the HTML Hosting &amp; Puzzle application for those who are interested in how it works.</p>
<p><img src="http://weblogs.asp.net/blogs/scottgu/image_734F75FE.png" width="519" height="291" /></p>
<p><u><strong>What does it do?</strong></u></p>
<p>This project demonstrates many features, including these features:</p>
<ul>   <li>Multi-Touch gestures</li>    <li>WebBrowser control</li>    <li>HTML Brush</li> </ul>
<blockquote>   <p>The HTML Hosting &amp; Puzzle application shows off using the new Silverlight 4 WebBrowser control in an out of browser application (note: you must run the application out of the browser for it to work).&#160; It allows you to use the control both interactively (meaning you can click the HTML within it and run it like an application).&#160; It also allows you to use the hosted HTML as a brush that you can apply to other Silverlight controls. For fun you can click the second tab and you’ll get <a href="http://en.wikipedia.org/wiki/Rickrolling">rick-rolled</a> to YouTube.&#160; You can still use the HTML as a brush and carve it up into a jigsaw – even though the video is still playing (using<a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_2.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; margin-left: 0px; border-top: 0px; margin-right: 0px; border-right: 0px" title="image" border="0" alt="image" align="right" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb.png" width="181" height="291" /></a> Flash hosted within the HTML). Also, if you have a multi-touch device, you can use your fingers to drag and rotate puzzle pieces.</p> </blockquote>
<p><u><strong>The Solution Explorer</strong></u></p>
<p>The project is named SLMTPuzzle (Silverlight Multi-Touch Puzzle) and contains a set of images, a generic.xaml for some custom controls, and a series of Views and code files for the puzzle logic. </p>
<p><u><strong>Vector.cs</strong></u></p>
<p>The Vector struct is used in presenting the motion for the puzzle pieces.</p>
<p><u><strong>TouchProcessor.cs</strong></u></p>
<p>This contains a helper class, TouchProcessor, and several other helper classes that capture and process touch events. This is not required for multi-touch, but make sit easier to process the events.</p>
<p><u><strong>PuzzleDesigner.xaml</strong></u></p>
<p>This control is actually not used in the project and can be excluded from it. I used this control simply as a design surface to create the puzzle pieces and make it obvious what shapes I needed. Notice that there are 9 shapes for the puzzle pieces. With these 9 shapes a puzzle of various larger sizes can be created. For example, in a puzzle that is 6 across the top and 3 tall (18 pieces in total), the top center piece would be used 4 times as would the middle and bottom center pieces.</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_6.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_2.png" width="244" height="202" /></a> </p>
<p>Drawing the puzzle pieces was quite simple using Expression Blend. I put the basic steps to create the “Top left” and “Top center” puzzle pieces here:</p>
<p>1. Make the container object a Canvas (Grid panels can resize and stretch, which we do not want in this case)</p>
<p>2. Create a rectangle of the width and height you desire. Set the fill color to yellow.</p>
<p>3. Add a circle using the ellipse tool. You can make it a circle by holding the SHIFT key down while sizing the ellipse. Set the fill color to green. (Note the size of the circle, we’ll be using this again later)</p>
<p>4. Copy and paste the circle shape to make a duplicate. Set this circle’s Fill color to red. (The colors are simply for demonstration purposes.)</p>
<p>5. Place the red circle on the right side of the rectangle and the green circle on the bottom of the rectangle. Make exactly about a 3rd of the circles overlap the rectangle. Your control should look something like this:</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_12.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_5.png" width="244" height="179" /></a>&#160;</p>
<p>6. Select the 3 shapes.</p>
<p>7. Right click the selection and choose from the menu Combine | Unite. The shapes are now combined into a single path as shown below. The circles became the nubs for the puzzle piece.</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_14.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_6.png" width="244" height="188" /></a> </p>
<p>8. This puzzle piece could now work as the top left piece. Now that it is created, let’s create the top middle piece, so copy the entire piece and paste it to create a duplicate. Set the Fill of the new piece to Blue.</p>
<p>9. Align the 2 pieces as shown below.</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_18.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_8.png" width="244" height="94" /></a> </p>
<p>10. Set the canvas’ background to white. This will make it easier to see if the puzzle pieces align properly.</p>
<p>11. Create another circle with the same exact size as the puzzle nub you created in step 3. Set its fill color to Red.</p>
<p>12. Position the red circle directly over the right nub of the yellow puzzle piece.</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_20.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_9.png" width="244" height="95" /></a> </p>
<p>13. Position the blue puzzle piece adjacent to the yellow puzzle piece.</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_22.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_10.png" width="244" height="102" /></a> </p>
<p>14. Now it is time to carve a shape out the blue puzzle piece so the yellow puzzle piece can fit it. select the red circle and the blue puzzle piece.</p>
<p>15. Right click and from the menu choose Combine | Subtract. This subtracts the red circle from the blue path. The results should look as follows:</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_24.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_11.png" width="244" height="104" /></a> </p>
<p>16. Notice the puzzle pieces fit together and can be pulled apart as shown below.</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_26.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_12.png" width="244" height="94" /></a> </p>
<p>This process can be repeated to create various shapes of puzzle pieces. Of course, you can get much more creative in creating puzzle pieces, but this is a simple way to get started. The paths for these shapes can then be used as the basis for the puzzle pieces.</p>
<p><strong><u>HtmlPuzzlePiece.cs</u></strong></p>
<p>The puzzle pieces themselves are represented by the HtmlPuzzlePiece custom control. This custom control contains all of the logic necessary to handle the events and motion for each puzzle piece. Each puzzle will contain many instances of this control, using various paths to shape the puzzle pieces.</p>
<p><strong><u>HtmlPuzzle.cs</u></strong></p>
<p>The puzzle is represented by the custom control HtmlPuzzle, which handles various events and actions such as:</p>
<ul>   <li>Navigating to a web address to display the HTML content in the WebBrowser control</li>    <li>Redrawing the HTML content using the HtmlBrush in the puzzle pieces</li>    <li>Setting the redraw rate to 60x per second</li>    <li>Toggle the state between the WebBrowser control (interactive HTML) and the HtmlBrush mode (for video)</li>    <li>Scramble the puzzle pieces</li>    <li>Solve the entire puzzle</li>    <li>Solve one piece of the puzzle (hint)</li> </ul>
<p>As you can see, the HtmlPuzzle custom control is where the bulk of the interaction is handled. </p>
<p><strong><u>MainPage.xaml</u></strong></p>
<p>This is the main user control that loads the WebBrowser control or the puzzle (through the HtmlPuzzle control). It has a button which toggles the state for the HtmlPuzzle control between the WebBrowser control (the Browse button) and the puzzle ( the Puzzlify button). </p>
<p>“Browse” mode</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_32.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_15.png" width="244" height="152" /></a> </p>
<p>“Puzzle” mode</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_30.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_14.png" width="244" height="152" /></a> </p>
<p><strong><u>InstallView.xaml</u></strong></p>
<p>The InstallView control is shown when the application is run inside of the browser. If the application is not installed out-of-browser the InstallView control will allow the user to install the application by clicking a button, as shown below:</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_34.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_16.png" width="244" height="185" /></a> </p>
<p>If the application is installed out-of-browser already, the InstallView control will alert the user and disable the Install button. Again, the InstallView control is only displayed when running in browser.</p>
<p><strong><u>Auto-Updates</u></strong></p>
<p>The application automatically checks for updates and, if found, retrieves the update and alerts the user to close and re-open the application to get the update. The code is quite simple to do this … simply handle the App.Current object’s CheckAndDownloadUpdateCompleted event, check for the update, and in the event handler alert the user (see the code below).</p>

<pre class="prettyprint linenums">
public MainPage()
{
    InitializeComponent();

    int refreshInterval = 33; // ms
    _timer = new DispatcherTimer() { Interval = TimeSpan.FromMilliseconds(refreshInterval) };
    _timer.Tick += new EventHandler(timer_Tick);

    this.Loaded += new RoutedEventHandler(MainPage_Loaded);
    App.Current.CheckAndDownloadUpdateCompleted += CheckAndDownloadUpdateCompleted;
    App.Current.CheckAndDownloadUpdateAsync();
}

private void CheckAndDownloadUpdateCompleted(object sender, CheckAndDownloadUpdateCompletedEventArgs e)
{
    if (App.Current.IsRunningOutOfBrowser &amp;&amp; e.UpdateAvailable)
    {
        MessageBox.Show(
            "A new update is available for the Multi-Touch Puzzle. Please close the application and restart it to install the latest update.",
            "Multi-Touch Puzzle Update Available",
            MessageBoxButton.OK);
    }
}
</pre>

<p><strong><u>Wrap-Up</u></strong></p>
<p>That’s the application from a high level. The logic to rotate the pieces, give accelerate and decelerate them when moved, and to scramble &amp; solve them is a little more involved. But the code is here so you can dive in and follow along to understand these aspects. If you have any questions please drop me a comment or an email. Once again <a href="http://www.silverlight.net/community/samples/silverlight-4-beta/HTML-Puzzle/">you can download the entire sample from here</a>. </p>
<p><em>NOTE: This application requires Silverlight 4 Beta</em></p>


    
    
  </div>

</article>

<hr/>

<ul class="pager"> 

  
  <li class="previous">
    
    <a href="/page88">&larr; Newer</a>
    
  </li>
  
  
  <li>
    <span class="page_number">Page: 89 of 136</span>
  </li>

  
  <li class="next">
    <a href="/page90">Older &rarr;</a>
  </li>
  

</ul>




		<footer>
			<hr/>
			<p>
				&copy; 2015 dbyll with Jekyll. Theme: <a href="https://github.com/dbtek/dbyll">dbyll</a> by dbtek.
			</p>
		</footer>
	</div>

	<script type="text/javascript" src="/assets/resources/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="/assets/resources/bootstrap/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/assets/js/app.js"></script>
</body>
</html>



<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl =
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'dbyll']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

