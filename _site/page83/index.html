<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>JohnPapa.net</title>
    
    <meta name="author" content="John Papa">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

    <!-- Le styles -->
    <link href="/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="/assets/resources/syntax/syntax.css" rel="stylesheet">
    <link href="/assets/css/style.css" rel="stylesheet">

    <link rel="shortcut icon" type="image/x-icon" href="assets/ico/favicon.ico">

    <!-- Le fav and touch icons -->
    <!-- Update these with your own images
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

    <link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">

</head>

<body>
    <nav class="navbar navbar-default visible-xs" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            
            <a type="button" class="navbar-toggle nav-link" href="http://github.com/johnpapa">
                <i class="fa fa-github"></i>
            </a>
            
            
            <a type="button" class="navbar-toggle nav-link" href="http://twitter.com/john_papa">
                <i class="fa fa-twitter"></i>
            </a>
            
            
            <a class="navbar-brand" href="/">
                <img src="http://www.gravatar.com/avatar/0d3794fe37746ea54926ca6878712721?s=35" class="img-circle" />
                
            </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li class="active"><a href="/">Home</a></li>
                <li><a href="/categories.html">Categories</a></li>
                <li><a href="/tags.html">Tags</a></li>
            </ul>
        </div><!-- /.navbar-collapse -->
    </nav>

    <!-- nav-menu-dropdown -->
    <div class="btn-group hidden-xs" id="nav-menu">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            <i class="fa fa-bars"></i>
        </button>
        <ul class="dropdown-menu" role="menu">
            <li><a href="/"><i class="fa fa-home"></i>Home</a></li>
            <li><a href="/categories.html"><i class="fa fa-folder"></i>Categories</a></li>
            <li><a href="/tags.html"><i class="fa fa-tags"></i>Tags</a></li>
            <li class="divider"></li>
            <li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
        </ul>
    </div>

    <div class="col-sm-4 sidebar hidden-xs hidden-sm not-mobile">
        <!-- sidebar.html -->
<header class="sidebar-header" role="banner">
	<h1 class="text-center">John Papa</h1>
	<a href="/">
		<img src="http://www.gravatar.com/avatar/0d3794fe37746ea54926ca6878712721?s=150" class="img-circle" />
	</a>
	<h3 class="title">
		<a href="/"></a>
	</h3>
</header>


<div id="bio" class="text-center">
	Evangelist on the Loose
</div>


<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/johnpapa">
				<i class="fa fa-github-alt fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://twitter.com/john_papa">
				<i class="fa fa-twitter fa-lg"></i>
			</a>
		</li>
		
		<li>
			<a class="btn btn-default btn-sm" href="/feed.xml">
				<i class="fa fa-rss fa-lg"></i>
			</a>
		</li>
	</ul>

	<div class="sidebar-content">

		<nav id="page-nav">
			<ul class="main-navigation list-unstyled list-inline">
				<li><a href="/about/">About</a></li>
				<li><a href="/articles">Articles</a></li>
				<li><a href="/spa">SPA</a></li>
				<li><a href="/videos">Videos</a></li>
			</ul>
		</nav>

		<h5>Recent Posts</h5>
		<ul class="list-unstyled">
			
				<li>
					<span>16 Sep 2015</span> &raquo;
					<a href="/angular/angular2/community/event/javascript/uncategorized/2015/09/16/angular-2-hack-night-coming-to-orlando.html">
					Angular 2 Hack Night Coming to Orlando</a>
				</li>
			
				<li>
					<span>29 Aug 2015</span> &raquo;
					<a href="/angular/asp.net/github/gulp/html5/javascript/pluralsight/typescript/uncategorized/visual%20studio%20code/2015/08/29/learning-visual-studio-code.html">
					Learning Visual Studio Code</a>
				</li>
			
				<li>
					<span>23 May 2015</span> &raquo;
					<a href="/uncategorized/2015/05/23/visual-studio-code-webinar.html">
					Visual Studio Code Webinar</a>
				</li>
			
				<li>
					<span>23 May 2015</span> &raquo;
					<a href="/uncategorized/2015/05/23/automatically-restarting-asp-net-on-osx-with-dnxmon.html">
					Automatically Restarting ASP.NET on OSX with DNXMON</a>
				</li>
			
				<li>
					<span>23 May 2015</span> &raquo;
					<a href="/uncategorized/2015/05/23/getting-started-with-asp-net-5-on-osx.html">
					Getting Started with ASP.NET 5 on OSX</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/refactoring-with-visual-studio-code.html">
					Refactoring with Visual Studio Code</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/intellisense-witha-visual-studio-code.html">
					Intellisense with Visual Studio Code</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/git-and-preferences-in-visual-studio-code.html">
					Git and Preferences in Visual Studio Code</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/debugging-with-visual-studio-code.html">
					Debugging with Visual Studio Code</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/visual-studio-code.html">
					Introducing Visual Studio Code</a>
				</li>
			
		</ul>
	</div>

</div>
<!-- sidebar.html end -->
        <div class="not-mobile row sidebar-extras">
            <table class="col-centered">
                <tbody>
                    <tr>
                        <td>
                            <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="160x600"></div>
                        </td>
                        <td>
                            <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="160x600"></div>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="300x250"></div>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="300x250"></div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="col-sm-8">
        <div class="page-header">
  <h1>JohnPapa.net </h1>
</div>



<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/enterprise-library-data-access-application-block-part-1.html">Enterprise Library Data Access Application Block, Part 1</a>
  </h2>

  <div>
    
    
    <p>The <a href="http://msdn.microsoft.com/msdnmag/issues/05/07/default.aspx">July 2005 issue of MSDN Magazine</a> is now available online. The amount of discussion that has surrounded the Enterprise Library and its Application Blocks (good, bad and indifferent) has been tremendous. I decided to create a 3 part series that explores the Enterprise Library Data Access blocks <a href="http://msdn.microsoft.com/msdnmag/issues/05/07/DataPoints/default.aspx">in my Data Points column</a>. In this issue I discuss how how the Enterprise Library DAAB fits into an architecture as well as some best practices in using the block. I review the Enterprise Library model and dive right into the DAAB and its configuration and cryptography features, when and where the DAAB can be used, and lots more. </p>
<p>There is a lot to review with Ent Lib and onyl so much fits into an article, so I decided to split this up into a 3 parter. In the upcoming Part 2 and Part 3 I explore how post build events can be used to ease the use of configuration files, several ways of retreiving data, saving data, transactions with Ent Lib, using NUnit with&nbsp;Ent Lib, and its factory model.</p>
<p>&nbsp;</p>
<p><a href="http://msdn.microsoft.com/msdnmag/issues/05/07/default.aspx">&lt;IMG src=”/photos/jpapa/images/64573/original.aspx” border=0&gt;</a></p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/datatable-becomes-a-real-boy-in-ado-net-2.html">DataTable Becomes a Real Boy in ADO.NET 2</a>
  </h2>

  <div>
    
    
    <p>I am really excited about some of the new features in ADO.NET 2. I <a href="/blogs/john.papa/archive/2005/03/30/ADO_NET_2_DataTable_Merge.aspx">posted here last month</a> regarding how the ADO.NET 2 DataTable class will expose a Merge method (woo hoo!).&nbsp;I found this very useful when I had DataTable's to merge but no DataSet (and thus had to create a DataSet just to merge the DataTable objects -- yuk!) </p>
<p>Anyway, there are other situations where I had a DataTable sans a DataSet and I had to create a DataSet just to take advantage of some features it had that the DataTable didn't. In ADO.NET 2, a lot of attention appears to have been paid to the DataTable as it now has many of the features of the DataSet. For example, in ADO.NET 2 you can get the following method on a ADO.NET 2 DataTable that were formerly only available in a DataSet:</p>
<ul> <li>Merge <li>ReadXml <li>ReadXmlSchema <li>WriteXml <li>WriteXmlSchema</li> <p>I never liked how the DataTable did not have the xxxXml method in its arsonal. But at least the next incarnation of ADO.NET will have incldued many of the features that the DataSet already has ... a bit of catch-up, I guess. </p> <p>I'm very excited about the ability to create a DataTable from a DataView, the DataTable's&nbsp;new GetDataReader method, the fact that&nbsp;I can now change the DataRow.RowState&nbsp;manually, and the plethora of other features as well! I'm having fun putting together some code samples for <a href="http://www.ftponline.com/conferences/vslive/2005/bo/">VSLive</a>, <a href="http://msdn.microsoft.com/msdnmag/">MSDN Magazine</a> and <a href="/blogs/john.papa">my codebetter.com blog</a> on these cool ADO.NET 2 features! </p> <p>&nbsp;</p>



</li></li></li></li></ul>

    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/comments-to-msdn-magazine.html">Comments to MSDN Magazine</a>
  </h2>

  <div>
    
    
    <p>I have been writing for <a href="http://msdn.microsoft.com/msdnmag/default.aspx">MSDN Magazine</a> for almost 7 years with what started out as feature articles and moved into my current <a href="http://msdn.microsoft.com/msdnmag/find/default.aspx?type=Ti&amp;phrase=Data%20Points&amp;words=exact">Data Points</a> column. 7 years is a long time and is it suggests, I love working for them. I get a lot of comments via email from readers and despite the volume, I do read all of them. I don't have the time to reply to all of them, although I do try my best. For those of you who send comments in, thank you ... I enjoy hearing feedback on what you liked, thought could be improved, was left out, what would be valuable for future articles. </p>
<p>Every now and then, the MSDN Magazine crew sends us all the comments that people have posted as they're rating the articles. Most of them are helpful, and most are very positive and have great comments. I get a few that rate my articles 1 out of 9 but then say the article was great ;-) I also get a few that rate it 1 out of 9 and simply did not like the article's content. I appreciate all of the feedback. I really do. So please keep it coming, I hope you enjoy them!</p>
<p>NOTE: <a href="http://www.mcwtech.com/CS/blogs/keng/archive/2005/04/13/30.aspx">Ken Getz blogged today about his MSDN comments</a>, too.</p>
<p>&nbsp;</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/collections-and-data-binding-with-dino.html">Collections and Data Binding with Dino</a>
  </h2>

  <div>
    
    
    <p>For a look at a non ADO.NET solution ... <a href="http://weblogs.asp.net/despos/">Dino Esposito</a> wrote an article called <a href="http://msdn.microsoft.com/msdnmag/issues/05/05/CuttingEdge/default.aspx">Collections and Data Binding</a> in a recent <a href="http://msdn.microsoft.com/msdnmag">MSDN Magazine</a> issue. Its a good read and addresses how to bind collections to controls, as opposed to using ADO.NET objects for binding. I believe he is going to follow this up with a discussion of collections vs DataSets in a future issue.</p>
<p>&nbsp;</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/class-diagrams-in-visual-studio-net-beta-2.html">Class Diagrams in Visual Studio.NET Beta 2</a>
  </h2>

  <div>
    
    
    <p>A few days ago <a href="/blogs/raymond.lewallen/archive/2005/04/26/62457.aspx">Raymond Lewallen blogged about refactoring</a> some VB.NET code using interfaces, and abstract classes. I followed up with <a href="/blogs/john.papa/archive/2005/04/26/62501.aspx">a C# example of the same code in a blog</a>. I thought this would be interesting to see how it looks in a VS.NET Beta 2 class diagram. One of the nice features that I like about the tool is that it lets me export an image of the diagram in a variety of formats. </p>
<p>&lt;IMG alt="" src="/photos/jpapa/images/62566/original.aspx" border=0 style="border-style:none;"&gt;</p>
<p>The class diagram is easy to use … just drag and drop a class onto it. I can right click the classes refactor or add fields, properties, methods, and constants. Nothing glamorous, but when you are a visual developer like me, it often is nice to see the class structure in a diagram like this. Yeah there are tools that do it for you, but now its built in.</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/clarifying-ado-net-2-batch-updates.html">Clarifying ADO.NET 2 Batch Updates</a>
  </h2>

  <div>
    
    
    <p>Pablo Castro, Microsoft's Program Manager of the ADO.NET Team, <a href="http://blogs.msdn.com/dataaccess/archive/2005/05/19/420065.aspx">has a good post last week</a> that helps clarify how bath updates are intended to work in ADO.NET 2. This is a common discussion that I am drawn into since the DataAdapter actually invokes its command for each modified row in the DataTable that it is associated with. Thus if you have a DataTable with the following deltas:</p>
<ul> <li>7 modified rows <li>2 added rows <li>2&nbsp;deleted rows</li> <p>The DataAdapter will invoke the UpdateCommand 7 times, the InsertCommand 2 times and the DeleteCommand 2 times for a total of 11 round trips. There are several ways to work around this, some of which Pablo points out such as sending all of the SQL statements down at once manually. You can also use diffgrams using <a href="http://msdn.microsoft.com/msdnmag/issues/05/06/DataPoints/">SQL Server's XML features</a>, too. But none of the solutions is as elegant as how ADO.NET shoulda, coulda , woulda handled it. Kudos to Pablo for a good explanation!</p>



</li></li></ul>

    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/c-casting-quiz.html">C# Casting Quiz</a>
  </h2>

  <div>
    
    
    <p>There are several ways to convert and cast values in .NET. For example, DirectCast versus System.Convert and if you are a VB.NET'er, you have the CInt, CBool, C<i>xxx</i> functions. It is along these lines that I offer this quiz: What are the differences between&nbsp;the following ways to cast an object?</p>
<p>&nbsp;</p>
<fieldset><legend>Casting quiz</legend><pre><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Arial"><span style="COLOR: green">/// Technique #1</span> <span style="COLOR: blue">object</span> item = GetIt(); Dog dog = (Dog)item; <span style="COLOR: green">/// Technique #2</span> <span style="COLOR: blue">object</span> item = GetIt(); Dog dog = item <span style="COLOR: blue">as</span> Dog; <span style="COLOR: blue">public object</span> GetIt() { <span style="COLOR: blue">object</span> x = <span style="COLOR: blue">null</span>; <span style="COLOR: green">/// Does something that tries to get an instance of an object</span> <span style="COLOR: blue">...</span> <span style="COLOR: blue">...</span> <span style="COLOR: blue">...</span> <span style="COLOR: blue">return</span> x; } </span></pre></fieldset>
<p><br />What is the difference between these 2 techniques of casting and when would you want to use one over the other?</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/binding-children-rows-to-a-datagrid-with-ado-net-datarelations.html">Binding Children Rows to a DataGrid with ADO.NET DataRelations</a>
  </h2>

  <div>
    
    
    <p>Over the past few days I've had a few questions regarding a situation where there is a list of parent rows (let's say Orders) loaded into a dropdown list and a list of child rows (let's say Order Details) loaded into a grid. The idea being that when the user selects the Order from the dropdown list, the Order Details grid loads that Order's Order Details records without querying the database again. The DataSet contains all of&nbsp;the Orders and their Order Details rows&nbsp;and they are related by a DataRelation. In this situation you only want the Order Details for the selected Order to be bound to the DataGrid. (In this sample I wil focus on how to do this using the <b>DataRowView.CreateChildView</b> method.) Here is what the web page will look like:</p>
<p><img alt="" src="/photos/jpapa/images/61700/original.aspx" border="0" /></p>
<p>So let's review the situation before going any further:</p>
<ol> <li> A single DataSet stores all Orders for a specific customer and all of those Orders' Order Details <li> The DataSet contains a DataRelation that relates the parent/child DataTables (Orders/Order Details) <li> The DataSet is read-only, for viewing purposes only. <li> The DataSet needs to be cached somewhere. <li> The data is not volatile <li> When an order is selected, only its Order Details should be displayed in the DataGrid</li> <p>First, to load the DataSet there is a method called RefreshDataSetFromDB. This hits the database, grabs the Orders and&nbsp;the Order Details, throws them into 2 DataTable objects within the same DataSet and relates them via a DataRelation.</p> <fieldset> <legend>Get the 2 Tables from the DB</legend> <span style="COLOR: black;font-size: 9pt;font-family:Arial;"><span style="COLOR: blue;">private</span> DataSet RefreshDataSetFromDB() <br />{ <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">string</span> sCn = "server=(local);database=northwind;integrated security=true;"; <br />&nbsp;&nbsp;&nbsp;&nbsp;DataSet ds = <span>new</span> DataSet(); <br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">using</span> (SqlConnection cn = <span style="COLOR: blue">new</span> SqlConnection(sCn)) <br />&nbsp;&nbsp;&nbsp;&nbsp;{ <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cn.Open(); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">string</span> sqlOrders = "SELECT OrderID FROM ORDERS WHERE CustomerID = 'ALFKI'"; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">using</span> (SqlCommand cmd = <span style="COLOR: blue">new</span> SqlCommand(sqlOrders, cn)) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">using</span> (SqlDataAdapter da = <span style="COLOR: blue">new</span> SqlDataAdapter(cmd)) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;da.Fill(ds, "Orders"); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StringBuilder sb = <span style="COLOR: blue">new</span> StringBuilder(""); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.Append("SELECT od.OrderID, p.ProductID, p.ProductName, od.UnitPrice, od.Quantity");<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.Append(" FROM [Order Details] od INNER JOIN Products p ON od.ProductID = p.ProductID"); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.Append(" WHERE OrderID IN ("); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sb.Append(" SELECT OrderID FROM Orders WHERE CustomerID = 'ALFKI')"); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">string</span> sqlOrderDetails = sb.ToString(); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">using</span> (SqlCommand cmd = <span style="COLOR: blue">new</span> SqlCommand(sqlOrderDetails, cn)) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">using</span> (SqlDataAdapter da = <span style="COLOR: blue">new</span> SqlDataAdapter(cmd)) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;da.Fill(ds, "Order Details"); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ds.Relations.Add("OrdersToOrderDetails", <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ds.Tables["Orders"].Columns["OrderID"], <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ds.Tables["Order Details"].Columns["OrderID"]); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cn.Close(); <br />&nbsp;&nbsp;&nbsp;&nbsp;} <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">return</span> ds; <br />} <br /></span> </fieldset> <p>Normally I'd be using stored procedures here, but for simplicity sake of this code sample I used inline SQL. I also would not hard code the CustomerID, instead I would use a parameter passed in from somewhere (a post from another form, a control on this page, outer space, who knows). Since I built my inline SQL statement, notice the use of the StringBuilder class to build the SQL statement for the Order Details. Once I have to concatenate 3 lines or more, I use the StringBuilder. If I concatenate string objects together instead, the fact that strings are immutable means that I keep creating and throwing the value away. What's my point: StringBuilder good. Concat bad. </p> <p>I used the <a href="/blogs/john.papa/archive/2005/04/01/60984.aspx">using</a> statement quite a bit in the RefreshDataSetFromDB method. The <a href="/blogs/john.papa/archive/2005/04/01/60984.aspx"> using</a> statement will clean up my resources when its block ends. Quite a nice feature in my opinion. And while I am at it, I would not hard code my connection string. Instead I would store it in a custom config file or the web.config. </p> <p>Alright, that's relatively basic ADO.NET. To load the page I use the following code which grabs a DataSet. On the first call to the page I also load the Order rows into the dropdown list.</p> <fieldset> <legend>Page_Load</legend> <span style="COLOR: black;font-size: 9pt;font-family:Arial;"><br /><span style="COLOR: blue">private</span> <span style="COLOR: blue">void</span> Page_Load(object sender, System.EventArgs e) <br />{ <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: green">// Get the DataSet</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;DataSet ds = GetDataSetFromCache(); <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">if</span> (!IsPostBack) <br />&nbsp;&nbsp;&nbsp;&nbsp;{ <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoadOrdersList(ds); <br />&nbsp;&nbsp;&nbsp;&nbsp;} <br />} </span> </fieldset> <p><br /> When I call GetDataSetFromCache, it the DataSet is not in Cache, then I go get the data from the database using the RefreshDataSetFromDB method. Then I stick the DataSet in the Cache. <br /> </p> <fieldset> <legend>GetDataSetFromCache </legend> <span style="COLOR: black;font-size: 9pt;font-family:Arial;"><br /><span style="COLOR: blue">private</span> DataSet GetDataSetFromCache() <br />{ <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: green">// test // Cache.Remove("MyCachedDataSet");</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: green">// Get the DataSet from Cache</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;DataSet ds = (DataSet)Cache.Get("MyCachedDataSet"); <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">if</span> (ds == <span style="COLOR: blue">null</span>) <br />&nbsp;&nbsp;&nbsp;&nbsp;{ <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: green">// Get the DataSet and load it into Cache</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ds = RefreshDataSetFromDB(); <br />&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;CacheDataSet(ds); <br />&nbsp;&nbsp;&nbsp;&nbsp;} <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: blue">return</span> ds; <br />} <br /></span> </fieldset> <p><br /> I cache the DataSet using the Cache.Insert method. Here, I am creating a key called MyCachedDataSet so I can grab the DataSet back out of Cache using this key. SInce the data does not change often, I am telling the Cache to store this data for 1 hour from now. You can play with this setting or the sliding expiration argument to get your desired effect. The final parameter tells the Cache what method to call when the DataSet is removed from the Cache. Here, I tell it to call the CacheCallback handler. <br /> </p> <fieldset> <legend>CacheDataSet</legend> <span style="COLOR: black;font-size: 9pt;font-family:Arial;"><br /><span style="COLOR: blue">private</span> <span style="COLOR: blue">void</span> CacheDataSet(DataSet ds) <br />{ <br />&nbsp;&nbsp;&nbsp;&nbsp;Cache.Insert("MyCachedDataSet", ds, <span style="COLOR: blue">null</span>, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DateTime.Now.AddHours(1), Cache.NoSlidingExpiration, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CacheItemPriority.Normal, <span style="COLOR: blue">new</span> CacheItemRemovedCallback(CacheCallback)); <br />} <br /></span> </fieldset> <p><br /> The CacheCallBack handler will reload the data from the database, throw the DataSet back in Cache and the load the Orders dropdown list once again. </p> <fieldset> <legend>CacheCallback</legend> <span style="COLOR: black;font-size: 9pt;font-family:Arial;"><br /><span style="COLOR: blue">private</span> <span style="COLOR: blue">void</span> CacheCallback(<span style="COLOR: blue">string</span> str, <span style="COLOR: blue">object</span> obj, CacheItemRemovedReason reason) <br />{ <br />&nbsp;&nbsp;&nbsp;&nbsp;DataSet ds = RefreshDataSetFromDB(); <br />&nbsp;&nbsp;&nbsp;&nbsp;CacheDataSet(ds); <br />&nbsp;&nbsp;&nbsp;&nbsp;LoadOrdersList(ds); <br />} <br /></span> </fieldset> <p><br /> Here is how the Orders dropdown list is loaded (using data binding). </p> <fieldset> <legend>LoadOrdersList</legend> <span style="COLOR: black;font-size: 9pt;font-family:Arial;"><br /><span style="COLOR: blue">private</span> <span style="COLOR: blue">void</span> LoadOrdersList(DataSet ds) <br />{ <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: green">// Load the Orders</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;DataView dv = <span style="COLOR: blue">new</span> DataView(ds.Tables["Orders"]); <br />&nbsp;&nbsp;&nbsp;&nbsp;ddlOrders.DataSource = dv; <br />&nbsp;&nbsp;&nbsp;&nbsp;ddlOrders.DataTextField = "OrderID"; <br />&nbsp;&nbsp;&nbsp;&nbsp;ddlOrders.DataValueField = "OrderID"; <br />&nbsp;&nbsp;&nbsp;&nbsp;ddlOrders.DataBind(); <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: green">// Clear the Order Details grid</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;dgOrderDetails.DataSource = <span style="COLOR: blue">null</span>; <br />&nbsp;&nbsp;&nbsp;&nbsp;dgOrderDetails.DataBind(); <br />} <br /></span> </fieldset> <p><br /> When the Reload button is clicked, the DataSet is removed from cache and then reloaded from the database. Then the DataSet is stored in Cache and the Orders dropdown list is reloaded. </p> <fieldset> <legend>btnReload_Click</legend> <span style="COLOR: black;font-size: 9pt;font-family:Arial;"><br /><span style="COLOR: blue">private</span> <span style="COLOR: blue">void</span> btnReload_Click(<span style="COLOR: blue">object</span> sender, System.EventArgs e) <br />{ <br />&nbsp;&nbsp;&nbsp;&nbsp;Cache.Remove("MyCachedDataSet"); <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: green">// Get the DataSet and load it into Cache</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;DataSet ds = RefreshDataSetFromDB(); <br />&nbsp;&nbsp;&nbsp;&nbsp;CacheDataSet(ds); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoadOrdersList(ds); <br />} <br /></span> </fieldset> <p><br /> Now here is where the DataGrid is loaded. The btnGo_Click handler calls the LoadOrderDetailsGrid method, which will grab the Order Details rows that are direct children of the currently selected Order (selected in the droopdown list). </p> <fieldset> <legend>btnGo_Click</legend> <span style="COLOR: black;font-size: 9pt;font-family:Arial;"><br /><span style="COLOR: blue">private</span> <span style="COLOR: blue">void</span> btnGo_Click(<span style="COLOR: blue">object</span> sender, System.EventArgs e) <br />{ <br />&nbsp;&nbsp;&nbsp;&nbsp;LoadOrderDetailsGrid(); <br />} <br /></span> </fieldset> <p><br /> The method LoadOrderDetailsGrid loads the DataGrid with the approriate related child rows. To do this, it has to take the form of something that can be bound to a DataGrid. In thise case, the code creates a DataView using its overloaded method that accepts the DataTable, the filter criteria and the DataViewRowState. The key here is that the DataView will only contain the single row for the Order that has the selected OrderID. I could have used the Select method to pull out an array of DataRow object, but that does not bind directly to the grid. So instead, I create a DataRowView. The DataRowView is associated with the Orders DataTable's selected row. Next, the DataRowView's CreateChildView method uses the name of the DataRelation (OrdersToOrderDetails) to navigate from the selected Order row and down its children Order Details rows. This result can be bound to a DataGrid. </p> <fieldset> <legend>LoadOrderDetailsGrid</legend> <span style="COLOR: black;font-size: 9pt;font-family:Arial;"><br /><span style="COLOR: blue">private void</span> LoadOrderDetailsGrid() <br />{ <br />&nbsp;&nbsp;&nbsp;&nbsp;DataSet ds = GetDataSetFromCache(); <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR: green">// Load the children rows</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;DataView dv = <span style="COLOR: blue">new</span> DataView(ds.Tables["Orders"], "OrderID = " + ddlOrders.SelectedValue, "", DataViewRowState.CurrentRows); <br />&nbsp;&nbsp;&nbsp;&nbsp;DataRowView drv = dv[0]; <br />&nbsp;&nbsp;&nbsp;&nbsp;dgOrderDetails.DataSource = drv.<b> CreateChildView</b>("OrdersToOrderDetails"); <br />&nbsp;&nbsp;&nbsp;&nbsp;dgOrderDetails.DataBind(); <br />} <br /></span> </fieldset> <br /> This isn't the only way to solve the requirements, of course. But it does handle the caching, ADO.NET and the hierarchical requirements. <br /> 



</li></li></li></li></li></ol>

    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/ado-net-performance-test-getting-a-single-value.html">ADO.NET Performance Test&#58; Getting a Single Value</a>
  </h2>

  <div>
    
    
    <p>I ran some tests using ADO.NET to measure the time it takes to retrieve a single value from a database. All of my tests had the following attributes:</p>
<ul> <li>Each test gets the CompanyName for the specified CustomerID (in Northwind) <li>The same connection string, using integrated security <li>Stored procedure (vs inline SQL) <li>I used a SqlCommand with a parameter for the input value (and the output, for the output parameter test) <li>I ran the stored procedures ahead of time to remove the possibility of the first time performance hit <li>SqlConnection, SqlCommand and the SqlDataAdatper (where applicable) all used the <a href="/blogs/john.papa/archive/2005/04/01/60984.aspx">using statement</a> <li>I added the result to a list box in each test, just to show that we did something with the value <li>I ran the complete tests over 25,000 iterations, including destruction of all ADO.NET objects (and instantiation) </li> <p>The techniques that I tested were:</p> <ul> <li>ExecuteScalar&nbsp; <ul> <li>Retrieving the CompanyName from a stored procedure as the return value of the ExecuteScalar method</li></ul> <li>Output Parameters <ul> <li>Retrieving the CompanyName from an output parameter of a stored procedure </li></ul> <li>DataSet <ul> <li>Retrieving the CompanyName from the first row amd colun of a DataSet, as the result of a stored procedure </li></ul></li> <p>Here were the test results:</p>&lt;IMG alt="" src="/photos/jpapa/images/61747/original.aspx" border=0&gt; <p>So it turns out that ExecuteScalar test ran slightly faster than the output parameter test, and much faster than the DataSet test. In case the image comes ut fuzzy, here are the results again:</p> &lt;TABLE id=Table1 cellSpacing=2 cellPadding=2 align=center border=1&gt; <tbody> <tr> <th nowrap="">Test</th> <th nowrap="">Iteration</th> <th nowrap="">Elapsed ms <tr> <td nowrap="">ExecuteScalar</td> &lt;TD noWrap align=middle&gt;1 &lt;TD noWrap align=right&gt;6577</tr> <tr> <td nowrap="">ExecuteScalar</td> &lt;TD noWrap align=middle&gt;2 &lt;TD noWrap align=right&gt;6468</tr> <tr> <td nowrap="">ExecuteScalar</td> &lt;TD noWrap align=middle&gt;3 &lt;TD noWrap align=right&gt;6577</tr> <tr> <td nowrap="">Output Parameter</td> &lt;TD noWrap align=middle&gt;1 &lt;TD noWrap align=right&gt;6780</tr> <tr> <td nowrap="">Output Parameter</td> &lt;TD noWrap align=middle&gt;2 &lt;TD noWrap align=right&gt;6671</tr> <tr> <td nowrap="">Output Parameter</td> &lt;TD noWrap align=middle&gt;3 &lt;TD noWrap align=right&gt;6749</tr> <tr> <td nowrap="">DataSet</td> &lt;TD noWrap align=middle&gt;1 &lt;TD noWrap align=right&gt;10655</tr> <tr> <td nowrap="">DataSet</td> &lt;TD noWrap align=middle&gt;2 &lt;TD noWrap align=right&gt;10608</tr> <tr> <td nowrap="">DataSet</td> &lt;TD noWrap align=middle&gt;3 &lt;TD noWrap align=right&gt;10608</tr> <p>Given that ExecuteScalar is easier to implement that an output parameter, I'd choose that over output parameters. But it is interesting that ExecuteScalar and using output parameters are so close. I found it very interesting to see how slow the DataSet technique was. Kind of figured that it would be slower, but that was somewhat surprising (the DataSet is onyl returning a single row and column).</p> <p>In case you are wondering, I ran the tests again over iterations of </p> <ul> <li>1000 <li>10,000 <li>100,000 <li>250,000</li> <p>The results were very similar in each case. When I ran the tests for less than 1000, sometimes it ran so quick that the results were 0 ms. Not much help there ;-)</p> <p>Anyway, I thought it was interesting to see the results of how well or porrly these 3 methods performed. You might wonder why I did not try the DataReader ... well, I'll try that one and re-post later. </p> <fieldset style="LEFT: 10px; TOP: 1320px"><legend>The ExecuteScalar Test</legend><pre><span style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Arial"><span style="COLOR: blue">case</span> "ExecuteScalar" : dteTimer = DateTime.Now; <span style="COLOR: blue">for</span> (<span style="COLOR: blue">int</span> i = 1; i &lt;= iLimit; i++) { <span style="COLOR: blue">using</span> (SqlConnection cn = <span style="COLOR: blue">new</span> SqlConnection(sCn)) { <span style="COLOR: blue">string</span> proc = "prGetCustomerName"; cn.Open(); <span style="COLOR: blue">using</span> (SqlCommand cmd = <span style="COLOR: blue">new</span> SqlCommand(proc, cn)) { cmd.CommandType = CommandType.StoredProcedure; SqlParameter parmCustID = <span style="COLOR: blue">new</span> SqlParameter("@CustomerID", SqlDbType.NVarChar, 10); parmCustID.Direction = ParameterDirection.Input; parmCustID.Value = "FRANK"; cmd.Parameters.Add(parmCustID); sCompany = cmd.ExecuteScalar().ToString(); lstResults.Items.Add(i.ToString() + ") " + sCompany); } cn.Close(); } } dblPeriod = TimeSpan.FromTicks(DateTime.Now.Ticks - dteTimer.Ticks).TotalMilliseconds; lstElapsedTime.Items.Add("ExecuteScalar: " + dblPeriod.ToString() + " ms"); <span style="COLOR: blue">break</span>;</span></pre></fieldset>



</li></li></li></ul></th></tr></tbody></li></li></ul></li></li></li></li></li></li></li></ul>

    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    February
    1st,
    
    2008
  </span>

  <h2>
    <a href="/all/2008/02/01/ado-net-2-s-sqlconnectionstringbuilder.html">ADO.NET 2's SqlConnectionStringBuilder</a>
  </h2>

  <div>
    
    
    <p>The ADO.NET team is working on a building an object called&nbsp;SqlConnectionStringBuilder. The object&nbsp;is intended to assist in building connections string. Pretty basic concept and if you use config files to store your connection strings, you may not take advantage of it (but still could). But if you are writing code that concatenates strings into a connection string, you might want to check out <a href="http://blogs.msdn.com/dataaccess/archive/2005/03/30/403926.aspx">this blog</a>&nbsp;by Sushil&nbsp;Chordia from the ADO.NET team. pretty cool stuff!</p>
<p>The code would work like this:</p>
<fieldset><legend>SqlConnectionStringBuilder</legend><span class="myCode"><span class="myKeyword">public void </span>AccessData(<span class="myKeyword">string</span> serverName, <span class="myKeyword">string</span> uid, <span class="myKeyword">string</span> pwd) <br />{ <br />&nbsp;&nbsp;&nbsp;&nbsp;SqlConnectionStringBuilder sqlConStrBldr = <span class="myKeyword">new</span> SqlConnectionStringBuilder(); <br />&nbsp;&nbsp;&nbsp;&nbsp;sqlConStrBldr.DataSource = serverName; <br />&nbsp;&nbsp;&nbsp;&nbsp;sqlConStrBldr.UserID = uid; <br />&nbsp;&nbsp;&nbsp;&nbsp;sqlConStrBldr.Password = pwd; <br />&nbsp;&nbsp;&nbsp;&nbsp;SqlConnection cn = <span class="myKeyword">new</span> SqlConnection (sqlConStrBldr.ConnectionString); <br />&nbsp;&nbsp;&nbsp;&nbsp;cn.Open(); <br />&nbsp;&nbsp;&nbsp;&nbsp;... <br />&nbsp;&nbsp;&nbsp;&nbsp;... <br />&nbsp;&nbsp;&nbsp;&nbsp;... <br />&nbsp;&nbsp;&nbsp;&nbsp;cn.Close(); <br />} </span></fieldset>
<p>On a scale of 1 - 5, WOW! factor of&nbsp; 2. But still very useful. Sometimes simple is better!</p>
<p>&lt;P class=MsoNormal style=”MARGIN: 0in 0in 0pt”&gt; &lt;/P&gt;</p>


    
    
  </div>

</article>

<hr/>

<ul class="pager"> 

  
  <li class="previous">
    
    <a href="/page82">&larr; Newer</a>
    
  </li>
  
  
  <li>
    <span class="page_number">Page: 83 of 86</span>
  </li>

  
  <li class="next">
    <a href="/page84">Older &rarr;</a>
  </li>
  

</ul>





      <footer class="footer-text">
        <hr/>
        <p>
        Copyright © 2015 - John Papa Blog content licensed under the Creative Commons <a href="http://creativecommons.org/licenses/by/2.5/">CC BY 2.5</a>
        | Unless otherwise stated or granted, code samples licensed under the <a href="http://sm.mit-license.org/">MIT license</a>.
        | Site design based on the <a href="https://github.com/dbtek/dbyll">dbyll theme</a> under the <a href="http://sm.mit-license.org/">MIT license</a>
      </p>

      </footer>

    </div>

    <script type="text/javascript" src="/assets/resources/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="/assets/resources/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/assets/js/app.js"></script>

    <!--Developer Media Links-->
    <script type='text/javascript'>
        function _dmBootstrap(file) {
    var _dma = document.createElement('script'); _dma.type = 'text/javascript'; _dma.async = true; _dma.src = ('https:' == document.location.protocol ? 'https://' : 'http://')
    + file;
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(_dma);
    }
    function _dmFollowup(file) { if (typeof DMAds === 'undefined') _dmBootstrap('cdn2.DeveloperMedia.com/a.min.js');}
    (function () { _dmBootstrap('cdn1.DeveloperMedia.com/a.min.js');
    setTimeout(_dmFollowup, 2000);})();
    </script>

    <!--<script language="JavaScript" src="http://ad.doubleclick.net/N6839/adj/lqm.johnpapa.site/ron;kw=%2Cjohn%2Cpapa%2Cblog%2Cjohnpapa%7Bdot%7Dnet%2Cjohnpapa%2Cpappa%2Cwww%7Bdot%7Djohnpapa%7Bdot%7Dnet%2Cjon%2Cangular%2Cjhon;sz=160x600;dc_ref=http%3A%2F%2Fwww.johnpapa.net%2F;tile=1;ord=BEAAB484DA88D8D84B9DCB004E5712BE?"
    type="text/javascript"></script>-->

    <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="728x90" class="col-centered"></div>

</body>

</html>


<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl =
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'johnpapa']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

