<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>JohnPapa.net</title>
    
    <meta name="author" content="John Papa">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

    <!-- Le styles -->
    <link href="/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="/assets/resources/syntax/syntax.css" rel="stylesheet">
    <link href="/assets/css/style.css" rel="stylesheet">

    <link rel="shortcut icon" type="image/x-icon" href="assets/ico/favicon.ico">

    <!-- Le fav and touch icons -->
    <!-- Update these with your own images
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

    <link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">

</head>

<body>
    <nav class="navbar navbar-default visible-xs" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            
            <a type="button" class="navbar-toggle nav-link" href="http://github.com/johnpapa">
                <i class="fa fa-github"></i>
            </a>
            
            
            <a type="button" class="navbar-toggle nav-link" href="http://twitter.com/john_papa">
                <i class="fa fa-twitter"></i>
            </a>
            
            
            <a class="navbar-brand" href="/">
                <img src="http://www.gravatar.com/avatar/0d3794fe37746ea54926ca6878712721?s=35" class="img-circle" />
                
            </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li class="active"><a href="/">Home</a></li>
                <li><a href="/categories.html">Categories</a></li>
                <li><a href="/tags.html">Tags</a></li>
            </ul>
        </div><!-- /.navbar-collapse -->
    </nav>

    <!-- nav-menu-dropdown -->
    <div class="btn-group hidden-xs" id="nav-menu">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            <i class="fa fa-bars"></i>
        </button>
        <ul class="dropdown-menu" role="menu">
            <li><a href="/"><i class="fa fa-home"></i>Home</a></li>
            <li><a href="/categories.html"><i class="fa fa-folder"></i>Categories</a></li>
            <li><a href="/tags.html"><i class="fa fa-tags"></i>Tags</a></li>
            <li class="divider"></li>
            <li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
        </ul>
    </div>

    <div class="col-sm-4 sidebar hidden-xs hidden-sm not-mobile">
        <!-- sidebar.html -->
<header class="sidebar-header" role="banner">
	<h1 class="text-center">John Papa</h1>
	<a href="/">
		<img src="http://www.gravatar.com/avatar/0d3794fe37746ea54926ca6878712721?s=150" class="img-circle" />
	</a>
	<h3 class="title">
		<a href="/"></a>
	</h3>
</header>


<div id="bio" class="text-center">
	Evangelist on the Loose
</div>


<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/johnpapa">
				<i class="fa fa-github-alt fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://twitter.com/john_papa">
				<i class="fa fa-twitter fa-lg"></i>
			</a>
		</li>
		
		<li>
			<a class="btn btn-default btn-sm" href="/feed.xml">
				<i class="fa fa-rss fa-lg"></i>
			</a>
		</li>
	</ul>

	<div class="sidebar-content">

		<nav id="page-nav">
			<ul class="main-navigation list-unstyled list-inline">
				<li><a href="/about/">About</a></li>
				<li><a href="/articles">Articles</a></li>
				<li><a href="/spa">SPA</a></li>
				<li><a href="/videos">Videos</a></li>
			</ul>
		</nav>

		<h5>Recent Posts</h5>
		<ul class="list-unstyled">
			
				<li>
					<span>16 Sep 2015</span> &raquo;
					<a href="/angular/angular2/community/event/javascript/uncategorized/2015/09/16/angular-2-hack-night-coming-to-orlando.html">
					Angular 2 Hack Night Coming to Orlando</a>
				</li>
			
				<li>
					<span>29 Aug 2015</span> &raquo;
					<a href="/angular/asp.net/github/gulp/html5/javascript/pluralsight/typescript/uncategorized/visual%20studio%20code/2015/08/29/learning-visual-studio-code.html">
					Learning Visual Studio Code</a>
				</li>
			
				<li>
					<span>23 May 2015</span> &raquo;
					<a href="/uncategorized/2015/05/23/visual-studio-code-webinar.html">
					Visual Studio Code Webinar</a>
				</li>
			
				<li>
					<span>23 May 2015</span> &raquo;
					<a href="/uncategorized/2015/05/23/automatically-restarting-asp-net-on-osx-with-dnxmon.html">
					Automatically Restarting ASP.NET on OSX with DNXMON</a>
				</li>
			
				<li>
					<span>23 May 2015</span> &raquo;
					<a href="/uncategorized/2015/05/23/getting-started-with-asp-net-5-on-osx.html">
					Getting Started with ASP.NET 5 on OSX</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/refactoring-with-visual-studio-code.html">
					Refactoring with Visual Studio Code</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/intellisense-witha-visual-studio-code.html">
					Intellisense with Visual Studio Code</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/git-and-preferences-in-visual-studio-code.html">
					Git and Preferences in Visual Studio Code</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/debugging-with-visual-studio-code.html">
					Debugging with Visual Studio Code</a>
				</li>
			
				<li>
					<span>29 Apr 2015</span> &raquo;
					<a href="/uncategorized/2015/04/29/visual-studio-code.html">
					Introducing Visual Studio Code</a>
				</li>
			
		</ul>
	</div>

</div>
<!-- sidebar.html end -->
        <div class="not-mobile row sidebar-extras">
            <table class="col-centered">
                <tbody>
                    <tr>
                        <td>
                            <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="160x600"></div>
                        </td>
                        <td>
                            <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="160x600"></div>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="300x250"></div>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="300x250"></div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="col-sm-8">
        <div class="page-header">
  <h1>JohnPapa.net </h1>
</div>



<article class="home">

  <span class="post-date">
    
    December
    31st,
    
    2009
  </span>

  <h2>
    <a href="/silverlight/2009/12/31/saving-snapshots-to-png-in-silverlight-4-and-the-webcam.html">Saving Snapshots to PNG in Silverlight 4 and the WebCam</a>
  </h2>

  <div>
    
    
    <p>This week I decided to experiment with a few webcam features and put together an application that activates a webcam, allows the user to take snapshots, and save the snapshots to PNG files. I like when demos use MVVM out of the box instead of just throwing all of the code in a single code behind, so one of my goals was to make a passing effort to break the code out and use MVVM practices.</p>
<p>The first thing I did was grab <a href="http://silverlight.net/learn/videos/silverlight-4-beta-videos/access-web-camera-microphone/">Tim Heuer’s webcam sample</a> which already handles activating the webcam. Tim did a great job with this, so instead of reinventing the wheel for this demo I decided to start with his code and add my requirements. First I wanted to hit the UI, so I created a new project, and copied the UI from Tim then took out what I did not need and add what I did need. Of course I did all of this in Expression Blend. Cider is great, but I’m faster in Blend by far. The UI is very simple, so this was a minimal effort. Here is the basic UI:</p>
<p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/SavingSnapshotstoPNGinSilverlight4andthe_C0F2/image_8.png" width="410" height="541" /></p>
<blockquote>   <p><em>This sample application uses the .NET ImageTools library. You can grab the source or binaries for it on </em><a href="http://imagetools.codeplex.com/"><em>codeplex here</em></a><em>.</em></p> </blockquote>
<p><strong>Files</strong></p>
<p>There are only a few files in this project, as shown in the image below.</p>
<ul>   <li>MainPage.xaml      <ul>       <li>View </li>     </ul>   </li>    <li>MainPageViewModel      <ul>       <li>ViewModel </li>     </ul>   </li>    <li>DelegateCommand      <ul>       <li>Generic class to handle the commanding features </li>     </ul>   </li>    <li>ViewModelBase      <ul>       <li>Contains basic VM features, like INotifyPropertyChanged implementation </li>     </ul>   </li>    <li>BitmapExtensions      <ul>       <li>Contains some simplification code to save to PNG from a WriteableBitmap </li>        <li>This uses the ImageTools.dll from codeplex </li>     </ul>   </li> </ul>
<p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/SavingSnapshotstoPNGinSilverlight4andthe_C0F2/image_7.png" width="285" height="540" /></p>
<p><strong>ViewModel</strong></p>
<p>The demo uses a View named MainPage.xaml as shown in the above screen capture. The View is bound to an instance of a ViewModel named MainPageViewModel. The VM contains several properties that the View uses in its bnidings:</p>
<ul>   <li>ICommand StartCaptureCommand </li>    <li>ICommand StopCaptureCommand </li>    <li>ICommand TakeSnapshotCommand </li>    <li>ICommand SaveSnapshotCommand </li>    <li>ObservableCollection&lt;WriteableBitmap&gt; Images </li>    <li>VideoBrush VideoBrush </li>    <li>WriteableBitmap SelectedSnapshot </li> </ul>
<p>The commands handle the interaction with the capture process and saving to the PNG file. We’ll look at those closer in a moment. The Images collection contains a series of WriteableBitmap instances that are gathered from the capture process. When someone clicks the Take Snapshot button, the WriteableBitmap is retrieved from the capture stream and added to the Images collection.</p>
<p>The VideoBrush property exposes the video stream to the View, through bindings. I am not convinced this is the ideal way to go as I generally do not like to expose a brush from a VM since a brush is View specific. One alternative is to expose the stream in another fashion and use a converter (yuk). Or another option is to perform the video capture in the View. I don;t have a problem with this being done in the View, but I wanted to show how this could work with MVVM. In this case I feel it’s acceptable either way.</p>
<p>The SelectedSnapshot property represents the WriteableBitmap that the user selects in the UI. When the user clicks the Save Snapshot button, this property is checked and saved to a PNG file.</p>
<p><strong>CaptureSource</strong></p>
<p>The code to activate the webcam and begin capturing the video stream is straightforward. First I created a private property named CapSource in my ViewModel. The CapSource is set in the constructor of the VM, with the video device set to the default video capture device as shown below:</p>
<div id="codeSnippetWrapper">   <div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">     <pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum1">   1:</span> CapSource = <span style="color: #0000ff">new</span> CaptureSource</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum2">   2:</span> {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum3">   3:</span>     VideoCaptureDevice = CaptureDeviceConfiguration.GetDefaultVideoCaptureDevice()</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum4">   4:</span> };</pre>
<!--CRLF--></div>
</div>
<p><strong>Commanding</strong></p>
<p>I hooked a Command up to the “Start Capture” button using the new commanding features in Silverlight 4. The XAML to do this is very simple … you just bind to the Command which is in the ViewModel, in this case.</p>
<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">
<div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum1">   1:</span> <span style="color: #0000ff">&lt;</span><span style="color: #800000">StackPanel</span> <span style="color: #ff0000">Orientation</span><span style="color: #0000ff">=&quot;Horizontal&quot;</span> <span style="color: #ff0000">HorizontalAlignment</span><span style="color: #0000ff">=&quot;Center&quot;</span><span style="color: #0000ff">&gt;</span></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum2">   2:</span>     <span style="color: #0000ff">&lt;</span><span style="color: #800000">Button</span> <span style="color: #ff0000">Margin</span><span style="color: #0000ff">=&quot;5&quot;</span> <span style="color: #ff0000">Content</span><span style="color: #0000ff">=&quot;Start Capture&quot;</span> <span style="color: #ff0000">Height</span><span style="color: #0000ff">=&quot;25&quot;</span> <span style="color: #ff0000">Command</span><span style="color: #0000ff">=&quot;{Binding StartCaptureCommand}&quot;</span> <span style="color: #0000ff">/&gt;</span></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum3">   3:</span>     <span style="color: #0000ff">&lt;</span><span style="color: #800000">Button</span> <span style="color: #ff0000">Margin</span><span style="color: #0000ff">=&quot;5&quot;</span> <span style="color: #ff0000">Content</span><span style="color: #0000ff">=&quot;Stop Capture&quot;</span> <span style="color: #ff0000">Height</span><span style="color: #0000ff">=&quot;25&quot;</span> <span style="color: #ff0000">Command</span><span style="color: #0000ff">=&quot;{Binding StopCaptureCommand}&quot;</span> <span style="color: #0000ff">/&gt;</span></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum4">   4:</span>     <span style="color: #0000ff">&lt;</span><span style="color: #800000">Button</span> <span style="color: #ff0000">Margin</span><span style="color: #0000ff">=&quot;5&quot;</span> <span style="color: #ff0000">Content</span><span style="color: #0000ff">=&quot;Take Snapshot&quot;</span> <span style="color: #ff0000">Height</span><span style="color: #0000ff">=&quot;25&quot;</span> <span style="color: #ff0000">Command</span><span style="color: #0000ff">=&quot;{Binding TakeSnapshotCommand}&quot;</span> <span style="color: #0000ff">/&gt;</span></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum5">   5:</span>     <span style="color: #0000ff">&lt;</span><span style="color: #800000">Button</span> <span style="color: #ff0000">Margin</span><span style="color: #0000ff">=&quot;5&quot;</span> <span style="color: #ff0000">Content</span><span style="color: #0000ff">=&quot;Save Snapshot&quot;</span> <span style="color: #ff0000">Height</span><span style="color: #0000ff">=&quot;25&quot;</span> <span style="color: #ff0000">Command</span><span style="color: #0000ff">=&quot;{Binding SaveSnapshotCommand}&quot;</span><span style="color: #0000ff">/&gt;</span></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum6">   6:</span> <span style="color: #0000ff">&lt;/</span><span style="color: #800000">StackPanel</span><span style="color: #0000ff">&gt;</span></pre>
<!--CRLF--></div>
</div>
<p>The commands are set up in the constructor of the VM. I assigned each of the commands an action (for performing the action when the button is clicked) and a function (for determining if the button should be enabled or not). In Silverlight 4 we have the ICommand interface and now the new binding properties: Command and CommandProperty. We still need a commanding implementation. You can write one for each command (yuk), create some sort of command manager, or use an implementation of the DelegateCommand class. I chose the latter in this case because it is simple and still abstracts the boring parts of the commands for reuse. (You can check out the DelegateCommand class in the source code for this sample project.)</p>
<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">
<div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum1">   1:</span> StartCaptureCommand = <span style="color: #0000ff">new</span> DelegateCommand(StartCapture, CanStartCapture);</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum2">   2:</span> StopCaptureCommand = <span style="color: #0000ff">new</span> DelegateCommand(StopCapture, CanStopCapture);</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum3">   3:</span> TakeSnapshotCommand = <span style="color: #0000ff">new</span> DelegateCommand(TakeSnapshot, CanTakeSnapshot);</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum4">   4:</span> SaveSnapshotCommand = <span style="color: #0000ff">new</span> DelegateCommand(SaveSnapshot, CanSaveSnapshot);</pre>
<!--CRLF--></div>
</div>
<p><strong>Capture Video</strong></p>
<p>When the user clicks the button, the command fires in the VM. The StartCapture method checks the state of the capture and stops it if it is already in process. Then the VideoBrush is set to the capture source.</p>
<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">
<div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum1">   1:</span> <span style="color: #0000ff">private</span> <span style="color: #0000ff">void</span> StartCapture(<span style="color: #0000ff">object</span> obj)</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum2">   2:</span> {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum3">   3:</span>     <span style="color: #0000ff">if</span> (CapSource != <span style="color: #0000ff">null</span>)</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum4">   4:</span>     {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum5">   5:</span>         <span style="color: #0000ff">if</span> (CapSource.State != CaptureState.Stopped)</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum6">   6:</span>         {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum7">   7:</span>             CapSource.Stop(); <span style="color: #008000">// stop whatever device may be capturing</span></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum8">   8:</span>         }</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum9">   9:</span>&#160; </pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum10">  10:</span>         <span style="color: #008000">// create the brush</span></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum11">  11:</span>         VideoBrush.SetSource(CapSource);</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum12">  12:</span>&#160; </pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum13">  13:</span>         <span style="color: #008000">// request user permission and display the capture</span></pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum14">  14:</span>         <span style="color: #0000ff">if</span> (CaptureDeviceConfiguration.AllowedDeviceAccess || CaptureDeviceConfiguration.RequestDeviceAccess())</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum15">  15:</span>         {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum16">  16:</span>             CapSource.Start();</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum17">  17:</span>         }</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum18">  18:</span>     }</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum19">  19:</span>     RefreshCommandStates();</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum20">  20:</span> }</pre>
<!--CRLF--></div>
</div>
<p>The “if” statement checks if the user has already allowed access to the device by checking CaptureDeviceConfiguration.AllowedDeviceAccess. If not, the user will be prompted to allow access to the camera and microphone using the CaptureDeviceConfiguration.RequestDeviceAccess method (see below). Then the capture process is started.</p>
<p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/SavingSnapshotstoPNGinSilverlight4andthe_C0F2/image_11.png" width="568" height="221" /></p>
<p>Finally, the RefreshCommandStates method is fired, which indirectly (through INPC events and bindings) enables or disables the buttons appropriately.</p>
<p><strong>Take a Snapshot from the Video</strong></p>
<p>When the capture process has started and a user clicks the Take Snapshot button, the appropriate command is invoked in the VM and the capture source’s AsyncCaptureImage method is invoked. I used the Dispatcher to make sure I operated on the UI thread because I wanted to not only grab the bitmap but I also want to update the View’s state. Again, not sure I like this in a VM, but I’ll take some liberties here and apply the ForemostItHasToWork pattern.</p>
<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">
<div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum1">   1:</span> <span style="color: #0000ff">private</span> <span style="color: #0000ff">void</span> TakeSnapshot(<span style="color: #0000ff">object</span> obj)</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum2">   2:</span> {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum3">   3:</span>     <span style="color: #0000ff">if</span> (CapSource != <span style="color: #0000ff">null</span> &amp;&amp; CapSource.State == CaptureState.Started)</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum4">   4:</span>     {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum5">   5:</span>         CapSource.AsyncCaptureImage((bitmap) =&gt;</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum6">   6:</span>             {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum7">   7:</span>                 App.Current.Resources.Dispatcher.BeginInvoke(() =&gt;</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum8">   8:</span>                 {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum9">   9:</span>                     Images.Add(bitmap);</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum10">  10:</span>                     SelectedSnapshot = bitmap;</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum11">  11:</span>                     RefreshCommandStates();</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum12">  12:</span>                 });</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum13">  13:</span>             });</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum14">  14:</span>     }</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum15">  15:</span> }</pre>
<!--CRLF--></div>
</div>
<p>&#160;<img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/SavingSnapshotstoPNGinSilverlight4andthe_C0F2/image_17.png" width="542" height="682" /></p>
<p><strong>Save to PNG</strong></p>
<p>Once the user has selected an image in the list, the Save Snapshot button is enabled. When the user clicks this button the SaveSnapshotCommand in the VM retrieves the WriteableBitmap from the SelectedSnapshot&#160; property (which is bound to the SelectedItem of the ListBox). Then an extension method I created on the WriteableBitmap saves the snapshot to a PNG file.</p>
<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">
<div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum1">   1:</span> <span style="color: #0000ff">private</span> <span style="color: #0000ff">void</span> SaveSnapshot(<span style="color: #0000ff">object</span> obj)</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum2">   2:</span> {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum3">   3:</span>     var bitmap = SelectedSnapshot;</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum4">   4:</span>     <span style="color: #0000ff">if</span> (bitmap != <span style="color: #0000ff">null</span>)</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum5">   5:</span>     {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum6">   6:</span>         bitmap.SaveToPNG();</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum7">   7:</span>     }</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum8">   8:</span>     RefreshCommandStates();</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum9">   9:</span> }</pre>
<!--CRLF--></div>
</div>
<p>This prompts the user for the file name and saves the png.</p>
<p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/SavingSnapshotstoPNGinSilverlight4andthe_C0F2/image_16.png" width="500" height="387" /></p>
<p><strong>A Word About PNG Conversion</strong></p>
<p>Once you have a WriteableBitmap (or an image for that matter) you can convert it to a PNG file. To do this it makes sense to use one of the existing libraries of conversion tools. One such tool was written by Joe Stegman and <a href="http://blogs.msdn.com/jstegman/archive/2008/04/21/dynamic-image-generation-in-silverlight.aspx">can be found here</a>. Joe’s PNG converter is straightforward and simply requires that you add 2 classes to your project. Another option is to use one of the tools on codeplex. A popular choice seems to be the <a href="http://imagetools.codeplex.com/">.NET ImageTools library</a> (thanks to several people on Twitter for alerting me to this). This library can be referenced and used pretty easily. It does more than just conversion to a PNG, but it handles what I need with relative ease. For all it does, I could not find a simple method that accepted a WriteableBitmap and outputted a PNG (or any file format). So I quickly wrote up quick extension method&#160; that handles this for me. Since this was my first glance at this open source API, it is likely that there is an easier/better way to convert from a WriteableBitmap to a PNG using ImageTools, so if you find one please leave a comment and I will update the code. It does the job nicely though and handles compression of the PNG.</p>
<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; max-height: 200px; font-size: 8pt; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">
<div style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px" id="codeSnippet">
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum1">   1:</span> <span style="color: #0000ff">public</span> <span style="color: #0000ff">static</span> <span style="color: #0000ff">void</span> SaveToPNG(<span style="color: #0000ff">this</span> WriteableBitmap bitmap)</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum2">   2:</span> {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum3">   3:</span>     <span style="color: #0000ff">if</span> (bitmap != <span style="color: #0000ff">null</span>)</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum4">   4:</span>     {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum5">   5:</span>         SaveFileDialog sfd = <span style="color: #0000ff">new</span> SaveFileDialog</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum6">   6:</span>                  {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum7">   7:</span>                  Filter = <span style="color: #006080">&quot;PNG Files (*.png)|*.png|All Files (*.*)|*.*&quot;</span>,</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum8">   8:</span>                  DefaultExt = <span style="color: #006080">&quot;.png&quot;</span>,</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum9">   9:</span>                  FilterIndex = 1</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum10">  10:</span>                  };</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum11">  11:</span>&#160; </pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum12">  12:</span>         <span style="color: #0000ff">if</span> ((<span style="color: #0000ff">bool</span>)sfd.ShowDialog())</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum13">  13:</span>         {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum14">  14:</span>             var img = bitmap.ToImage();</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum15">  15:</span>             var encoder = <span style="color: #0000ff">new</span> PngEncoder();</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum16">  16:</span>             <span style="color: #0000ff">using</span> (Stream stream = sfd.OpenFile())</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum17">  17:</span>             {</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum18">  18:</span>                 encoder.Encode(img, stream);</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum19">  19:</span>                 stream.Close();</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum20">  20:</span>             }</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum21">  21:</span>         }</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: #f4f4f4; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum22">  22:</span>     }</pre>
<!--CRLF-->
<pre style="border-bottom-style: none; text-align: left; padding-bottom: 0px; line-height: 12pt; border-right-style: none; background-color: white; margin: 0em; padding-left: 0px; width: 100%; padding-right: 0px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; border-top-style: none; color: black; font-size: 8pt; border-left-style: none; overflow: visible; padding-top: 0px"><span style="color: #606060" id="lnum23">  23:</span> }</pre>
<!--CRLF--></div>
</div>
<p><strong>From Here</strong></p>
<p>The webcam and microphone features in Silverlight 4 are fun to work with and can be useful to grab images and save them (or email them, or stream them, etc). I had a good time putting this together and learned about the PNG conversion options along the way.</p>
<p>You can <a href="/wp-content/uploads/files/downloads/Papa-WebCamSnapshots.zip">download the source code here</a> for the entire sample application. Enjoy!</p>
<p><strong><font color="#ff0000">UPDATE (Jan 03,2010)</font></strong>: <a href="http://blog.galasoft.ch/">Laurent Bugnion</a> alerted me that there indeed is a ToImage method in the ImageTools library. The trick is to make sure you download the right link from the ImageTools codeplex site. The first link just gives you the basics, the second link gives you all the dll’s. Once I downloaded that second link I was able to add references to a few assemblies in the ImageTools library that cleaned out some of my code for my extension method. The net result is that my extension method is considerably shorter and clearer. I just updated the extension method in the above code window and in the downloadable code. Feel free to grab the latest and run with it!</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    December
    17th,
    
    2009
  </span>

  <h2>
    <a href="/silverlight/uncategorized/2009/12/17/silverlight-4-html-puzzle-how-does-it-work.html">Silverlight 4 HTML Puzzle&#58; How Does It Work?</a>
  </h2>

  <div>
    
    
    <p><a href="http://weblogs.asp.net/scottgu/archive/2009/12/16/silverlight-4-demos-from-my-pdc-keynote-now-available.aspx">Scott Guthrie just announced on his blog</a> that many of <a href="http://www.silverlight.net/community/samples/silverlight-4-beta/">the demos that he presented during the PDC keynote are now available online</a>. Both the demos and their source code are now online and available for you to download. Be sure to go grab the code and check them out! </p>
<blockquote>   <p><em>Learn More: </em>If you are interested in learning more about the features in Silverlight 4 beta, grab the <a href="http://ecn.channel9.msdn.com/o9/learn/Silverlight4/Labs/Overview/WhatsNewInSilverlight4.docx">Silverlight 4 Technical Whitepaper here</a>. You can also walk through some hands on labs and other learning materials from both:</p>    <ul>     <li><a href="http://channel9.msdn.com/learn/courses/Silverlight4/">Channel 9’s Silverlight 4 Training</a></li>      <li><a href="http://silverlight.net/learn/">Silverlight.net’s Silverlight 4 beta learning section</a>&#160;&#160; </li>   </ul> </blockquote>
<p>I decided to break down the project for the HTML Hosting &amp; Puzzle application for those who are interested in how it works.</p>
<p><img src="http://weblogs.asp.net/blogs/scottgu/image_734F75FE.png" width="519" height="291" /></p>
<p><u><strong>What does it do?</strong></u></p>
<p>This project demonstrates many features, including these features:</p>
<ul>   <li>Multi-Touch gestures</li>    <li>WebBrowser control</li>    <li>HTML Brush</li> </ul>
<blockquote>   <p>The HTML Hosting &amp; Puzzle application shows off using the new Silverlight 4 WebBrowser control in an out of browser application (note: you must run the application out of the browser for it to work).&#160; It allows you to use the control both interactively (meaning you can click the HTML within it and run it like an application).&#160; It also allows you to use the hosted HTML as a brush that you can apply to other Silverlight controls. For fun you can click the second tab and you’ll get <a href="http://en.wikipedia.org/wiki/Rickrolling">rick-rolled</a> to YouTube.&#160; You can still use the HTML as a brush and carve it up into a jigsaw – even though the video is still playing (using<a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_2.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; margin-left: 0px; border-top: 0px; margin-right: 0px; border-right: 0px" title="image" border="0" alt="image" align="right" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb.png" width="181" height="291" /></a> Flash hosted within the HTML). Also, if you have a multi-touch device, you can use your fingers to drag and rotate puzzle pieces.</p> </blockquote>
<p><u><strong>The Solution Explorer</strong></u></p>
<p>The project is named SLMTPuzzle (Silverlight Multi-Touch Puzzle) and contains a set of images, a generic.xaml for some custom controls, and a series of Views and code files for the puzzle logic. </p>
<p><u><strong>Vector.cs</strong></u></p>
<p>The Vector struct is used in presenting the motion for the puzzle pieces.</p>
<p><u><strong>TouchProcessor.cs</strong></u></p>
<p>This contains a helper class, TouchProcessor, and several other helper classes that capture and process touch events. This is not required for multi-touch, but make sit easier to process the events.</p>
<p><u><strong>PuzzleDesigner.xaml</strong></u></p>
<p>This control is actually not used in the project and can be excluded from it. I used this control simply as a design surface to create the puzzle pieces and make it obvious what shapes I needed. Notice that there are 9 shapes for the puzzle pieces. With these 9 shapes a puzzle of various larger sizes can be created. For example, in a puzzle that is 6 across the top and 3 tall (18 pieces in total), the top center piece would be used 4 times as would the middle and bottom center pieces.</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_6.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_2.png" width="244" height="202" /></a> </p>
<p>Drawing the puzzle pieces was quite simple using Expression Blend. I put the basic steps to create the “Top left” and “Top center” puzzle pieces here:</p>
<p>1. Make the container object a Canvas (Grid panels can resize and stretch, which we do not want in this case)</p>
<p>2. Create a rectangle of the width and height you desire. Set the fill color to yellow.</p>
<p>3. Add a circle using the ellipse tool. You can make it a circle by holding the SHIFT key down while sizing the ellipse. Set the fill color to green. (Note the size of the circle, we’ll be using this again later)</p>
<p>4. Copy and paste the circle shape to make a duplicate. Set this circle’s Fill color to red. (The colors are simply for demonstration purposes.)</p>
<p>5. Place the red circle on the right side of the rectangle and the green circle on the bottom of the rectangle. Make exactly about a 3rd of the circles overlap the rectangle. Your control should look something like this:</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_12.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_5.png" width="244" height="179" /></a>&#160;</p>
<p>6. Select the 3 shapes.</p>
<p>7. Right click the selection and choose from the menu Combine | Unite. The shapes are now combined into a single path as shown below. The circles became the nubs for the puzzle piece.</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_14.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_6.png" width="244" height="188" /></a> </p>
<p>8. This puzzle piece could now work as the top left piece. Now that it is created, let’s create the top middle piece, so copy the entire piece and paste it to create a duplicate. Set the Fill of the new piece to Blue.</p>
<p>9. Align the 2 pieces as shown below.</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_18.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_8.png" width="244" height="94" /></a> </p>
<p>10. Set the canvas’ background to white. This will make it easier to see if the puzzle pieces align properly.</p>
<p>11. Create another circle with the same exact size as the puzzle nub you created in step 3. Set its fill color to Red.</p>
<p>12. Position the red circle directly over the right nub of the yellow puzzle piece.</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_20.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_9.png" width="244" height="95" /></a> </p>
<p>13. Position the blue puzzle piece adjacent to the yellow puzzle piece.</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_22.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_10.png" width="244" height="102" /></a> </p>
<p>14. Now it is time to carve a shape out the blue puzzle piece so the yellow puzzle piece can fit it. select the red circle and the blue puzzle piece.</p>
<p>15. Right click and from the menu choose Combine | Subtract. This subtracts the red circle from the blue path. The results should look as follows:</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_24.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_11.png" width="244" height="104" /></a> </p>
<p>16. Notice the puzzle pieces fit together and can be pulled apart as shown below.</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_26.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_12.png" width="244" height="94" /></a> </p>
<p>This process can be repeated to create various shapes of puzzle pieces. Of course, you can get much more creative in creating puzzle pieces, but this is a simple way to get started. The paths for these shapes can then be used as the basis for the puzzle pieces.</p>
<p><strong><u>HtmlPuzzlePiece.cs</u></strong></p>
<p>The puzzle pieces themselves are represented by the HtmlPuzzlePiece custom control. This custom control contains all of the logic necessary to handle the events and motion for each puzzle piece. Each puzzle will contain many instances of this control, using various paths to shape the puzzle pieces.</p>
<p><strong><u>HtmlPuzzle.cs</u></strong></p>
<p>The puzzle is represented by the custom control HtmlPuzzle, which handles various events and actions such as:</p>
<ul>   <li>Navigating to a web address to display the HTML content in the WebBrowser control</li>    <li>Redrawing the HTML content using the HtmlBrush in the puzzle pieces</li>    <li>Setting the redraw rate to 60x per second</li>    <li>Toggle the state between the WebBrowser control (interactive HTML) and the HtmlBrush mode (for video)</li>    <li>Scramble the puzzle pieces</li>    <li>Solve the entire puzzle</li>    <li>Solve one piece of the puzzle (hint)</li> </ul>
<p>As you can see, the HtmlPuzzle custom control is where the bulk of the interaction is handled. </p>
<p><strong><u>MainPage.xaml</u></strong></p>
<p>This is the main user control that loads the WebBrowser control or the puzzle (through the HtmlPuzzle control). It has a button which toggles the state for the HtmlPuzzle control between the WebBrowser control (the Browse button) and the puzzle ( the Puzzlify button). </p>
<p>“Browse” mode</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_32.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_15.png" width="244" height="152" /></a> </p>
<p>“Puzzle” mode</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_30.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_14.png" width="244" height="152" /></a> </p>
<p><strong><u>InstallView.xaml</u></strong></p>
<p>The InstallView control is shown when the application is run inside of the browser. If the application is not installed out-of-browser the InstallView control will allow the user to install the application by clicking a button, as shown below:</p>
<p><a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_34.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/7ab6229b7fb2_14B28/image_thumb_16.png" width="244" height="185" /></a> </p>
<p>If the application is installed out-of-browser already, the InstallView control will alert the user and disable the Install button. Again, the InstallView control is only displayed when running in browser.</p>
<p><strong><u>Auto-Updates</u></strong></p>
<p>The application automatically checks for updates and, if found, retrieves the update and alerts the user to close and re-open the application to get the update. The code is quite simple to do this … simply handle the App.Current object’s CheckAndDownloadUpdateCompleted event, check for the update, and in the event handler alert the user (see the code below).</p>

<pre class="prettyprint linenums">
public MainPage()
{
    InitializeComponent();

    int refreshInterval = 33; // ms
    _timer = new DispatcherTimer() { Interval = TimeSpan.FromMilliseconds(refreshInterval) };
    _timer.Tick += new EventHandler(timer_Tick);

    this.Loaded += new RoutedEventHandler(MainPage_Loaded);
    App.Current.CheckAndDownloadUpdateCompleted += CheckAndDownloadUpdateCompleted;
    App.Current.CheckAndDownloadUpdateAsync();
}

private void CheckAndDownloadUpdateCompleted(object sender, CheckAndDownloadUpdateCompletedEventArgs e)
{
    if (App.Current.IsRunningOutOfBrowser &amp;&amp; e.UpdateAvailable)
    {
        MessageBox.Show(
            "A new update is available for the Multi-Touch Puzzle. Please close the application and restart it to install the latest update.",
            "Multi-Touch Puzzle Update Available",
            MessageBoxButton.OK);
    }
}
</pre>

<p><strong><u>Wrap-Up</u></strong></p>
<p>That’s the application from a high level. The logic to rotate the pieces, give accelerate and decelerate them when moved, and to scramble &amp; solve them is a little more involved. But the code is here so you can dive in and follow along to understand these aspects. If you have any questions please drop me a comment or an email. Once again <a href="http://www.silverlight.net/community/samples/silverlight-4-beta/HTML-Puzzle/">you can download the entire sample from here</a>. </p>
<p><em>NOTE: This application requires Silverlight 4 Beta</em></p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    December
    1st,
    
    2009
  </span>

  <h2>
    <a href="/silverlight/2009/12/01/silverlight-team-twitter-list.html">Silverlight Team Twitter List</a>
  </h2>

  <div>
    
    
    <p>Last week <a href="/silverlight/silverlight-mvp-list-on-twitter/">I wrote about the new Silverlight MVP Twitter list I created</a> to make it easier to follow all of the Silverlight MVPs and the evangelists. You can follow the entire group using this link: <a href="http://www.twitter.com/john_papa/SilverlightMVP">www.twitter.com/john_papa/SilverlightMVP</a>&#160; </p>
<p>I also <a href="http://twitter.com/John_Papa/msftsilverlight">created a Twitter list containing several of the Microsoft Silverlight product team</a>. This list includes members of the Silverlight product team, RIA Services, evangelists, MEF, and other Silverlight “must follows” at Microsoft who are involved in Silverlight. The list is still growing!</p>
<p>So please follow this list and check back as I will be adding more as I gather them.</p>
<p><a title="http://twitter.com/John_Papa/msftsilverlight" href="http://twitter.com/John_Papa/msftsilverlight">http://twitter.com/John_Papa/msftsilverlight</a></p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    November
    29th,
    
    2009
  </span>

  <h2>
    <a href="/silverlight/2009/11/29/free-silverlight-4-event-in-tampa-ndash-monday-dec-7th-6-15pm.html">Free Silverlight 4 Event in Tampa – Monday Dec 7th @ 6:15pm</a>
  </h2>

  <div>
    
    
    <p>Florida has a fantastic developer community with some great people who are a just a blast to share technology with. That’s why I am thrilled to announce that I am heading to Tampa on Dec 7th where I will be presenting “What’s New in Silverlight 4 Beta” at a special <strong><font color="#ff0000">FREE </font></strong>event in Tampa, FL on Monday Dec 7th at 6:15pm. The event will be held in the Hyde Park room in the <a href="http://thewestshorehotel.com/directions.php">West Shore Hotel</a> at <a href="http://www.bing.com/maps/default.aspx?q=1200+North+Westshore+Blvd%2c+Tampa%2c+Florida+33607&amp;mkt=en-US&amp;FORM=BYFD" target="_blank">1200 North Westshore Blvd, Tampa, Florida 33607</a>.</p>
<blockquote>   <p>Special thanks to <a href="http://new.efficientcoder.net/2009/11/john-papas-silverlight-4-florida.html">Software Logistics</a> and <a href="http://new.efficientcoder.net/">Kevin Wolf</a> for sponsoring this event and securing a location for us for the evening. </p> </blockquote>
<p>You can find details on the new features in my <a href="/silverlight/what-rsquo-s-new-in-silverlight-4/">Silverlight 4 Beta Technical Overview whitepaper</a> which is available in both HTML online format and a downloadable file. Check out the links to these <a href="/silverlight/what-rsquo-s-new-in-silverlight-4/">here</a>. After we are done demoing the new features in Silverlight 4 beta we will be heading over to Champions Sports Bar at the Marriott across the street for some food, drinks and great conversation.</p>
<p>So please, <a href=" http://www.eventbrite.com/event/501691573">RSVP for the event using this link</a> so we secure the appropriate sized room, bring your questions, and please join us afterwards for food and fun!</p>
<p><a href="http://www.bing.com/maps/default.aspx?q=1200+North+Westshore+Blvd%2c+Tampa%2c+Florida+33607&amp;mkt=en-US&amp;FORM=BYFD" target="_blank"><img style="border-bottom: 0px; border-left: 0px; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh3.ggpht.com/__VkvHixrqgM/SxJlBxYROUI/AAAAAAAAARQ/XDN-R_xkuyY/image_thumb%5B1%5D.png?imgmax=800" width="420" height="336" /></a></p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    November
    28th,
    
    2009
  </span>

  <h2>
    <a href="/silverlight/2009/11/28/silverlight-4-sum-is-greater-than-the-parts.html">Silverlight 4&#58; Sum is Greater than the Parts</a>
  </h2>

  <div>
    
    
    <p><img style="border-bottom: 0px; border-left: 0px; margin: 10px 10px 10px 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" align="left" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/Silverlight4SumisGreaterthantheParts_D53A/image_3.png" width="203" height="173" /> Now that Silverlight 4 beta has been released there are tons of people trying the new bits, starting to develop applications, and blogging some great samples and ideas. You can check out all of the features from the <a href="http://channel9.msdn.com/learn/courses/Silverlight4/Overview/Overview/Default.aspx?wa=wsignin1.0">Silverlight 4 beta Technical Whitepaper I wrote in HTML format here</a> or <a href="http://ecn.channel9.msdn.com/o9/learn/Silverlight4/Labs/Overview/WhatsNewInSilverlight4.docx">download the whitepaper form this link</a>, for offline reading.</p>
<p>Some of the features are fairly obvious crowd favorites such as the printing API, but my favorite feature is in fact a series of features that make up the Trusted Application support with Out-of-Browser applications. Unlike previous releases, there is no single feature that grabs me and if you look at each feature by themselves they do not seem nearly as compelling as they do as a set. So many of the features can add a ton of value in creating applications. Individually they are great features but when you combine them, you get a huge value add.</p>
<p>For example, the Out-of-Browser features allow you to operate at a lower level out of the browser. Sounds good, as you consider you can use the WebBrowser control to display HTML. OK, pretty cool. You can use an HtmlBrush to take that WebBrowser control as a source and display the HTML content using various elements, transforms, and effects. Yeah, now we’re talking!</p>
<p>Then we look at the Trusted Application features that we can use including accessing the file system. We can read files from the file system and plays audio, video, or even load HTML content from the file system into the WebBrowser control. What about interacting with Office? Sure, now we can use native integration and invoke COM Automation to start up and control an instance of Outlook or crank open a new instance of IE. What if we want to interact with local applications? Well, if they have a COM interface (or one can be created) its entirely possible. </p>
<p>My point is that the features themselves are great, but as a whole they are truly powerful. Recently I created a music and video player that runs OoB, similar to the one Joe Stegman created and demo’d at PDC. The application reads the local file system for media, interacts with COM to talk to save playlists to Excel, emails favorites to friends, allows drag and drop of media files onto the player, and more. i was even thinking of pulling RSS feeds and display the HTML content into the player form my favorite artists and their sites.</p>
<p>it is an exciting time to be a Silverlight developer. There is a lot going on and the demand for Silverlight applications are on the rise (based on my recent experience as a consultant in this space). </p>
<p><strong>I’d love to hear what types of applications you are creating with Silverlight 4. What are your favorite features? What creative ideas are you generating? Please leave your comments and share!</strong></p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    November
    26th,
    
    2009
  </span>

  <h2>
    <a href="/silverlight/2009/11/26/silverlight-mvp-list-on-twitter.html">Silverlight MVP List on Twitter</a>
  </h2>

  <div>
    
    
    <p>The Silverlight MVP community is notorious at sharing information through blogs and Twitter. I created a new Silverlight MVP Twitter list to make it easier to follow all of the Silverlight MVPs and the evangelists. You can follow the entire group using this link: <a href="http://www.twitter.com/john_papa/SilverlightMVP">www.twitter.com/john_papa/SilverlightMVP</a>&#160; </p>
<p>&#160;</p>
<p>Or you can follow the individual Silverlight MVPs using the links below. As new ones get added i will update the list. I’m tracking down the final few MVPs, so the list will be complete, too.</p>
<p>&#160;</p>
<p><strong>Silverlight MVPs</strong></p>
<ul>   <li><a href="http://www.twitter.com/eric_ambrosi">@Eric_Ambrosi</a> – Eric Ambrosi </li>    <li><a href="http://www.twitter.com/rickbarraza">@RickBarraza</a> – Rick Barraza </li>    <li><a href="http://www.twitter.com/andybeaulieu">@AndyBeaulieu</a> – Andy Beaulieu </li>    <li><a href="http://www.twitter.com/aboschin">@ABoschin</a> – Andrea Boschin </li>    <li><a href="http://www.twitter.com/pbrooks">@PBrooks</a> – Page Brooks </li>    <li><a href="http://www.twitter.com/lbugnion">@LBugnion</a> – Laurent Bugnion </li>    <li><a href="http://www.twitter.com/chadcampbell">@ChadCampbell</a> – Chad Campbell </li>    <li><a href="http://www.twitter.com/wynapse">@WynApse</a> – Dave Campbell </li>    <li><a href="http://www.twitter.com/costall">@Costall</a> – Richard Costall </li>    <li><a href="http://www.twitter.com/laurentduveau">@LaurentDuveau</a> – Laurent Duveau </li>    <li><a href="http://www.twitter.com/eisenbergeffect">@EisenbergEffect</a> – Rob Eisenberg </li>    <li><a href="http://www.twitter.com/josefajardo">@JoseFajardo</a> – Joes Fajardo </li>    <li><a href="http://www.twitter.com/follesoe">@Follesoe</a> – Jonas Folleso </li>    <li><a href="http://www.twitter.com/devcorner">@DevCorner</a> – Alex Golesh </li>    <li><a href="http://www.twitter.com/ingebretsen">@Ingebretsen</a> – Robby Ingebretsen </li>    <li><a href="http://www.twitter.com/einari">@EinarI</a> – Einar Ingebrigtsen </li>    <li><a href="http://www.twitter.com/davidjkelley">@DavidJKelley</a> – David Kelley </li>    <li><a href="http://www.twitter.com/bryantlikes">@BryantLikes</a> – Bryant Likes </li>    <li><a href="http://www.twitter.com/ambroselittle">@AmbroseLittle</a> – J. Ambrose Little </li>    <li><a href="http://www.twitter.com/erik_mork">@Erik_Mork</a> – Erik Mork </li>    <li><a href="http://www.twitter.com/jneubeck">@JNeubeck</a> – Joel Neubeck </li>    <li><a href="http://www.twitter.com/vikrampendse">@VikramPendse</a> – Vikram Pendse </li>    <li><a href="http://www.twitter.com/jprosise">@jprosise</a> – Jeff Prosise</li>    <li><a href="http://www.twitter.com/billreiss">@BillReiss</a> – Bill Reiss </li>    <li><a href="http://www.twitter.com/waltritscher">@WaltRitscher</a> – Walt Ritscher </li>    <li><a href="http://www.twitter.com/cschuman">@CSchuman</a> – Corey Schuman </li>    <li><a href="http://www.twitter.com/johnnystock">@JohnnyStock</a> – John Stockton </li>    <li><a href="http://www.twitter.com/estoychev">@EStoychev</a> – Emil Stoychev </li>    <li><a href="http://www.twitter.com/michaelsync">@MichaelSync</a> – Michael Sync </li>    <li><a href="http://www.twitter.com/vbandi">@vbandi</a> – András Velvart </li>    <li><a href="http://www.twitter.com/danwahlin">@DanWahlin</a> – Dan Wahlin </li>    <li><a href="http://www.twitter.com/adefwebserver">@adefwebserver</a> – Michael Washington </li>    <li><a href="http://www.twitter.com/davidyack">@DavidYack</a> – David Yack </li>    <li><a href="http://www.twitter.com/daronyondem">@DaronYondem</a> – Daron Yondem </li>    <li><a href="http://www.twitter.com/davidezordan">@DavideZordan</a> – Davide Zordan </li> </ul>
<p>   <br /></p>
<p><strong>Silverlight Community Leaders</strong></p>
<ul>   <li><a href="http://www.twitter.com/timheuer">@timheuer</a> – Tim Heuer </li>    <li><a href="http://www.twitter.com/jesseliberty">@jesseliberty</a> – Jesse Liberty </li>    <li><a href="http://www.twitter.com/adkinn">@adkinn</a> – Adam Kinney </li>    <li><a href="http://www.twitter.com/john_papa">@john_papa</a> – John Papa </li> </ul>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    November
    24th,
    
    2009
  </span>

  <h2>
    <a href="/silverlight/2009/11/24/what-rsquo-s-new-in-silverlight-4.html">What’s New in Silverlight 4 – Download and Run!</a>
  </h2>

  <div>
    
    
    <p><a href="http://channel9.msdn.com/learn/courses/Silverlight4/"><img style="border-bottom: 0px; border-left: 0px; margin: 5px 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/WhatsNewinSilverlight4_127C5/image_3.png" width="260" height="211" /></a></p>
<p>Last week I posted about the great new materials on <a href="http://channel9.msdn.com/learn/courses/Silverlight4/">Channel 9’s site</a> and on <a href="http://www.silverlight.net/">Silverlight.net</a> for Silverlight 4. I had several people ask me about a <a href="http://ecn.channel9.msdn.com/o9/learn/Silverlight4/Labs/Overview/WhatsNewInSilverlight4.docx">downloadable version of my “What’s new in Silverlight 4” whitepaper</a> that is posted on <a href="http://channel9.msdn.com/learn/courses/Silverlight4/Overview/Overview/Default.aspx?wa=wsignin1.0">Channel 9’s site in HTML format</a>.</p>
<p>So <a href="http://ecn.channel9.msdn.com/o9/learn/Silverlight4/Labs/Overview/WhatsNewInSilverlight4.docx">here is a direct link to the downloadable document</a>.</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    November
    22nd,
    
    2009
  </span>

  <h2>
    <a href="/silverlight/2009/11/22/10-steps-to-debug-silverlight-out-of-browser-applications-without-attaching.html">10 Steps to Debug Silverlight Out-of-Browser Applications without Attaching</a>
  </h2>

  <div>
    
    
    <p>The common technique many developers use to debug Silverlight Out of Browser applications is to attach the debugger to the SLLauncher.exe process. However, there is a another way to debug installed OoB apps. Attaching to the process does not allow you to catch and debug any startup code however this technique below does allow you to do so.</p>
<p>If you are running a Silverlight 4 beta application hosted in a web project, here are the steps to debug when in OoB mode.</p>
<ol>   <li>Set the Web project that hosts the Silverlight application as the startup project in the solution</li>    <li>Run (press F5) </li>    <li>     <div align="left">Install the application onto the computer<a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/10StepstoDebugSilverlightOutofBrowserApp_C2BA/image_2.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/10StepstoDebugSilverlightOutofBrowserApp_C2BA/image_thumb.png" width="374" height="293" /></a> </div>   </li>    <li>Close the OoB application and stop debugging</li>    <li>     <div align="left">Set the Silverlight application as the startup project in the solution</div>   </li>    <li>     <div align="left">Right click the Silverlight application and choose Project Properties<a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/10StepstoDebugSilverlightOutofBrowserApp_C2BA/image_4.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/10StepstoDebugSilverlightOutofBrowserApp_C2BA/image_thumb_1.png" width="373" height="185" /></a>&#160;</div>   </li>    <li>     <div align="left">Set the Start Action to “Installed out-of-browser application”</div>   </li>    <li>Save all files in the project </li>    <li>     <div align="left">Set a breakpoint in the OoB application’s main form<a href="/wp-content/uploads/files/media/image/WindowsLiveWriter/10StepstoDebugSilverlightOutofBrowserApp_C2BA/image_6.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/wp-content/uploads/files/media/image/WindowsLiveWriter/10StepstoDebugSilverlightOutofBrowserApp_C2BA/image_thumb_2.png" width="371" height="151" /></a> </div>   </li>    <li>     <div align="left">Press F5 and now you are debugging the OoB application! </div>   </li> </ol>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    November
    20th,
    
    2009
  </span>

  <h2>
    <a href="/silverlight/2009/11/20/mvvm-and-prism-demo-for-pdc09-silverlight-session.html">MVVM and Prism Demo for PDC09 Silverlight Session</a>
  </h2>

  <div>
    
    
    <p>Earlier today I blogged about my session yesterday on <a href="http://microsoftpdc.com/Sessions/CL22">Advanced Large Scale Applications with Silverlight</a> at PDC 09. I had a great time at PDC but now that I am home and have a faster and more stable internet connection, I <a href="/wp-content/uploads/files/downloads/Prism.Demo.PDC09.zip">zipped my demo code for the Silverlight 3, Prism, MVVM sample</a> so you can now <a href="/wp-content/uploads/files/downloads/Prism.Demo.PDC09.zip">download it from here</a>. Feel free to take the code and use it as you will. </p>
<p>The majority of reusable code for the Screen Conductor pattern is in the Infrastructure project since it is generic. The code demonstrates:</p>
<ul>   <li>MVVM using the marriage of the View to the ViewModel </li>    <li>The Screen Conductor pattern/technique for view navigation </li>    <li>Prism </li>    <li>Unity </li> </ul>
<p>You should use the Northwind database and edit the server side web.config file to point to your local copy.</p>
<p>I recently wrote an article for the PnP team on this topic that goes through all of the code. Once it is available online I will post its location.</p>
<p>And if you attended my session at PDC, thank you so much for coming! If you did not get a chance to see it, you can watch it using the <a href="http://microsoftpdc.com/Sessions/CL22">recorded video of my session and see my slides here</a>.</p>
<p>&#160;</p>
<p><font color="#ff0000">UPDATE</font>: You can now <a href="/wp-content/uploads/files/downloads/printingmvvm.zip">download the source code for the Silverlight 4 MVVM demo</a> that I showed in this presentation. The sample is a VERY basic MVVM app that demonstrates how to do a simple form of MVVM that can be replicated in a larger project. Thanks for your patience!</p>


    
    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    November
    19th,
    
    2009
  </span>

  <h2>
    <a href="/silverlight/2009/11/19/video-of-my-prism-and-mvvm-at-pdc.html">Video of my Prism and MVVM at PDC</a>
  </h2>

  <div>
    
    
    <p>We had a fantastic turnout yesterday for my session at <a href="http://www.microsoftpdc.com/">PDC</a> on <a href="http://microsoftpdc.com/Sessions/CL22">Advanced Large Scale Applications with Microsoft Silverlight</a>. The room was packed and there were so many great questions that they ended up kicking me out of the room! LOL Thanks so much for everyone for attending. It is obvious that there is a lot of interest in building large Silverlight applications, ones that use MVVM, and how to use Prism. I’ll be posting my code from the demos I showed later this evening once I get back to Redmond and get on a faster network connection.</p>
<p>You can view the video for my presentation <a title="Advanced Topics for Building Large-Scale Applications with Microsoft Silverlight" href="http://microsoftpdc.com/Sessions/CL22">Advanced Topics for Building Large-Scale Applications with Microsoft Silverlight</a> here. You can fid the slide deck for my presentation # CL22 from <a href="http://microsoftpdc.com/Videos">this link too</a>.</p>
<p>And be sure to check back late tonight for the code samples!</p>


    
    
  </div>

</article>

<hr/>

<ul class="pager"> 

  
  <li class="previous">
    
    <a href="/page39">&larr; Newer</a>
    
  </li>
  
  
  <li>
    <span class="page_number">Page: 40 of 86</span>
  </li>

  
  <li class="next">
    <a href="/page41">Older &rarr;</a>
  </li>
  

</ul>





      <footer class="footer-text">
        <hr/>
        <p>
        Copyright © 2015 - John Papa Blog content licensed under the Creative Commons <a href="http://creativecommons.org/licenses/by/2.5/">CC BY 2.5</a>
        | Unless otherwise stated or granted, code samples licensed under the <a href="http://sm.mit-license.org/">MIT license</a>.
        | Site design based on the <a href="https://github.com/dbtek/dbyll">dbyll theme</a> under the <a href="http://sm.mit-license.org/">MIT license</a>
      </p>

      </footer>

    </div>

    <script type="text/javascript" src="/assets/resources/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="/assets/resources/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/assets/js/app.js"></script>

    <!--Developer Media Links-->
    <script type='text/javascript'>
        function _dmBootstrap(file) {
    var _dma = document.createElement('script'); _dma.type = 'text/javascript'; _dma.async = true; _dma.src = ('https:' == document.location.protocol ? 'https://' : 'http://')
    + file;
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(_dma);
    }
    function _dmFollowup(file) { if (typeof DMAds === 'undefined') _dmBootstrap('cdn2.DeveloperMedia.com/a.min.js');}
    (function () { _dmBootstrap('cdn1.DeveloperMedia.com/a.min.js');
    setTimeout(_dmFollowup, 2000);})();
    </script>

    <!--<script language="JavaScript" src="http://ad.doubleclick.net/N6839/adj/lqm.johnpapa.site/ron;kw=%2Cjohn%2Cpapa%2Cblog%2Cjohnpapa%7Bdot%7Dnet%2Cjohnpapa%2Cpappa%2Cwww%7Bdot%7Djohnpapa%7Bdot%7Dnet%2Cjon%2Cangular%2Cjhon;sz=160x600;dc_ref=http%3A%2F%2Fwww.johnpapa.net%2F;tile=1;ord=BEAAB484DA88D8D84B9DCB004E5712BE?"
    type="text/javascript"></script>-->

    <div data-type="ad" data-publisher="lqm.johnpapa.site" data-zone="ron" data-format="728x90" class="col-centered"></div>

</body>

</html>


<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl =
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'johnpapa']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

