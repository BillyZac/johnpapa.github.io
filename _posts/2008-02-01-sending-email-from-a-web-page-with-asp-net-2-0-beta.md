---
layout: post
title: Sending Email from a Web Page with ASP.NET 2.0 beta
date: 2008-02-01 18:50
author: John
comments: true
categories: [All]
---
<P>Here is another quick example of how to send an email from a web page, this time using ASP.NET 2. (for ASP.NET 1.1, <A HREF="/blogs/john.papa/archive/2005/09/19/132248.aspx">click here</A>) The code for the <A HREF="/blogs/john.papa/archive/2005/09/19/132248.aspx">ASP.NET 1.1 technique </A>needs to be refactored to be used in ASP.NET 2.0 since the System.Web.Mail.MailMessage and System.Web.Mail.SmtpMail classes become obsolete in .NET 2. Instead, there are now the System.Net.Mail.MailMessage and System.Net.Mail.SmtpClient classes, as shown below:</P> <P>&nbsp;</P> <DIV style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 0pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 0pt; FONT-SIZE: 10pt; BACKGROUND: white; PADDING-BOTTOM: 0pt; BORDER-LEFT: windowtext 1pt solid; COLOR: black; PADDING-TOP: 0pt; BORDER-BOTTOM: windowtext 1pt solid; FONT-FAMILY: Courier New"> <P style="MARGIN: 0px"><SPAN style="COLOR: teal">&nbsp;&nbsp;&nbsp;&nbsp;1</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN style="COLOR: blue">protected</SPAN> <SPAN style="COLOR: blue">void</SPAN> btnSend_Click(<SPAN style="COLOR: blue">object</SPAN> sender, EventArgs e)</P> <P style="MARGIN: 0px"><SPAN style="COLOR: teal">&nbsp;&nbsp;&nbsp;&nbsp;2</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P> <P style="MARGIN: 0px"><SPAN style="COLOR: teal">&nbsp;&nbsp;&nbsp;&nbsp;3</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN style="COLOR: green">//Assuming the required fields have been validated using a validator ...</SPAN></P> <P style="MARGIN: 0px"><SPAN style="COLOR: teal">&nbsp;&nbsp;&nbsp;&nbsp;4</SPAN>&nbsp;</P> <P style="MARGIN: 0px"><SPAN style="COLOR: teal">&nbsp;&nbsp;&nbsp;&nbsp;5</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; MailMessage msg = <SPAN style="COLOR: blue">new</SPAN> MailMessage();</P> <P style="MARGIN: 0px"><SPAN style="COLOR: teal">&nbsp;&nbsp;&nbsp;&nbsp;6</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; msg.From = <SPAN style="COLOR: blue">new</SPAN> MailAddress(txtFrom.Text);&nbsp;&nbsp;&nbsp; <SPAN style="COLOR: green">//you can also add a From Name for display purposes</SPAN></P> <P style="MARGIN: 0px"><SPAN style="COLOR: teal">&nbsp;&nbsp;&nbsp;&nbsp;7</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; msg.To.Add(txtTo.Text);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: green">//you can also add a To Name for display purposes</SPAN></P> <P style="MARGIN: 0px"><SPAN style="COLOR: teal">&nbsp;&nbsp;&nbsp;&nbsp;8</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN style="COLOR: blue">if</SPAN> (txtCc.Text.Length &gt; 0) </P> <P style="MARGIN: 0px"><SPAN style="COLOR: teal">&nbsp;&nbsp;&nbsp;&nbsp;9</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; msg.CC.Add(txtCc.Text);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="COLOR: green">//you can also add a CC Name for display purposes</SPAN></P> <P style="MARGIN: 0px"><SPAN style="COLOR: teal">&nbsp;&nbsp;&nbsp;10</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN style="COLOR: blue">if</SPAN> (txtBcc.Text.Length &gt; 0)</P> <P style="MARGIN: 0px"><SPAN style="COLOR: teal">&nbsp;&nbsp;&nbsp;11</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; msg.Bcc.Add(txtBcc.Text);&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN style="COLOR: green">//you can also add a Bcc Name for display purposes</SPAN></P> <P style="MARGIN: 0px"><SPAN style="COLOR: teal">&nbsp;&nbsp;&nbsp;12</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; msg.Subject = txtSubject.Text;</P> <P style="MARGIN: 0px"><SPAN style="COLOR: teal">&nbsp;&nbsp;&nbsp;13</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; msg.Body = txtBody.Text;</P> <P style="MARGIN: 0px"><SPAN style="COLOR: teal">&nbsp;&nbsp;&nbsp;14</SPAN>&nbsp;</P> <P style="MARGIN: 0px"><SPAN style="COLOR: teal">&nbsp;&nbsp;&nbsp;15</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; SmtpClient smtp = <SPAN style="COLOR: blue">new</SPAN> SmtpClient(txtSMTPServer.Text);</P> <P style="MARGIN: 0px"><SPAN style="COLOR: teal">&nbsp;&nbsp;&nbsp;16</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; smtp.Send(msg);</P> <P style="MARGIN: 0px"><SPAN style="COLOR: teal">&nbsp;&nbsp;&nbsp;17</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P></DIV><!--EndFragment--> <P>&nbsp;</P> <P>&nbsp;</P>

