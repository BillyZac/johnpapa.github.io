---
layout: post
title: Designing SQL Server's Common Table Expressions (CTE's)
date: 2007-12-21 15:12
author: John
comments: true
categories: [All]
---
<p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">My <a class="" href="http://msdn.microsoft.com/msdnmag/issues/07/10/DataPoints/" mce_href="http://msdn.microsoft.com/msdnmag/issues/07/10/DataPoints/">October 2007 Data Points column</a> </font><font face="Calibri" size="3">has been posted to the </font><a class="" href="http://msdn.microsoft.com/msdnmag/issues/07/10" mce_href="http://msdn.microsoft.com/msdnmag/issues/07/10"><font face="Calibri" size="3">MSDN Magazine web site</font></a><font face="Calibri" size="3">. This edition is titled <a class="" href="http://msdn.microsoft.com/msdnmag/issues/07/10/DataPoints/default.aspx" mce_href="http://msdn.microsoft.com/msdnmag/issues/07/10/DataPoints/default.aspx">"SQL Server Common Table Expressions".</a></font></p> <p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3"></font>&nbsp;</p> <p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">In this article I focus on using CTEs to address common development scenarios. </font></p> <p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">- describing how CTEs work </font></p> <p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">- scenarios they can be used to address</font></p> <p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">- advantages of using CTEs versus using traditional T-SQL constructs, such as derived tables, views, and custom procedures</font></p> <p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">- several examples </font></p> <p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">- how and where they can be used (where not to)</font></p> <p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">- how CTEs handle recursive logic </font></p> <p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">- define how a recursive CTE operates</font></p> <p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3"></font>&nbsp;</p> <p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">As always, all the code I discuss in the column is available for download from the MSDN<sup class="clsSmall">Â®</sup> Magazine Web site and uses the Northwind and the AdventureWorks databases that come with SQL Server 2005. </font></p> <p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3"></font>&nbsp;</p> <p class="MsoNormal" style="margin: 0in 0in 0pt" mce_keep="true">&nbsp;</p> <p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3"></font></p> <p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3"></font></p> <p class="MsoNormal" style="margin: 0in 0in 0pt"><a href="http://msdn.microsoft.com/msdnmag/issues/07/02" mce_href="http://msdn.microsoft.com/msdnmag/issues/07/02"><span style="color: windowtext; text-decoration: none; text-underline: none"></span></a></p> <p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">&nbsp;<a class="" href="http://msdn.microsoft.com/msdnmag/issues/07/10/DataPoints/default.aspx" mce_href="http://msdn.microsoft.com/msdnmag/issues/07/10/DataPoints/default.aspx"><img style="width: 263px; height: 345px" height="345" src="http://msdn.microsoft.com/msdnmag/images/covers/October07Coverlg.gif" width="263" border="0" mce_src="http://msdn.microsoft.com/msdnmag/images/covers/October07Coverlg.gif"></a></font></p> <p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3"></font></p>

