---
layout: post
title: ADO.NET 2's DataTable.Merge
date: 2008-02-01 18:39
author: John
comments: true
categories: [All]
---
OK, so its not ground breaking, earth shattering nor will it solve world hunger ... but I am pretty stoked over the addition of the Merge method to the DataTable object in ADO.NET 2. It has always been an annoyance of mine that when I want to merge a DataTable into another one that I have to have a DataSet to perform the operation. What if I don't have nor want a DataSet? Well, in ADO.NET 1.x you have to create a DataSet anyway. I know its just an extra line of code or 2, but its the point of creating an object that really serves no purpose in my context that bothers me. OK, so this is not a huge issue by itself but again I feel like it strays from sound development practices. If the DataSet is already there ... fine. <br> <br> In the following code sample I set up 2 DataTable objects manually and then merge them. Unfortunately, I have to create a DataSet to perform the merge. <br> <br> <FIELDSET> <LEGEND>ADO.NET 1.1 - DataSet.Merge</LEGEND> <font color="#000000" size="2"><font color="#0000ff" size="2">private void </font>Button1_Click(<font color="#0000ff" size="2"> object</font> sender, System.EventArgs e) <br> { <br> &nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000" size="2">// Set up a DataTable</font> <br> &nbsp;&nbsp;&nbsp;&nbsp;DataTable oDt= <font color="#0000ff" size="2">new</font> DataTable("Colors"); <br> &nbsp;&nbsp;&nbsp;&nbsp;oDt.Columns.Add("ColorID", System.Type.GetType("System.Int32")); <br> &nbsp;&nbsp;&nbsp;&nbsp;oDt.Columns.Add("ColorName", System.Type.GetType("System.String")); <br> &nbsp;&nbsp;&nbsp;&nbsp;oDt.PrimaryKey = <font color="#0000ff" size="2">new</font> DataColumn[]{oDt.Columns["ColorID"]}; <br> &nbsp;&nbsp;&nbsp;&nbsp;oDt.Rows.Add(<font color="#0000ff" size="2">new object</font>[]{1,"Red"}); <br> &nbsp;&nbsp;&nbsp;&nbsp;oDt.Rows.Add(<font color="#0000ff" size="2">new object</font>[]{2,"Teal"}); <br> &nbsp;&nbsp;&nbsp;&nbsp;oDt.Rows.Add(<font color="#0000ff" size="2">new object</font>[]{3,"Yellow"}); <br> &nbsp;&nbsp;&nbsp;&nbsp;oDt.AcceptChanges(); <br> <br> &nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000" size="2">// Set up a another DataTable that I will use to Merge</font> <br> &nbsp;&nbsp;&nbsp;&nbsp;DataTable oDtMoreColors= <font color="#0000ff" size="2">new</font> DataTable("Colors"); <br> &nbsp;&nbsp;&nbsp;&nbsp;oDtMoreColors.Columns.Add("ColorID", System.Type.GetType("System.Int32")); <br> &nbsp;&nbsp;&nbsp;&nbsp;oDtMoreColors.Columns.Add("ColorName", System.Type.GetType("System.String")); <br> &nbsp;&nbsp;&nbsp;&nbsp;oDtMoreColors.PrimaryKey = <font color="#0000ff" size="2">new</font> DataColumn[]{oDtMoreColors.Columns["ColorID"]}; <br> &nbsp;&nbsp;&nbsp;&nbsp;oDtMoreColors.Rows.Add(<font color="#0000ff" size="2">new object</font>[]{1,"Red"}); <br> &nbsp;&nbsp;&nbsp;&nbsp;oDtMoreColors.Rows.Add(<font color="#0000ff" size="2">new object</font>[]{2,"Blue"}); <br> &nbsp;&nbsp;&nbsp;&nbsp;oDtMoreColors.Rows.Add(<font color="#0000ff" size="2">new object</font>[]{4,"Green"}); <br> &nbsp;&nbsp;&nbsp;&nbsp;oDtMoreColors.AcceptChanges(); <br> <br> &nbsp;&nbsp;&nbsp;&nbsp;<font color="#008000" size="2">// Create a DataSet so I can merge the DataTable objects</font> <br> &nbsp;&nbsp;&nbsp;&nbsp;DataSet oDs = <font color="#0000ff" size="2">new</font> DataSet("WhyOhWhy"); <br> &nbsp;&nbsp;&nbsp;&nbsp;oDs.Tables.Add(oDt); <br> &nbsp;&nbsp;&nbsp;&nbsp;oDs.Merge(oDtMoreColors); <br> } <br> </font> </FIELDSET> <br> <br> In ADO.NET 2 I can skip creating the DataSet and instead use the following line of code. <br> <br> <FIELDSET><LEGEND>ADO.NET 2 - DataTable.Merge</LEGEND> &nbsp;&nbsp;&nbsp;&nbsp;oDt.Merge(oDtMoreColors); </FIELDSET> <br> <br> While some topics like MARS are grabbing more of the press in ADO.NET 2, tweaks like the DataTable Merge method are flying under the radar. After all, I use these types of features all the time so if we can make it work better, then I am all for it. <br> <br>

