---
layout: post
title: LINQ 101 - Which Flavor?
date: 2008-02-01 18:53
author: John
comments: true
categories: [All]
---
<div class="Section1"><p class="MsoNormal">LINQ has permeated the .NET world. How to use LINQ, the different types of LINQ, how LINQ&rsquo;s query expressions break down into C# 3&rsquo;s newest features, and so on. LINQ has even had some of its old names tossed aside in the process. For example, LINQ to SQL was formerly known as DLinq. For the most part I have quietly indulged in all things LINQ and avoided writing too much on the specific syntaxes of how/when to use it (or not to use it). But now that LINQ, ADO.NET vNext and Orcas are getting close to the point where significant changes are less likely, I thought I might answer some fundamental questions about the flavors of LINQ in a brief post.</p><p class="MsoNormal">&nbsp;</p><p class="MsoNormal">Once people get into LINQ, the biggest confusion I get email on regarding LINQ is how to choose between LINQ to SQL (formerly DLinq) and LINQ to Entities. In short, LINQ to SQL allows you to query an object model that maps directly to your relational database schema. The mapping is 1 class object to 1 db schema object. This is a simpler form than the abstraction model of LINQ to Entities &hellip;. which allows you to query an object that can be translated into 1 or more tables (for example) in your database. With LINQ to entities, the object model that you query with LINQ can be very different than the database schema.</p><p class="MsoNormal">&nbsp;</p><p class="MsoNormal">Here is a quick primer on some of the flavors of LINQ:</p><p>&nbsp;</p><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3"></font></p><p><table border="0" cellpadding="0" cellspacing="0" class="MsoNormalTable" style="border-collapse: collapse"><tbody><tr><td style="padding-right: 5.4pt; padding-left: 5.4pt; padding-bottom: 0in; width: 134.6pt; padding-top: 0in; background-color: transparent; border: black 1pt solid" valign="top" width="179"><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">LINQ to SQL</font></p><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3"></font></p><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">(Formerly known as DLinq)</font></p></td><td style="border-right: black 1pt solid; padding-right: 5.4pt; border-top: black 1pt solid; padding-left: 5.4pt; padding-bottom: 0in; border-left: #f0f0f0; width: 436.5pt; padding-top: 0in; border-bottom: black 1pt solid; background-color: transparent" valign="top" width="582"><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">Objects get mapped directly to database tables. Basically lets&nbsp; you perform LINQ queries directly on the database schema via objects.</font></p><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3"></font></p><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">If your existing architecture has objects that map 1 to 1 with your database schema, then LINQ to SQL would be the closest match.</font></p><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3"></font></p><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">Add a *.dlinq file and drag tables/procs/table value functions/views from Server Explorer to the designer. Can also use SQLMetal to generate classes.</font></p></td></tr><tr><td style="border-right: black 1pt solid; padding-right: 5.4pt; border-top: #f0f0f0; padding-left: 5.4pt; padding-bottom: 0in; border-left: black 1pt solid; width: 134.6pt; padding-top: 0in; border-bottom: black 1pt solid; background-color: transparent" valign="top" width="179"><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">LINQ to Entities</font></p></td><td style="border-right: black 1pt solid; padding-right: 5.4pt; border-top: #f0f0f0; padding-left: 5.4pt; padding-bottom: 0in; border-left: #f0f0f0; width: 436.5pt; padding-top: 0in; border-bottom: black 1pt solid; background-color: transparent" valign="top" width="582"><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">Provides a layer of abstraction from the relational database structure. (aka you can combine tables into a single class, or you can use inheritance). Objects can represent the relational tables in OOP</font></p><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3"></font></p><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">There is a conceptual model, a database schema, and then there is the mapping between the 2. The conceptual objects are mapped through an XML mapping on to the database schema.</font></p><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3"></font></p><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">Add a .edm model file and create entities and their associations in the designer. Can also generate an EDM model (with the .ssdl, .csdl, .msl and .cs files).</font></p></td></tr><tr><td style="border-right: black 1pt solid; padding-right: 5.4pt; border-top: #f0f0f0; padding-left: 5.4pt; padding-bottom: 0in; border-left: black 1pt solid; width: 134.6pt; padding-top: 0in; border-bottom: black 1pt solid; background-color: transparent" valign="top" width="179"><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">LINQ to XML</font></p><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3"></font></p><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">(Also known as XLinq)</font></p></td><td style="border-right: black 1pt solid; padding-right: 5.4pt; border-top: #f0f0f0; padding-left: 5.4pt; padding-bottom: 0in; border-left: #f0f0f0; width: 436.5pt; padding-top: 0in; border-bottom: black 1pt solid; background-color: transparent" valign="top" width="582"><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">LINQ over XML structures</font></p></td></tr><tr><td style="border-right: black 1pt solid; padding-right: 5.4pt; border-top: #f0f0f0; padding-left: 5.4pt; padding-bottom: 0in; border-left: black 1pt solid; width: 134.6pt; padding-top: 0in; border-bottom: black 1pt solid; background-color: transparent" valign="top" width="179"><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">LINQ to DataSets</font></p></td><td style="border-right: black 1pt solid; padding-right: 5.4pt; border-top: #f0f0f0; padding-left: 5.4pt; padding-bottom: 0in; border-left: #f0f0f0; width: 436.5pt; padding-top: 0in; border-bottom: black 1pt solid; background-color: transparent" valign="top" width="582"><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">Using LINQ with ADO.NET DataSet and DataTable objects. </font></p></td></tr><tr><td style="border-right: black 1pt solid; padding-right: 5.4pt; border-top: #f0f0f0; padding-left: 5.4pt; padding-bottom: 0in; border-left: black 1pt solid; width: 134.6pt; padding-top: 0in; border-bottom: black 1pt solid; background-color: transparent" valign="top" width="179"><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">LINQ to Objects</font></p></td><td style="border-right: black 1pt solid; padding-right: 5.4pt; border-top: #f0f0f0; padding-left: 5.4pt; padding-bottom: 0in; border-left: #f0f0f0; width: 436.5pt; padding-top: 0in; border-bottom: black 1pt solid; background-color: transparent" valign="top" width="582"><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3">Using LINQ &nbsp;with collections implementing IEnumerable&lt;T&gt;</font></p></td></tr></tbody></table></p><p class="MsoNormal" style="margin: 0in 0in 0pt"><font face="Calibri" size="3"></font></p></div>

