---
layout: post
title: Store My Connection String Please - ConfigurationManager in .NET 2.0
date: 2008-02-01 18:50
author: John
comments: true
categories: [All]
---
<P>I love the neat little features. You know, the ones that aren't earth shattering but still get you excited over the simplicity involved. To me, the .NET 2.0 Framework's <A href="http://msdn2.microsoft.com/en-us/library/2a1tyt9s.aspx">System.Configuration</A> namespace's <A href="http://msdn2.microsoft.com/en-us/library/ms134260.aspx">ConfigurationManager </A>class qualifies as one of those things. Specifically, I like the <A href="http://msdn2.microsoft.com/en-us/library/ms134275">ConfigurationManager's ConnectionString property</A>. Here is a simple example ... I can create a connection string section in my class library project's App.config file and then access the connection string through code. Yeah, there are other ways to do it but this is just cool. Its simple. Its clean.</P> <P>Here is a sample App.config:</P><PRE><FONT color=#0000ff size=2><P>&lt;?</FONT><FONT color=#800000 size=2>xml</FONT><FONT color=#ff00ff size=2> </FONT><FONT color=#ff0000 size=2>version</FONT><FONT color=#0000ff size=2>="1.0"</FONT><FONT color=#ff00ff size=2> </FONT><FONT color=#ff0000 size=2>encoding</FONT><FONT color=#0000ff size=2>="utf-8"</FONT><FONT color=#ff00ff size=2> </FONT><FONT color=#0000ff size=2>?&gt;</P><P>&lt;</FONT><FONT color=#800000 size=2>configuration</FONT><FONT color=#0000ff size=2>&gt;</P></FONT><FONT size=2><P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&lt;</FONT><FONT color=#800000 size=2>connectionStrings</FONT><FONT color=#0000ff size=2>&gt;</P></FONT><FONT size=2><P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</FONT><FONT color=#800000 size=2>add</FONT><FONT color=#ff00ff size=2> </FONT><FONT color=#ff0000 size=2>name</FONT><FONT color=#0000ff size=2>="MyCnString"</FONT><FONT color=#ff00ff size=2> </FONT></P><P><FONT color=#ff0000 size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connectionString</FONT><FONT color=#0000ff size=2>="Data Source=legolas;Initial Catalog=Northwind;Integrated Security=True"</FONT><FONT color=#ff00ff size=2> </FONT></P><P><FONT color=#ff0000 size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;providerName</FONT><FONT color=#0000ff size=2>="System.Data.SqlClient"/&gt;</P></FONT><FONT size=2><P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&lt;/</FONT><FONT color=#800000 size=2>connectionStrings</FONT><FONT color=#0000ff size=2>&gt;</P><P>&lt;/</FONT><FONT color=#800000 size=2>configuration</FONT><FONT color=#0000ff size=2>&gt;</FONT></P></PRE> <P>&nbsp;</P> <P>Add a reference to the System.Configuration.dll and then add a using statement like this :</P><PRE><P><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;using System.Configuration;</FONT><FONT color=#0000ff size=2>&nbsp;</FONT> </P></PRE> <P>&nbsp;</P> <P>The code to grab the connection string could then look like this:&nbsp;<BR></P><PRE><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;string cnString = ConfigurationManager.ConnectionStrings["MyCnString"].ConnectionString;<BR>&nbsp;&nbsp;&nbsp;SqlConnection cn = new SqlConnection(cnString);</FONT></PRE><BR>Again, nothing earth shattering but its nice to have a place to store your connection strings.

