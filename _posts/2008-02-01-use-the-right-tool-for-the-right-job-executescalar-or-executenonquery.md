---
layout: post
title: Use the Right Tool for the Right Job - ExecuteScalar or ExecuteNonQuery
date: 2008-02-01 18:51
author: John
comments: true
categories: [All]
---
<P>Would you use a drill to pre-drill a hole for a nail to hang a picture? I wouldn't either. Just hammer the nail into the wall.&nbsp;OK, need something more code related? Would you define a class with a single property and no other members just to store a string? Me neither. </P> <P><FONT color=#008000>public class foo{</FONT></P> <P><FONT color=#008000>&nbsp;&nbsp;&nbsp;public string goo = "";</FONT></P> <P><FONT color=#008000>}</FONT></P> <P>This might seem like an obvious point to most, and I sure hope it does. But recently I worked on a project that just made me think "WTF"?&nbsp; I saw some ADO.NET code that was intended to execute an UPDATE statement against a table in a SQL Server database. It worked just fine and dandy, but I had to take a second look because the code was issuing the ExecuteScalar method. At first I though, maybe the code was actually returning a value and not executing an UPDATE statement, so&nbsp;I looked at it again thinking I missed something. Nope, it was just and UPDATE statement.&nbsp; So then I wondered if the UPDATE statement was also returning a value after the UPDATE ... looked again and nope, it wasn't. This code was simply doing something like this:</P> <P>&nbsp;&nbsp;<FONT color=#006400>&nbsp;string sql = "UPDATE tableX SET&nbsp;columnA = value1 WHERE columnB = value2";</FONT></P> <P>So why was this code using ExecuteScalar to run this SQL?&nbsp;I started looking around the project that I inherited and found several other places that ExecuteScalar was used ... most of which were also issuing a simple action query with no intention of getting a result back. The code looked like this:</P> <P>&nbsp;<FONT color=#008000>&nbsp;&nbsp;cmd.ExecuteScalar();</FONT>&nbsp;&nbsp;&nbsp;</P> <P>That's not psuedo code, there was nothing on the left hand side to store the return value of the ExecuteScalar method. So I started to refactor the code to change the places that were using ExecuteScalar but not actually getting a return value into code like this:</P> <P><FONT color=#008000>&nbsp;&nbsp;&nbsp;cmd.ExecuteNonQuery();</FONT></P> <P>Use ExecuteScalar to execute a query to return a single scalar value and use ExecuteNonQuery to execute an action query and return no values. Is this basic stuff you already know? Very likely (or hell yeah!). In fact, that is why I looked so hard when I first saw this code ... I thought, geez, I must be missing something. Like most jobs, using the right tool for the right job just makes more sense.</P> <P>&nbsp;</P>

