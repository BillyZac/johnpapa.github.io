---
layout: post
title: SubString in an ADO.NET DataSet - (DataColumn Expression)
date: 2008-02-01 18:50
author: John
comments: true
categories: [All]
---
<P>One cool feature that I just love are the expression based columns in ADO.NET. I do not use them often but when I do find cause to use them, they are very useful. (Not to mention very cool.) One good use of expression columns in a DataSet is when you want to load a column into a DataGrid but you don't want the entire text description to appear in the column. This is often found when you have a notes, comments or some sort of very long description column that is 100 or even 8000 characters long. You likely don't want to show the entire text string because it could stretch out your grid, so&nbsp;a common way to deal with it is to only show the first X amount of characters. For example, the code sample below will create an expression&nbsp;column called "Co" and add it to the Customers DataTable. This new column will grab the first 10 characters from the CompanyName (from the same DataRow in the DataTable) and append 3 dots. So instead of showing all of the columns in a grid, you could hide the CompanyName and instead show the Co column.</P> <P>&nbsp;</P> <DIV style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 0pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 0pt; FONT-SIZE: 8pt; BACKGROUND: white; PADDING-BOTTOM: 0pt; BORDER-LEFT: windowtext 1pt solid; COLOR: black; PADDING-TOP: 0pt; BORDER-BOTTOM: windowtext 1pt solid; FONT-FAMILY: Courier New"><PRE style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; <SPAN style="COLOR: blue">string</SPAN> cnStr = <SPAN style="COLOR: maroon">@"Data Source=mysqlserver;Initial Catalog=northwind;Integrated Security=True"</SPAN>;</PRE><PRE style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; SqlConnection cn = <SPAN style="COLOR: blue">new</SPAN> SqlConnection(cnStr);</PRE><PRE style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; <SPAN style="COLOR: blue">string</SPAN> sql = <SPAN style="COLOR: maroon">"SELECT CustomerID, CompanyName, City FROM Customers ORDER BY CustomerID"</SPAN>;</PRE><PRE style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; SqlCommand cmd = <SPAN style="COLOR: blue">new</SPAN> SqlCommand(sql, cn);</PRE><PRE style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; SqlDataAdapter da = <SPAN style="COLOR: blue">new</SPAN> SqlDataAdapter(cmd);</PRE><PRE style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; DataSet ds = <SPAN style="COLOR: blue">new</SPAN> DataSet();</PRE><PRE style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; da.Fill(ds, <SPAN style="COLOR: maroon">"Customers"</SPAN>);</PRE><PRE style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; ds.Tables[<SPAN style="COLOR: maroon">"Customers"</SPAN>].Columns.Add(<SPAN style="COLOR: maroon">"Co."</SPAN>, </PRE><PRE style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN style="COLOR: blue">typeof</SPAN>(<SPAN style="COLOR: blue">string</SPAN>), </PRE><PRE style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN style="COLOR: maroon">"Substring(CompanyName, 1, 10) + '...'"</SPAN>);</PRE></DIV><!--EndFragment--> <P>&nbsp;</P> <P>There is a WHOLE bunch more that you can do with expression based columns, but I'll leave that for later.</P>

