---
layout: post
title: Finding NUnit
date: 2008-02-01 18:39
author: John
comments: true
categories: [All]
---
<P><A href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnpag2/html/entlib.asp">Microsoft's Enterprise Library</A> (Ent Lib) was developed using the oft spoken of Test Driven Development methodology (TDD). But of course if you are new to TDD or are aware of it but have not used it yet, you'll want to download and install nUnit to try it out. You can find NUnit here <A href="http://www.nunit.org/">http://www.nunit.org</A> and then navigate to their download page. All of the Ent Lib code has sub folders labelled "Test" which contain the test code that NUnit looks for. NUnit is pretty easy to set up and try out, especially if you load one of the QuickStarts that come with Ent Lib into Visual Studio.NET. Give it a shot and check it out. Its a pretty cool concept and in practical real world scenarios, it has helped my projects come together more quickly. It has been especially helpful on projects with large numbers of developers as it reduces the number of errors in unit testing. And when errors are present, it is easy for other developers to fix them. I'll talk a lot more about TDD and Ent Lib in specifics in future blogs.</P> <P>Once you find NUnit, you can start setting up your own classes that can be used by it. Setting up a class for the TDD model is quite simple. Below I have shown part of the SqlDatabaseFixture class from the Ent Lib DAAB (located in the Sql\Tests folder). You really only have to follow a few steps within the code.</P> <OL> <LI>Surround your test class with the compilation directive <LI>Reference the NUnit.Framework and include it in a using statement <LI>Decorate your test class with the [TestFixture] attribute (NUnit looks for these attributes) <LI>Decorate your test method with the [Test] attribute and make sure they are declared as void <LI>Use one or more Assert statements to look for valid conditions (or invalid)</LI></OL>Go ahead and give it a whirl in your code.<BR><BR> <FIELDSET><LEGEND>SqlDatabaseFixture</LEGEND><FONT color=#000000 size=2><FONT color=#0000ff size=2>#if</FONT> UNIT_TESTS <BR><FONT color=#0000ff size=2>using</FONT> System.Data; <BR><FONT color=#0000ff size=2>using</FONT> System.Data.SqlClient; <BR><FONT color=#0000ff size=2>using</FONT> Microsoft.Practices.EnterpriseLibrary.Configuration; <BR><FONT color=#0000ff size=2>using</FONT> Microsoft.Practices.EnterpriseLibrary.Data.Tests; <BR><FONT color=#0000ff size=2>using</FONT> NUnit.Framework; <BR><BR><FONT color=#0000ff size=2>namespace</FONT> Microsoft.Practices.EnterpriseLibrary.Data.Sql.Tests <BR>{ <BR>[TestFixture] <BR><FONT color=#0000ff size=2>public class</FONT> SqlDatabaseFixture <BR>{ <BR>&nbsp;&nbsp;&nbsp;&nbsp;<FONT color=#0000ff size=2>private static</FONT> ConfigurationContext context = <FONT color=#0000ff size=2>new</FONT> TestConfigurationContext(); <BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;[Test] <BR>&nbsp;&nbsp;&nbsp;&nbsp;<FONT color=#0000ff size=2>public void</FONT> ConnectionTest() <BR>&nbsp;&nbsp;&nbsp;&nbsp;{ <BR>&nbsp;&nbsp;&nbsp;&nbsp;SqlDatabase sqlDatabase = <FONT color=#0000ff size=2>new</FONT> SqlDatabase(); <BR>&nbsp;&nbsp;&nbsp;&nbsp;sqlDatabase.ConfigurationName = "NewDatabase"; <BR>&nbsp;&nbsp;&nbsp;&nbsp;sqlDatabase.Initialize(<FONT color=#0000ff size=2>new</FONT> DatabaseConfigurationView(context)); <BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;IDbConnection connection = sqlDatabase.GetConnection(); <BR>&nbsp;&nbsp;&nbsp;&nbsp;Assert.IsNotNull(connection); <BR>&nbsp;&nbsp;&nbsp;&nbsp;Assert.IsTrue(connection <FONT color=#0000ff size=2>is</FONT> SqlConnection); <BR>&nbsp;&nbsp;&nbsp;&nbsp;connection.Open(); <BR>&nbsp;&nbsp;&nbsp;&nbsp;DBCommandWrapper cmd = sqlDatabase.GetSqlStringCommandWrapper("Select * from Region"); <BR>&nbsp;&nbsp;&nbsp;&nbsp;cmd.CommandTimeout = 60; <BR>&nbsp;&nbsp;&nbsp;&nbsp;Assert.AreEqual(cmd.CommandTimeout, 60); <BR>&nbsp;&nbsp;&nbsp;&nbsp;} <BR>} <BR></FONT></FIELDSET> <P> <P>Here is the image of NUnit running the test fixture SqlDatabaseFixture for Ent Lib's DAAB QuickStart. </P><BR><IMG src="/photos/jpapa/images/60947/original.aspx" border=0></IMG> <P>&nbsp;</P> <P></P>

