---
layout: post
title: Find SQL Server Stored Procedures Containing Some Text
date: 2008-02-01 18:50
author: John
comments: true
categories: [All]
---
<P>Relatively basic stuff here, but I do like to stick to the KISS rule. I am often required to search SQL Server's stored procedures to find out which ones refer to specific fields, tables, or even variable names. Recently, I had to&nbsp;refactor several stored procedures defined a specific alias for a column. Being the geek that I am, I wrote a little stored proc helper routine that quickly came up with the results I needed. In my case, there were over 1000 procs to search and my results turned up 25 procs to refactor. </P> <DIV style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 0pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 0pt; FONT-SIZE: 8pt; BACKGROUND: white; PADDING-BOTTOM: 0pt; BORDER-LEFT: windowtext 1pt solid; COLOR: black; PADDING-TOP: 0pt; BORDER-BOTTOM: windowtext 1pt solid; FONT-FAMILY: Courier New"><PRE style="MARGIN: 0px"><SPAN style="COLOR: blue">CREATE PROCEDURE </SPAN>sp_find_procs_containing</PRE><PRE style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; @search <SPAN style="COLOR: blue">VARCHAR</SPAN>(100) = <SPAN style="COLOR: maroon">''</SPAN></PRE><PRE style="MARGIN: 0px"><SPAN style="COLOR: blue">AS</SPAN></PRE><PRE style="MARGIN: 0px"><SPAN style="COLOR: blue">SET </SPAN>@search = <SPAN style="COLOR: maroon">'%' </SPAN>+ @search + <SPAN style="COLOR: maroon">'%'</SPAN></PRE><PRE style="MARGIN: 0px"><SPAN style="COLOR: blue">SELECT&nbsp;&nbsp;&nbsp; </SPAN></PRE><PRE style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; ROUTINE_NAME,</PRE><PRE style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; ROUTINE_DEFINITION</PRE><PRE style="MARGIN: 0px"><SPAN style="COLOR: blue">FROM&nbsp;&nbsp;&nbsp; </SPAN></PRE><PRE style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; INFORMATION_SCHEMA.ROUTINES</PRE><PRE style="MARGIN: 0px"><SPAN style="COLOR: blue">WHERE&nbsp;&nbsp;&nbsp; </SPAN></PRE><PRE style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; ROUTINE_DEFINITION <SPAN style="COLOR: blue">LIKE </SPAN>@search</PRE><PRE style="MARGIN: 0px"><SPAN style="COLOR: blue">ORDER BY</SPAN></PRE><PRE style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; ROUTINE_NAME</PRE><PRE style="MARGIN: 0px">GO</PRE></DIV> <P>If you invoke this proc and pass it the phrase you are looking for in the proc, it will return them in sorted order. Not brain surgery, just something to help me code faster. </P> <P>As you can tell, I like the INFORMATION_SCHEMA views. Here is <A HREF="/blogs/john.papa/archive/2005/06/06/64145.aspx">another post</A> I put up a while back on using them.</P>

