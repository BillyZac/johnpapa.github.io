---
layout: post
title: Mouse Fun - Running Virtual Machines in VMWare
date: 2008-08-13 00:40
author: John
comments: true
categories: [All]
---
<p></p>  <p></p>  <p>I run a lot of virtual machines for a living. Sometimes it seems like I work for them and not the other way around. Today I converted a VPC image to a VMWare image using VMWare’s Converter program. Why? Because the image was really slow in VPC&#160; and I have had better experiences with VMWare Workstation. So I converted the image. No problem there. Then I installed the VMWare Tools (similar to the VPC tools). That’s where things started going badly for me.</p>  <p>To keep this from being a long and tiring post I’ll keep to the point here … the mouse stopped working properly in the VM image. Once the tools were installed the mouse just did not work inside the image. If I removed the driver msvmmouf.sys (the microsoft tools driver) the mouse started working again, but it would not work seamlessly between the VM image and the host PC (only CTRL-ALT would get it out). I did not want that so I finally found some answers … I had to edit the registry to tell it to stop using the msvmmouf.sys driver and then install the VMWare mouse driver called vmmouse.sys. Once I did this the mouse worked great and I have had 0 problems since then.</p>  <p><font color="#ff0000">WARNING: While these steps worked for me, I am not responsible for any silliness you might perform on your virtual machine.&#160; Only perform these steps if you are willing to risk any consequences from editing your VM’s registry.</font></p>  <p>Here are the steps:</p>  <ol>   <li>Go to device manager, select the mice node, go to properties, advanced, drivers, and remove the vmmouse.sys driver.</li>    <li>It will ask to reboot, so do it.</li>    <li>Go to the registry to&#160; HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Class\{4D36E96F-E325-11CE-BFC1-08002BE10318}</li>    <li>Edit UpperFilters value</li>    <li>Remove the value msvmmouf.sys (this removes the MS mouse driver from the mouse device dependency list)</li>    <li>Close the registry editor</li>    <li>It will ask to reboot, so do it.</li>    <li>Go to device manager, select the mice node, go to properties, advanced, drivers, and update the driver.</li>    <li>Choose to find the driver yourself.</li>    <li>It will locate VMWare Mouse in the list. Select it and reboot once last time.</li> </ol>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p>It took some time due to the reboots, but this worked. And finally I got my mouse back :)</p><div class="wlWriterHeaderFooter" style="text-align:left; margin:0px; padding:4px 4px 4px 4px;"><a href="http://www.dotnetkicks.com/kick/?url=/all/mouse-fun-running-virtual-machines-in-vmware/"><img src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=/all/mouse-fun-running-virtual-machines-in-vmware/&amp;bgcolor=0080C0&amp;fgcolor=FFFFFF&amp;border=000000&amp;cbgcolor=D4E1ED&amp;cfgcolor=000000" alt="DotNetKicks Image" border="0/"></a></div><div class="wlWriterHeaderFooter" style="text-align:left; margin:0px; padding:4px 4px 4px 4px;"><script type="text/javascript">var dzone_url = '/all/mouse-fun-running-virtual-machines-in-vmware/';</script><script type="text/javascript">var dzone_title = 'Mouse Fun - Running Virtual Machines in VMWare';</script><script type="text/javascript">var dzone_blurb = 'Mouse Fun - Running Virtual Machines in VMWare';</script><script type="text/javascript">var dzone_style = '1';</script><script language="javascript" src="http://widgets.dzone.com/widgets/zoneit.js"></script> </div>

