---
layout: post
title: Custom Tooltips in WinForm TreeViews
date: 2008-02-01 18:50
author: John
comments: true
categories: [All]
---
<P>This is one of those simple coding issues that I was recently faced with that I wish I had a simple example to show me how to knock this out. I had to create a treeview whose nodes were supposed to display a tooltip that could change based on the selected node. Pretty straightforward issue overall, but I ran into a problem: the tooltips weren't working. OK, so it was a big problem with a simple solution. Long story short, there are a few key ingredients in setting tooltips that change based on the node you have selected. My problem stemmed from forgetting to deactivate the tooltip and then reactivate it. I did not see this anywhere in the documentation but I stumbled across it by trying different properties out. Now, maybe this is common knowledge to some or even most of you, but to me it sure wasn't. But I have run into controls in the past that needed to be turned off and on to work properly. So I guess I just chalk this up as one more.</P> <P>Anyway, here is a short list of things to look for:</P> <UL> <LI>drag a tooltip control onto your designer that has the treeview control <LI>create a mousemove event handler on the treeview to kick off the tooltip <LI>check to make sure that a node is selected, or get out <LI>check to make sure a different node is selected than previously, or get out <LI>Make the tooltip deactive (tip.Active = false;) <LI>Set the tooltip text (tip.SetTooltip(tree, toolTipText); <LI>Make the tooltip active (tip.Active = true;)</LI></UL> <P>Now, I had an object stored in the tag of each treeview node. So I grab it, figure out which obejct I have and get a property of the object to use for the tooltip. This part is up to your implementation of course.</P> <P>&nbsp;</P> <FIELDSET><LEGEND>Tooltips</LEGEND><PRE><SPAN style="FONT-SIZE: 9pt; COLOR: black; FONT-FAMILY: Arial"> <SPAN style="COLOR: blue">private void</SPAN> tree_MouseMove(<SPAN style="COLOR: blue">object</SPAN> sender, System.Windows.Forms.MouseEventArgs e) { TreeNode currentNode = tree.GetNodeAt(e.X, e.Y); <SPAN style="COLOR: blue">if</SPAN> ((currentNode == <SPAN style="COLOR: blue">null</SPAN>) || (previousNode == currentNode) || (currentNode.Tag == <SPAN style="COLOR: blue">null</SPAN>)) <SPAN style="COLOR: blue">return</SPAN>; <SPAN style="COLOR: blue">string</SPAN> toolTipText = string.Empty; previousNode = currentNode; <SPAN style="COLOR: blue">object</SPAN> o = previousNode.Tag; <SPAN style="COLOR: blue">if</SPAN> (o <SPAN style="COLOR: blue">is</SPAN> Class1) toolTipText = Class1.Description; <SPAN style="COLOR: blue">else if</SPAN> (<SPAN style="COLOR: blue">o is</SPAN> Class2) toolTipText = Class2.Description; <SPAN style="COLOR: blue">else if</SPAN> (o <SPAN style="COLOR: blue">is</SPAN> Class3) toolTipText = Class3.Description; <SPAN style="COLOR: blue">else</SPAN> toolTipText = <SPAN style="COLOR: blue">string</SPAN>.Empty; <SPAN style="COLOR: green">// Turn off the tooltip so we can change the text</SPAN> <SPAN style="COLOR: blue">if</SPAN> (tip.Active) tip.Active = <SPAN style="COLOR: blue">false</SPAN>; <SPAN style="COLOR: green">// Change the tooltip text</SPAN> tip.SetToolTip(tree, toolTipText); <SPAN style="COLOR: green">// Turn on the tooltip </SPAN> tip.Active = <SPAN style="COLOR: blue">true</SPAN>; } </SPAN></PRE></FIELDSET> <BR></SPAN>

